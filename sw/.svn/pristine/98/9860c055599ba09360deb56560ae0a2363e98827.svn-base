C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE CS_SCALE_PROC
OBJECT MODULE PLACED IN out/CS_Scale_Proc.obj
COMPILER INVOKED BY: C:\Keil51\c51\bin\C51.exe CS_Scale_Proc.c OBJECT(out/CS_Scale_Proc.obj) OBJECTADVANCED OPTIMIZE(9,S
                    -PEED) BROWSE CODE SYMBOLS DF(ENABLE_APE) PR(out/CS_Scale_Proc.lst) OT(7,SPEED) LARGE

line level    source

   1          #include "YC_Define.h"
   2          #include "YC_Peripheral.h"
   3          #include "system.h"
   4          #include "CS_Scale_Proc.h"
   5          #include "CS_CommTo1186.h"
   6          #include "CS_ScaleDisplay.h"
   7          #include "btreg.h"
   8          #include "BT_IPC.h"
   9          #include "lxProtocol.h"
  10          
  11          #include "retation_variable.h"
  12          #include "YC_Utilities.h"
  13          #include "hwreg.h"
  14          
  15          
  16          
  17          bool    B_Debug_Test;                           //调试模式
  18          u16_t xdata R_Debug_temp;               //调试用
  19          
  20          u8_t   xdata R_Selet_Unit;                      //单位选择状态
  21          u8_t      xdata R_Scale_state;          //秤的状态
  22          u8_t      xdata R_Display_Err;          //显示错误信息
  23                  
  24          
  25          //全局变量--------------------
  26          u16_t xdata  R_AD_Original;             //原始AD值
  27          u8_t      xdata  R_1186sys_state;               //1186系统状态
  28          u8_t   xdata  B_Weight_AdOk;            //AD准备好标志
  29          
  30          
  31          
  32          
  33          u8_t xdata  R_1186_RTC[4];                      //1186的RTC时间
  34          
  35          
  36          u16_t xdata R_Weight_Mem;               //记忆重量
  37          u16_t xdata R_Weight_Lock;              //锁定重量
  38          CS_Weight_T  xdata R_UnitWeight;        //重量值
  39          
  40          
  41          
  42          
  43          
  44          
  45          
  46          
  47          //////////////////////////////////////////////系统参数
  48          
  49          #define CS_Scale_FiterX                                 0x05            //滑动滤波范围5个AD内码
  50          #define CS_Scale_MaxWeight                              15300           //最大称量重量153.00kg
  51          #define CS_Scale_MinLockWeight                  250                     //最小锁定重量2.50kg
  52          #define CS_Scale_RetLockWeightInc               1000            //加重解锁重量10kg
  53          #define CS_Scale_RetLockWeightDec               300                     //减重解锁重量3kg
  54          #define CS_Scale_SameWeightRange                10                      //判断是同一个重量的阈值10个AD内码
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 2   

  55          #define CS_Scale_TimeOut_Zero                   15                      //零位超时关机时间15s
  56          #define CS_Scale_TimeOut_Lock                   15                      //锁定超时关机时间15s
  57          #define CS_Scale_TimeOut_Unstable               15                      //不稳定关机时间15s
  58          #define CS_Scale_TimeOut_OverLoad               3                       //超重关机时间3s
  59          #define CS_Scale_TimeOut_LowBat         3                       //低电关机时间3s
  60          #define SameZeroRange                                   10                      //认为是同一个零点的误差范围
  61          #define ScaleWeightMin                                  10                      //秤体重量左边界值
  62          #define ScaleWeightMax                                  15                      //秤体重量右边界值
  63          #define ScaleStartMemoryWeight                  600                     //秤开始记忆重量范围
  64          #define CS_CaliStateData_Up                             6000                    //标定数据有效值上限(对应AD内码)
  65          #define CS_CaliStateData_Down                   1000                    //标定数据有效值下限(对应AD内码)
  66          
  67          //////////////////////////////////////////////内部函数声明
  68          
  69          void CS_Scale_WeightProc(void);
  70          
  71          
  72          #define GetDeltaAD                                      0
  73          #define GetADDirection                          1
  74          u16_t CS_Scale_GetDeltaAD(u8_t option);
  75          
  76          
  77          #define ScaleAdcFilterRun                       0
  78          #define ScaleAdcFilterReset                     1
  79          #define ScaleAdcFilterGetFilTimes       2
  80          u16_t CS_Scale_AdcFilter(u8_t option,u16_t R_AD_BUF);
  81          
  82          
  83          void CS_Scale_GetWeight(u16_t R_AD_BUF);
  84          
  85          
  86          #define JudgeSteadyRun                          0
  87          #define ResetSteady                                     1
  88          #define GetIfSmallSteady                        2
  89          #define GetIfHeavySteady                        3
  90          u8_t CS_Scale_JudgeSteady(u8_t option);
  91          
  92          
  93          
  94          #define LockProcRun                                     0
  95          #define SetDowningLock                          1
  96          #define GetIfLock                                       2
  97          u8_t CS_Scale_LockProc(u8_t option);
  98          
  99          
 100          #define SteadyProcReset                         0
 101          #define SteadyProcRun                           1
 102          void CS_Scale_SteadyProc(u8_t option);
 103          
 104          
 105          void CS_Scale_ReturnLock(void);
 106          
 107          
 108          void CS_Scale_StandbyProc(u8_t B_Reset);
 109          
 110          
 111          void CS_Scale_PowerOnProc(bool B_Reset);
 112          
 113          /*
 114          R_Debug_temp=1234;
 115          CS_ScaleDisplay_Debug();
 116          while(1);
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 3   

 117          
 118          */
 119          
 120          //////////////////////////////////////////主流程
 121          
 122          void CS_Scale_Proc(void)
 123          {
 124   1              if(R_Scale_state == CS_Scale_state_init)
 125   1                      {       
 126   2                      CS_Scale_PowerOnProc(0);
 127   2                      }
 128   1              if(R_Scale_state == CS_Scale_state_standby)
 129   1                      {
 130   2                      CS_Scale_StandbyProc(0);                
 131   2                      }
 132   1                      
 133   1              if(B_Weight_AdOk == true)
 134   1                      {               
 135   2                      B_Weight_AdOk = false;  
 136   2                      
 137   2                      if(CS_Scale_ZeroProc(GetPowerOnZeroState,0)== false)    //还没上电取零点先取零点
 138   2                              {
 139   3                              CS_Scale_ZeroProc(FindPowerOnZero,0);
 140   3                              }
 141   2                      else
 142   2                              {
 143   3                                      
 144   3                              if(R_Scale_state == CS_Scale_state_weighting)
 145   3                                      {
 146   4                                      CS_Scale_WeightProc();
 147   4                                      CS_ScaleDisplay();
 148   4                                      }
 149   3                              if(R_Scale_state == CS_Scale_state_locking)
 150   3                                      {                                       
 151   4                                      CS_ScaleDisplay_SteadyFlash();
 152   4                                      CS_Scale_SteadyProc(SteadyProcRun);
 153   4                                      }
 154   3                              if(R_Scale_state == CS_Scale_state_caling)
 155   3                                      {
 156   4                                      CS_Scale_CaliProc(CaliProcRun);
 157   4                                      }       
 158   3                              
 159   3                              CS_Scale_TimeOutProc(0);
 160   3                              }
 161   2                      }
 162   1      }       
 163          
 164          
 165          
 166          //////////////////////////////////////////开机流程
 167          
 168          
 169          
 170          void CS_Scale_PowerOn(void)
 171          {
 172   1              
 173   1              if(R_Scale_state == CS_Scale_state_init)
 174   1                      {
 175   2                      B_Weight_AdOk = false;
 176   2                      R_Weight_Com_Coo.pre =CS_CommTo1186_Null;       
 177   2                      R_Weight_Com_Coo.now = CS_CommTo1186_Null;      
 178   2                      //R_Scale_state =       CS_Scale_state_weighting;
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 4   

 179   2                      R_Selet_Unit = CS_ScaleDisplay_L_kg;
 180   2      
 181   2                      R_Debug_temp = 0;
 182   2                      B_Debug_Test =false;
 183   2                      
 184   2                      CS_Scale_CaliProc(CaliProcSetCali);             
 185   2                      CS_Scale_ZeroProc(ZeroProcReset,0);     
 186   2                      
 187   2                      CS_Scale_TimeOutProc(CS_Reset_AllTime);
 188   2                      CS_Scale_PowerOnProc(1);
 189   2                      }
 190   1      }
 191          
 192          
 193          
 194          
 195          
 196          
 197          //////////////////////////////////////////正常称重流程
 198          
 199          void CS_Scale_WeightProc(void)
 200          {
 201   1              u16_t   R_AD_BUF;
 202   1              
 203   1              R_AD_BUF = CS_Scale_GetDeltaAD(GetDeltaAD);
 204   1              R_AD_BUF = CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
 205   1              CS_Scale_GetWeight(R_AD_BUF);
 206   1              CS_Scale_ZeroProc(RunningZero,0);
 207   1              CS_Scale_LockProc(LockProcRun);
 208   1              CS_Scale_JudgeOverLoad(0);
 209   1              CS_Scale_JudgeLowBat(0);
 210   1              CS_Scale_JudgeSteady(JudgeSteadyRun);
 211   1              
 212   1      }
 213          
 214          
 215          //当前AD和零点AD的差值
 216          u16_t CS_Scale_GetDeltaAD(u8_t option)
 217          {
 218   1              static       u8_t xdata B_Weight_Pos;                           //正负AD变化标志
 219   1              u16_t   ad_temp;
 220   1              u16_t      R_AD_Zero;
 221   1              R_AD_Zero = CS_Scale_ZeroProc(GetRunningZero,0);
 222   1              if(R_AD_Original>R_AD_Zero)
 223   1                      {
 224   2                      ad_temp = R_AD_Original - R_AD_Zero;
 225   2                      B_Weight_Pos = true;
 226   2      
 227   2                      }
 228   1              else
 229   1                      {
 230   2                      ad_temp = R_AD_Zero - R_AD_Original;
 231   2                      B_Weight_Pos = false;           
 232   2                      }
 233   1      
 234   1              
 235   1              if(option == GetADDirection)
 236   1                      {
 237   2                      return  B_Weight_Pos;
 238   2                      }       
 239   1              return ad_temp;
 240   1      }
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 5   

 241          
 242          
 243          
 244          //滑动平均滤波
 245          u16_t CS_Scale_AdcFilter(u8_t option,u16_t R_AD_BUF)
 246          {
 247   1              u32_t   ad_temp;
 248   1              static  u16_t xdata R_AD_FilTimes;
 249   1              static  u16_t xdata R_AD_BUF_OLD;
 250   1              static  u16_t xdata R_AD_F1;
 251   1              static  u16_t xdata R_AD_F2;
 252   1              static  u16_t xdata R_AD_F3;
 253   1              static  u16_t xdata R_AD_F4;
 254   1              static  u16_t xdata R_AD_F5;
 255   1              static  u16_t xdata R_AD_F6;
 256   1              static  u16_t xdata R_AD_F7;
 257   1              static  u16_t xdata R_AD_F8;    
 258   1                      
 259   1              if(option==ScaleAdcFilterGetFilTimes)
 260   1                      {
 261   2                      return  R_AD_FilTimes;
 262   2                      }
 263   1              
 264   1              
 265   1              if(R_AD_BUF >R_AD_BUF_OLD)
 266   1                      ad_temp = R_AD_BUF - R_AD_BUF_OLD;
 267   1              else
 268   1                      ad_temp = R_AD_BUF_OLD - R_AD_BUF;
 269   1      
 270   1              R_AD_BUF_OLD    =       R_AD_BUF;
 271   1              
 272   1              if((ad_temp > CS_Scale_FiterX) ||(option==ScaleAdcFilterReset)) 
 273   1                      {                                               
 274   2                      R_AD_FilTimes = 0;
 275   2                      R_AD_F1             = 0;
 276   2                      R_AD_F2             = 0;
 277   2                      R_AD_F3             = 0;
 278   2                      R_AD_F4             = 0;
 279   2                      R_AD_F5             = 0;
 280   2                      R_AD_F6             = 0;
 281   2                      R_AD_F7             = 0;
 282   2                      R_AD_F8             = 0;
 283   2                      }
 284   1              else
 285   1                      {
 286   2                      if(R_AD_FilTimes < 200 )
 287   2                      R_AD_FilTimes ++;       
 288   2      
 289   2                              if(R_AD_FilTimes<=1)
 290   2                                      R_AD_F1 = R_AD_BUF;     
 291   2                              if(R_AD_FilTimes<=2)
 292   2                                      R_AD_F2 = R_AD_BUF;
 293   2                              if(R_AD_FilTimes<=3)
 294   2                                      R_AD_F3 = R_AD_BUF;
 295   2                              if(R_AD_FilTimes<=4)
 296   2                                      R_AD_F4 = R_AD_BUF;
 297   2                              if(R_AD_FilTimes<=5)
 298   2                                      R_AD_F5 = R_AD_BUF;
 299   2                              if(R_AD_FilTimes<=6)
 300   2                                      R_AD_F6 = R_AD_BUF;
 301   2                              if(R_AD_FilTimes<=7)
 302   2                                      R_AD_F7 = R_AD_BUF;
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 6   

 303   2                              if(R_AD_FilTimes<=8)
 304   2                                      R_AD_F8 = R_AD_BUF;
 305   2                              if(R_AD_FilTimes>8)
 306   2                                      {
 307   3                                      R_AD_F1 = R_AD_F2;
 308   3                                      R_AD_F2 = R_AD_F3;
 309   3                                      R_AD_F3 = R_AD_F4;
 310   3                                      R_AD_F4 = R_AD_F5;
 311   3                                      R_AD_F5 = R_AD_F6;
 312   3                                      R_AD_F6 = R_AD_F7;
 313   3                                      R_AD_F7 = R_AD_F8;
 314   3                                      R_AD_F8 = R_AD_BUF;
 315   3                                      }
 316   2      
 317   2                      ad_temp = R_AD_F1;
 318   2                      ad_temp += R_AD_F2;
 319   2                      ad_temp += R_AD_F3;
 320   2                      ad_temp += R_AD_F4;
 321   2                      ad_temp += R_AD_F5;
 322   2                      ad_temp += R_AD_F6;
 323   2                      ad_temp += R_AD_F7;
 324   2                      ad_temp += R_AD_F8;
 325   2      
 326   2                      R_AD_BUF = ad_temp / 8 ;
 327   2                      R_AD_BUF_OLD    =       R_AD_BUF;
 328   2                      }
 329   1              return  R_AD_BUF;
 330   1      }
 331          
 332          
 333          
 334          
 335          void CS_Scale_GetWeight(u16_t R_AD_BUF)
 336          {
 337   1              u32_t   ad_temp;
 338   1              u16_t   ad_cal;
 339   1              u16_t   CaliDot1,CaliDot2,CaliDot3;
 340   1              
 341   1              CaliDot1 =CS_Scale_CaliProc(CaliProcGetCaliDot1);
 342   1              CaliDot2 =CS_Scale_CaliProc(CaliProcGetCaliDot2);
 343   1              CaliDot3 =CS_Scale_CaliProc(CaliProcGetCaliDot3);
 344   1              
 345   1              if(R_AD_BUF <= CaliDot1 )
 346   1                      {
 347   2                      ad_temp = (u32_t)R_AD_BUF  * 5000;      
 348   2                      R_UnitWeight.origin = ad_temp / CaliDot1;
 349   2                      return;
 350   2                      }
 351   1              ad_cal = R_AD_BUF - CaliDot1;
 352   1      
 353   1              if(ad_cal <=CaliDot2)
 354   1                      {
 355   2                      ad_temp = (u32_t)ad_cal  * 5000;        
 356   2                      R_UnitWeight.origin = ad_temp / CaliDot2 +5000 ;
 357   2                      return;
 358   2                      }
 359   1              
 360   1              ad_cal  = R_AD_BUF - CaliDot1 - CaliDot2 ;      
 361   1              ad_temp = (u32_t)ad_cal  * 5000;        
 362   1              R_UnitWeight.origin = ad_temp /CaliDot3 +10000 ;
 363   1      
 364   1              
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 7   

 365   1      }
 366          
 367          
 368          void CS_Scale_ChangeUnit()
 369          {
 370   1              switch(R_Selet_Unit)
 371   1                      {
 372   2                      case CS_ScaleDisplay_L_kg:
 373   2                              R_Selet_Unit=CS_ScaleDisplay_L_lb;
 374   2                              break;
 375   2                      case CS_ScaleDisplay_L_lb:
 376   2                              R_Selet_Unit=CS_ScaleDisplay_L_jin;
 377   2                              break;
 378   2                      case CS_ScaleDisplay_L_jin:
 379   2                              R_Selet_Unit=CS_ScaleDisplay_L_gongjin;
 380   2                              break;
 381   2                      case CS_ScaleDisplay_L_gongjin:
 382   2                              R_Selet_Unit=CS_ScaleDisplay_L_kg;
 383   2                              break;
 384   2                      default :
 385   2                              R_Selet_Unit=CS_ScaleDisplay_L_kg;
 386   2                              break;
 387   2                      }
 388   1      }
 389          
 390          
 391          
 392          u16_t  CS_Scale_ZeroProc(u8_t option,u16_t setdata)
 393          {
 394   1              static  u8_t       xdata R_Weight_GetZeroTimeOut = 0;   
 395   1              static  u16_t  xdata R_AD_PowerOnZero;  //上电零点AD值
 396   1              static  u16_t  xdata R_AD_Zero;                 //零点AD值
 397   1              static  u8_t    xdata B_Weight_Zero;            //处于零点标志
 398   1              static  u8_t    xdata B_Weight_ZeroOk;  //上电获取完零点标志
 399   1              static  u8_t       xdata B_LockDownCheck;       //下秤后第一次稳定追零
 400   1              static  u8_t       xdata B_WeightZeroErr;               //零点错误标志
 401   1              
 402   1              u16_t   R_AdFilTimes;
 403   1              u16_t   R_AD_BUF;
 404   1              u16_t   weight_temp;
 405   1              u16_t   R_Open_Weight;
 406   1              u8_t            B_Weight_Pos;
 407   1      
 408   1              
 409   1              
 410   1              if(option==ZeroProcReset)
 411   1                      {
 412   2                      B_Weight_ZeroOk = 0;
 413   2                      return 0;               
 414   2                      }
 415   1              if(option==SetPowerOnZero)
 416   1                      {
 417   2                      R_AD_PowerOnZero = setdata;
 418   2                      return 0;               
 419   2                      }
 420   1              if(option==SetRunningZero)
 421   1                      {
 422   2                      R_AD_Zero = setdata;
 423   2                      return 0;               
 424   2                      }
 425   1              if(option==ClrLockDownCheckFlag)
 426   1                      {
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 8   

 427   2                      B_LockDownCheck=false;
 428   2                      return 0;
 429   2                      }
 430   1              
 431   1              if(option==FindPowerOnZero)
 432   1              {
 433   2                      
 434   2              
 435   2                      if(R_Weight_GetZeroTimeOut <60)
 436   2                      {
 437   3                      R_Weight_GetZeroTimeOut ++;
 438   3                      
 439   3                      R_AD_BUF = R_AD_Original;
 440   3                      R_AD_BUF=CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
 441   3                      R_AdFilTimes = CS_Scale_AdcFilter(ScaleAdcFilterGetFilTimes,R_AD_BUF);
 442   3                      
 443   3                              if(R_AdFilTimes >=50)
 444   3                                      {
 445   4                                      R_AD_Zero       = R_AD_BUF;
 446   4                                      R_AD_PowerOnZero = R_AD_BUF;
 447   4                                      B_Weight_ZeroOk = true;
 448   4                                      }
 449   3                      }
 450   2                      else
 451   2                      {
 452   3                      R_AD_Zero       = 4000;
 453   3                      R_AD_PowerOnZero = 4000;
 454   3                      B_Weight_ZeroOk = true;
 455   3                      }
 456   2      
 457   2              }
 458   1      
 459   1              if(option==RunningZero)
 460   1              {
 461   2              B_Weight_Zero = false;          
 462   2              //3kg以下才追零包括负重量
 463   2              B_Weight_Pos = CS_Scale_GetDeltaAD(GetADDirection);             //获取AD方向
 464   2              R_Open_Weight = CS_Scale_CaliProc(CaliProcGetOpenWeight);       //获取开机重量值
 465   2              
 466   2              if(R_UnitWeight.origin <= 300 ||B_Weight_Pos ==false)   
 467   2                      B_Weight_Zero = true;
 468   2      
 469   2                      if(R_UnitWeight.origin <= 200 || B_Weight_Pos==false)
 470   2                              {               
 471   3                                      if(CS_Scale_JudgeSteady(GetIfSmallSteady)==true)
 472   3                                              {
 473   4      
 474   4                                              CS_Scale_JudgeSteady(ResetSteady);
 475   4                                              
 476   4                                              //非锁定状态正常追零
 477   4                                              if(CS_Scale_LockProc(GetIfLock)==false) 
 478   4                                                      {
 479   5                                                      if(R_AD_Original >= R_AD_PowerOnZero)
 480   5                                                              {
 481   6                                                              weight_temp = R_AD_Original - R_AD_PowerOnZero;
 482   6                                                              if(weight_temp < R_Open_Weight)
 483   6                                                                      R_AD_Zero = R_AD_Original;
 484   6                                                              }
 485   5                                                      else
 486   5                                                              R_AD_Zero = R_AD_Original;
 487   5                                                      }
 488   4                                              //锁定状态下秤第一次追零做防提起处理
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 9   

 489   4                                              else                    
 490   4                                                      {
 491   5                                                      if(B_LockDownCheck==false)
 492   5                                                              {
 493   6                                                              if(R_AD_Original>R_AD_Zero)
 494   6                                                                      weight_temp = R_AD_Original - R_AD_Zero;
 495   6                                                              else
 496   6                                                                      weight_temp = R_AD_Zero - R_AD_Original;
 497   6      
 498   6                                                              //跟锁定前的零点做比较不等于一个秤体重量的处理
 499   6                                                              //if(weight_temp<ScaleWeightMin&&weight_temp>ScaleWeightMax)
 500   6                                                                      //{
 501   6                                                                      R_AD_Zero = R_AD_Original;      //更新零点
 502   6                                                                      if(weight_temp>SameZeroRange)
 503   6                                                                              {
 504   7                                                                              //跟称重前不是一个零点报零点错并解锁
 505   7                                                                              B_WeightZeroErr=true;
 506   7                                                                              R_Display_Err=CS_ScaleDisplay_L_err;
 507   7                                                                              CS_Scale_LockProc(LockProcUnLock);
 508   7                                                                              }
 509   6                                                                      B_LockDownCheck=true;
 510   6                                                                      //}
 511   6      
 512   6                                                              }                                               
 513   5                                                      }
 514   4                                              
 515   4                                              }
 516   3                              }
 517   2              return  0;              
 518   2              }
 519   1      
 520   1              if(option==GetPowerOnZero)
 521   1                      return  R_AD_PowerOnZero;
 522   1              if(option==GetPowerOnZeroState)
 523   1                      return  B_Weight_ZeroOk;
 524   1              if(option==GetRunningZero)
 525   1                      return  R_AD_Zero;
 526   1              if(option==GetZeroState)
 527   1                      return  B_Weight_Zero;
 528   1              if(option==GetIfZeroErr)
 529   1                      return   B_WeightZeroErr;
 530   1              
 531   1              return 0;       
 532   1      }
 533          
 534          
 535          
 536          #define LockProcZeroLock                        1
 537          #define LockProcZeroUnLock                      0xfe
 538          #define LockProcDownLock                        2
 539          #define LockProcDownUnLock              0xfd
 540          #define LockProcLock                    LockProcZeroLock+LockProcDownLock
 541          #define LockProcUnLock                          3
 542          
 543          u8_t CS_Scale_LockProc(u8_t option)
 544          {
 545   1              static u8_t xdata B_Weight_Downing_Lock;                //下秤过程有重物在上面锁住
 546   1              
 547   1              if(option==SetDowningLock)
 548   1                      {
 549   2                      B_Weight_Downing_Lock =LockProcLock;
 550   2                      return 0;
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 10  

 551   2                      }
 552   1      
 553   1              if(option==GetIfLock)
 554   1                      {
 555   2                      return B_Weight_Downing_Lock;
 556   2                      }
 557   1              if(option==LockProcUnLock)
 558   1                      {
 559   2                      B_Weight_Downing_Lock =false;
 560   2                      return 0;
 561   2                      }
 562   1              
 563   1              if(CS_Scale_ZeroProc(GetZeroState,0)==true)             //处于零位
 564   1                      {
 565   2                      B_Weight_Downing_Lock &=LockProcDownUnLock ;
 566   2                      
 567   2                      if(B_Weight_Downing_Lock&LockProcZeroLock)
 568   2                      R_UnitWeight.origin = R_Weight_Lock;
 569   2                      }
 570   1              else
 571   1                      {
 572   2                      if(B_Weight_Downing_Lock&LockProcDownLock)
 573   2                              R_UnitWeight.origin = R_Weight_Lock;
 574   2                      else
 575   2                              B_Weight_Downing_Lock &= LockProcZeroUnLock;
 576   2                      }
 577   1      
 578   1              return 0;
 579   1      }
 580          
 581          
 582          
 583          
 584          //该部分工作移交给1186处理，不做误开机处理
 585          /*
 586          void CS_Scale_AvoidFalseBoot(void)
 587          {
 588                  static u8_t xdata R_Weight_ZeroTimes;
 589                  static u8_t xdata B_Weight_PowerOn;             //开机标志
 590                  static u8_t xdata B_Weight_AutoOpen;            //自动上秤标志
 591                  
 592                  if(R_UnitWeight.origin == 0)
 593                          {
 594                          if(R_Weight_ZeroTimes<255)
 595                                  R_Weight_ZeroTimes++;
 596                          }       
 597                  else
 598                          {
 599                          R_Weight_ZeroTimes = 0;
 600                          }
 601          
 602                  
 603                  if(R_Weight_ZeroTimes == 1)
 604                          {
 605                          if(B_Weight_AutoOpen)
 606                          B_Weight_PowerOn = false;
 607                          else
 608                          B_Weight_PowerOn = true;        
 609                          }
 610                  else
 611                          {
 612                          B_Weight_PowerOn = true;
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 11  

 613                          B_Weight_AutoOpen = false;
 614                          }
 615          }       
 616          */
 617          
 618          
 619          #define CS_Scale_LowBatBit      0x02
 620          #define GetIfLowBat                     1
 621          
 622          u8_t CS_Scale_JudgeLowBat(u8_t option)
 623          {
 624   1              static  u8_t xdata B_Weight_LowBat;                     //低电标志
 625   1              
 626   1              if(R_1186sys_state&CS_Scale_LowBatBit==false)
 627   1                      {
 628   2                      B_Weight_LowBat = true;
 629   2                      R_Display_Err=CS_ScaleDisplay_L_err;
 630   2                      }
 631   1              else
 632   1                      B_Weight_LowBat = false;
 633   1      
 634   1              if(option==GetIfLowBat)
 635   1                      return B_Weight_LowBat;
 636   1              
 637   1                      return 0;       
 638   1      }
 639          
 640          
 641          u8_t CS_Scale_JudgeOverLoad(u8_t option)
 642          {
 643   1      
 644   1              static  u8_t      xdata R_Weight_OverLoadTimes;
 645   1              static  u8_t  xdata  B_Weight_OverLoad;                 //超载标志
 646   1              if(option==ResetOverLoad)
 647   1                      {
 648   2                      R_Weight_OverLoadTimes = 0;
 649   2                      B_Weight_OverLoad = false;
 650   2                      return 0;
 651   2                      }
 652   1              
 653   1              if(R_UnitWeight.origin > CS_Scale_MaxWeight)
 654   1                      R_Weight_OverLoadTimes++;
 655   1              if(R_Weight_OverLoadTimes >=2)
 656   1                      {
 657   2                      R_Weight_OverLoadTimes = 2;
 658   2                      B_Weight_OverLoad = true;
 659   2                      R_Display_Err=CS_ScaleDisplay_L_err;
 660   2                      }
 661   1              else
 662   1                      B_Weight_OverLoad = false;
 663   1      
 664   1              if(option==GetIfOverLoad)
 665   1                      return B_Weight_OverLoad;
 666   1              
 667   1                      return 0;
 668   1      }
 669          
 670          
 671          
 672          
 673          u8_t CS_Scale_JudgeSteady(u8_t option)
 674          {
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 12  

 675   1      
 676   1              u16_t   weight_temp;
 677   1              static  u16_t xdata R_Weight_kg_old;
 678   1              static  u8_t      xdata R_Weight_SameTimes;
 679   1              static  u8_t xdata B_Weight_SmallSteady;                //小重量稳定标志
 680   1              static  u8_t xdata B_Weight_HeavySteady;        //大重量稳定标志
 681   1              
 682   1              if(option==ResetSteady)
 683   1                      {
 684   2                      R_Weight_SameTimes = 0;
 685   2                      B_Weight_SmallSteady = false;
 686   2                      B_Weight_HeavySteady = false;
 687   2                      return 0;
 688   2                      }       
 689   1      
 690   1              if(option==GetIfSmallSteady)
 691   1                      return B_Weight_SmallSteady;
 692   1      
 693   1              if(option==GetIfHeavySteady)
 694   1                      return B_Weight_HeavySteady;
 695   1              
 696   1              if(CS_Scale_LockProc(GetIfLock)==false)
 697   1                      {
 698   2              
 699   2                      if(R_UnitWeight.origin > R_Weight_kg_old)
 700   2                              weight_temp = R_UnitWeight.origin -R_Weight_kg_old;
 701   2                      else
 702   2                              weight_temp = R_Weight_kg_old -R_UnitWeight.origin;
 703   2                      
 704   2                      if(weight_temp <  CS_Scale_SameWeightRange)
 705   2                              {
 706   3                              if(R_Weight_SameTimes<255)
 707   3                                      R_Weight_SameTimes++;
 708   3                              }
 709   2                      else
 710   2                              R_Weight_SameTimes = 0;
 711   2              
 712   2                      
 713   2                      R_Weight_kg_old = R_UnitWeight.origin;
 714   2      
 715   2                      B_Weight_SmallSteady = false;
 716   2                      B_Weight_HeavySteady = false;
 717   2                      
 718   2                      if(R_UnitWeight.origin < CS_Scale_MinLockWeight)
 719   2                              {
 720   3                              if(R_Weight_SameTimes>40)
 721   3                                      B_Weight_SmallSteady = true;            
 722   3                              }
 723   2                      else
 724   2                              {                       
 725   3                              if(R_Weight_SameTimes>40)
 726   3                                      {
 727   4                                      B_Weight_HeavySteady = true;            
 728   4                                      R_Scale_state = CS_Scale_state_locking;
 729   4                                      CS_SoftTimer(ResetSoftTimer);           //软件定时器开始用于锁定闪显示计时
 730   4                                      CS_Scale_SteadyProc(SteadyProcReset);
 731   4                                      CS_Scale_TimeOutProc(CS_Reset_AllTime);
 732   4                                      }
 733   3                              }
 734   2                      }
 735   1              return 0;
 736   1      }
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 13  

 737          
 738          
 739          
 740          
 741          ///////////////////////////////////锁定流程
 742          
 743          #define CS_MemoryRange  25
 744          
 745          void CS_Scale_SteadyProc(u8_t option)
 746          {
 747   1              u16_t   R_AD_BUF;       
 748   1              u16_t   R_Weight_Temp;
 749   1              static  u8_t xdata B_Debug_Send;        
 750   1              static  u8_t xdata ReadUTC;
 751   1              UserMeasureData SendData;
 752   1      
 753   1              if(option==SteadyProcReset)
 754   1                      {
 755   2                      B_Debug_Send=false;
 756   2                      return;
 757   2                      }
 758   1              
 759   1              if(CS_SoftTimer(GetIfTimeOut) == true)  //锁定闪现时间到
 760   1                      {
 761   2                      if(CS_Scale_JudgeSteady(GetIfHeavySteady) == true)
 762   2                              {
 763   3                              
 764   3                              CS_Scale_JudgeSteady(ResetSteady);
 765   3      
 766   3                              if(R_UnitWeight.origin>R_Weight_Mem)
 767   3                                      R_Weight_Temp = R_UnitWeight.origin -R_Weight_Mem;
 768   3                              else
 769   3                                      R_Weight_Temp = R_Weight_Mem - R_UnitWeight.origin;
 770   3      
 771   3                              //在记忆范围内记忆
 772   3                              if(R_UnitWeight.origin > ScaleStartMemoryWeight)
 773   3                                      {
 774   4                                      if(R_Weight_Temp<CS_MemoryRange)
 775   4                                              R_UnitWeight.origin = R_Weight_Mem;
 776   4                                      }
 777   3                              
 778   3                              R_Weight_Lock = R_UnitWeight.origin;
 779   3                              R_Weight_Mem = R_UnitWeight.origin;
 780   3                              CS_Scale_ZeroProc(ClrLockDownCheckFlag,0);
 781   3                              ReadUTC = false;        //初始化读ADC
 782   3                              }
 783   2                      else
 784   2                              {
 785   3                              
 786   3                              /*
 787   3                              if(wechatStatus == WECHAT_ST_OK&&B_Debug_Send==false)
 788   3                                      {
 789   3                                      sendMeasureData();
 790   3                                      B_Debug_Send=true;
 791   3                                      }
 792   3                              */              
 793   3                              if(B_Debug_Send==false)
 794   3                                      {
 795   4                                      
 796   4                                      if(ReadUTC==false)
 797   4                                              {
 798   5                                              ReadUTC=true;
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 14  

 799   5                                              R_Weight_Com_Coo.sucess=false;
 800   5                                              R_Weight_Com_Coo.fail=false;
 801   5                                              R_Weight_Com_Coo.now = CS_CommTo1186_ReadTime;          
 802   5                                              }
 803   4                                      
 804   4                                      if(R_Weight_Com_Coo.sucess==true)
 805   4                                              {
 806   5                                              
 807   5                                              
 808   5                                              ReadUTC=false;
 809   5                                              R_Weight_Com_Coo.sucess=false;
 810   5                                              
 811   5                                              SendData.UTCTime[0]=R_1186_RTC[0];
 812   5                                              SendData.UTCTime[1]=R_1186_RTC[1];      
 813   5                                              SendData.UTCTime[2]=R_1186_RTC[2];      
 814   5                                              SendData.UTCTime[3]=R_1186_RTC[3];      
 815   5                                              SendData.weight=ESWAP(R_UnitWeight.origin);
 816   5                                              QueuePush(&SendData);
 817   5                                              B_Debug_Send=true;
 818   5                                              R_Weight_Com_Coo.now = CS_CommTo1186_ReadAd;
 819   5                                              //CS_SoftTimer(ResetSoftTimer); 
 820   5                                              
 821   5                                              }
 822   4                                      }
 823   3                              else
 824   3                                      {
 825   4                                      R_AD_BUF = CS_Scale_GetDeltaAD(GetDeltaAD);
 826   4                                      R_AD_BUF = CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
 827   4                                      CS_Scale_GetWeight(R_AD_BUF);                           
 828   4                                      CS_Scale_ReturnLock();
 829   4                                      }
 830   3                              }
 831   2                      }
 832   1      
 833   1                              /*
 834   1                              if(CS_SoftTimer(GetSoftTimerTime)<200)
 835   1                                      {
 836   1                              R_Debug_temp=SendData.UTCTime;
 837   1                              CS_ScaleDisplay_Debug();                        
 838   1                              return;
 839   1                                      }
 840   1                              */      
 841   1                              /* B_Debug_Test =true;
 842   1                              if(B_Debug_Test)
 843   1                                      {
 844   1                                      R_Debug_temp=888;
 845   1                                      CS_ScaleDisplay_Debug();
 846   1                                      while(1);
 847   1                                      }
 848   1                              */
 849   1      }
 850          
 851          
 852          
 853          void CS_Scale_ReturnLock(void)
 854          {
 855   1              u16_t   weight_temp;
 856   1              
 857   1              if( R_UnitWeight.origin > R_Weight_Lock)
 858   1                      {
 859   2                      weight_temp = R_UnitWeight.origin -R_Weight_Lock;
 860   2                      if(weight_temp >= CS_Scale_RetLockWeightInc)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 15  

 861   2                              {
 862   3                              R_Scale_state = CS_Scale_state_weighting;
 863   3                              CS_Scale_TimeOutProc(CS_Reset_AllTime);
 864   3                              }
 865   2                      }
 866   1              else
 867   1                      {
 868   2                      weight_temp = R_Weight_Lock -R_UnitWeight.origin;
 869   2                      if(weight_temp >= CS_Scale_RetLockWeightDec)
 870   2                              {
 871   3                              
 872   3                              R_Scale_state = CS_Scale_state_weighting;
 873   3                              CS_Scale_LockProc(SetDowningLock);
 874   3                              CS_Scale_TimeOutProc(CS_Reset_AllTime);
 875   3                              
 876   3                              }
 877   2                      }
 878   1      
 879   1      }
 880          
 881          #define StartClearMemWeightTimer        1
 882          #define MemWeightTimerInc                       2
 883          #define MemWeightTimer                  30
 884          
 885          void CS_MemoryWeightClear_Timer(u8_t option)
 886          {
 887   1              static u8_t xdata timecount;                            //计时变量
 888   1              static u8_t xdata B_Timeout;
 889   1      
 890   1              if(option==StartClearMemWeightTimer)
 891   1                      {
 892   2                      timecount=0;
 893   2                      B_Timeout = false;
 894   2                      }
 895   1      
 896   1              if(option==MemWeightTimerInc)
 897   1                      {
 898   2                      if(timecount<255 ) 
 899   2                      timecount++;
 900   2                      }
 901   1              
 902   1              if(B_Timeout == false)
 903   1                      {
 904   2                      if(timecount>SoftTimerTimeOut)
 905   2                              {
 906   3                              B_Timeout = true;
 907   3                              R_Weight_Mem = 0;       //时间到清记忆重量
 908   3                              }
 909   2                      }
 910   1      }
 911          
 912          
 913          ///////////////////////////////////标定流程
 914          #define CS_CaliState_GetZero                    0
 915          #define CS_CaliState_ShowCal1                   1
 916          #define CS_CaliState_GetCal1                    2
 917          #define CS_CaliState_ShowCal2                   3
 918          #define CS_CaliState_GetCal2                    4
 919          #define CS_CaliState_ShowCal3                   5
 920          #define CS_CaliState_GetCal3                    6
 921          #define CS_CaliState_ShowCal4                   7
 922          #define CS_CaliState_SaveData                   8
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 16  

 923          #define CS_CaliState_ShowPass                   9
 924          #define CS_CaliState_ShowErr                    10
 925          
 926          u16_t CS_Scale_CaliProc(u8_t option)
 927          {
 928   1              static  u16_t xdata R_AD_CaliDot1;              //第一个标定点AD值
 929   1              static  u16_t xdata R_AD_CaliDot2;              //第二个标定点AD值
 930   1              static  u16_t xdata R_AD_CaliDot3;              //第三个标定点AD值
 931   1              static  u8_t      xdata R_CaliState;                    //标定状态
 932   1              static  u16_t xdata R_OpenWeight_Ad;    //开机重量AD值
 933   1              
 934   1              u16_t   R_AdFilTimes;   
 935   1              u16_t   weight_temp;
 936   1              u16_t   R_AD_BUF;
 937   1              u16_t   R_AD_PowerOnZero;
 938   1      
 939   1              if(option==CaliProcReset)
 940   1                      {
 941   2                      R_CaliState=CS_CaliState_GetZero;
 942   2                      return  0;
 943   2                      }
 944   1              if(option==CaliProcSetCali)
 945   1                      {
 946   2      /*
 947   2                      *(mem_sensor_buf )= 12;
 948   2                      *(mem_sensor_buf+1) = 12;
 949   2                      *(mem_sensor_buf+2 )= 12;
 950   2                      *(mem_sensor_buf+3) = 12;
 951   2                      *(mem_sensor_buf+4 )= 12;
 952   2                      *(mem_sensor_buf+5) = 12;
 953   2                      SpiFlashOperator(CS_CMD_WRITE_FLASH);
 954   2                      //YC_Delay10ms(10);
 955   2                      
 956   2                      *(mem_sensor_buf )= 0;
 957   2                      *(mem_sensor_buf+1) = 0;
 958   2                      *(mem_sensor_buf+2 )= 0;
 959   2                      *(mem_sensor_buf+3) = 0;
 960   2                      *(mem_sensor_buf+4 )= 0;
 961   2                      *(mem_sensor_buf+5) = 0;
 962   2                      
 963   2                      
 964   2                      SpiFlashOperator( CS_CMD_READ_FLASH);
 965   2                      
 966   2                      
 967   2                      
 968   2                      R_Debug_temp=(u16_t) *(mem_sensor_buf+2 ) ;
 969   2                      CS_ScaleDisplay_Debug();
 970   2                      while(1);
 971   2                      */
 972   2                      //YC_Delay1S(1);
 973   2                      
 974   2                      R_AD_BUF = *(mem_sensor_buf );
 975   2                      R_AD_CaliDot1 =R_AD_BUF<<8 |  (*(mem_sensor_buf+1));
 976   2                      R_AD_BUF = *(mem_sensor_buf+2 );
 977   2                      R_AD_CaliDot2 =R_AD_BUF<<8 |  (*(mem_sensor_buf+3));
 978   2                      R_AD_BUF = *(mem_sensor_buf+4 );
 979   2                      R_AD_CaliDot3 =R_AD_BUF<<8 |  (*(mem_sensor_buf+5));    
 980   2      
 981   2                      
 982   2      
 983   2                      if(R_AD_CaliDot1<CS_CaliStateData_Down || R_AD_CaliDot1>CS_CaliStateData_Up)
 984   2                              if(R_AD_CaliDot2<CS_CaliStateData_Down||R_AD_CaliDot2>CS_CaliStateData_Up)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 17  

 985   2                                      if(R_AD_CaliDot3<CS_CaliStateData_Down||R_AD_CaliDot3>CS_CaliStateData_Up)
 986   2                                              {
 987   3                                              R_AD_CaliDot1   = 6000;
 988   3                                              R_AD_CaliDot2   = 5000;
 989   3                                              R_AD_CaliDot3   = 4000; 
 990   3                                              }       
 991   2                      
 992   2                      
 993   2                      R_OpenWeight_Ad = R_AD_CaliDot1/10;
 994   2                      return  0;              
 995   2                      }
 996   1              if(option==CaliProcSetOpenWeight)
 997   1                      {
 998   2                      R_OpenWeight_Ad = R_AD_CaliDot1/10;
 999   2                      return  0;
1000   2                      }
1001   1              
1002   1              if(option==CaliProcGetOpenWeight)
1003   1                      return R_OpenWeight_Ad;
1004   1              if(option==CaliProcGetCaliDot1)
1005   1                      return R_AD_CaliDot1;
1006   1              if(option==CaliProcGetCaliDot2)
1007   1                      return R_AD_CaliDot2;
1008   1              if(option==CaliProcGetCaliDot3)
1009   1                      return R_AD_CaliDot3;
1010   1              
1011   1              R_AD_BUF = R_AD_Original;
1012   1              R_AD_BUF=CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
1013   1              R_AdFilTimes = CS_Scale_AdcFilter(ScaleAdcFilterGetFilTimes,R_AD_BUF);
1014   1              
1015   1              
1016   1      
1017   1              //数据稳定才处理
1018   1                      
1019   1              if(R_CaliState==CS_CaliState_GetZero) 
1020   1                      {       
1021   2      
1022   2                              R_AD_CaliDot1 = R_AD_BUF;       //暂存零点用于显示
1023   2                              if(R_AdFilTimes>=60)
1024   2                                      {
1025   3                              CS_Scale_ZeroProc(SetPowerOnZero,R_AD_BUF);     
1026   3                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1027   3                              CS_SoftTimer(ResetSoftTimer);
1028   3                              R_CaliState = CS_CaliState_ShowCal1;
1029   3                                      }
1030   2                      CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_BUF);
1031   2                      }
1032   1              
1033   1              if(R_CaliState == CS_CaliState_ShowCal1)
1034   1                      {
1035   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)  
1036   2                              R_CaliState = CS_CaliState_GetCal1;
1037   2                      CS_ScaleDisplay_FreshBuf(DisplayCal1,0);
1038   2                      }
1039   1      
1040   1              if(R_CaliState==CS_CaliState_GetCal1)
1041   1                      {       
1042   2                              R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);  
1043   2                              R_AD_CaliDot1 = R_AD_BUF - R_AD_PowerOnZero;
1044   2                                      
1045   2                              if((R_AD_CaliDot1 < R_OpenWeight_Ad)||(R_AD_BUF < R_AD_PowerOnZero))
1046   2                                      {
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 18  

1047   3                                      if(R_AdFilTimes>=60)
1048   3                                              {
1049   4                                              CS_Scale_ZeroProc(SetPowerOnZero,R_AD_BUF);     
1050   4                                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1051   4                                              }
1052   3                                      R_AD_CaliDot1 = 0;
1053   3                                      }
1054   2                              else
1055   2                                      {
1056   3                                      if((R_AD_CaliDot1> 750)&&(R_AdFilTimes>=60))
1057   3                                              {                               
1058   4                                              CS_SoftTimer(ResetSoftTimer);
1059   4                                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1060   4                                              R_CaliState = CS_CaliState_ShowCal2;
1061   4                                              }
1062   3                                      }
1063   2                              CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_CaliDot1);
1064   2                              
1065   2                      }
1066   1      
1067   1              if(R_CaliState == CS_CaliState_ShowCal2)
1068   1                      {
1069   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)  
1070   2                              R_CaliState = CS_CaliState_GetCal2;
1071   2                      CS_ScaleDisplay_FreshBuf(DisplayCal2,0);
1072   2                      }
1073   1              
1074   1              if(R_CaliState==CS_CaliState_GetCal2)
1075   1                      {               
1076   2                              R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);          
1077   2                              weight_temp = R_AD_BUF - R_AD_PowerOnZero;
1078   2                                              
1079   2                              if((weight_temp < R_AD_CaliDot1)||(R_AD_BUF < R_AD_PowerOnZero))
1080   2                                      {
1081   3                                      R_AD_CaliDot2 = 0;
1082   3                                      }
1083   2                              else
1084   2                                      {
1085   3                                      R_AD_CaliDot2 = weight_temp -R_AD_CaliDot1;
1086   3                              
1087   3                                      if((R_AD_CaliDot2> 750)&& (R_AdFilTimes>=60))
1088   3                                              {
1089   4                                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1090   4                                              CS_SoftTimer(ResetSoftTimer);
1091   4                                              R_CaliState = CS_CaliState_ShowCal3;
1092   4                                              }
1093   3                                      }
1094   2                              CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_CaliDot2);
1095   2                      }
1096   1      
1097   1              if(R_CaliState == CS_CaliState_ShowCal3)
1098   1                      {
1099   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)  
1100   2                              R_CaliState = CS_CaliState_GetCal3;
1101   2                      CS_ScaleDisplay_FreshBuf(DisplayCal3,0);
1102   2                      }
1103   1              
1104   1              if(R_CaliState==CS_CaliState_GetCal3)
1105   1                      {               
1106   2                              R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);          
1107   2                              weight_temp = R_AD_BUF - R_AD_PowerOnZero;
1108   2                                              
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 19  

1109   2                              if((weight_temp < R_AD_CaliDot1)||(R_AD_BUF < R_AD_PowerOnZero))
1110   2                                      {
1111   3                                      R_AD_CaliDot3 = 0;
1112   3                                      }
1113   2                              else
1114   2                                      {
1115   3                                      weight_temp = weight_temp -R_AD_CaliDot1;
1116   3      
1117   3                                      if(weight_temp < R_AD_CaliDot2)
1118   3                                              {
1119   4                                              R_AD_CaliDot3 = 0;
1120   4                                              
1121   4                                              }
1122   3                                      else
1123   3                                              {
1124   4                                      R_AD_CaliDot3 = weight_temp -R_AD_CaliDot2;
1125   4                              
1126   4                                      if((R_AD_CaliDot3> 750)&& (R_AdFilTimes>=60))
1127   4                                              {
1128   5                                              CS_SoftTimer(ResetSoftTimer);
1129   5                                              R_CaliState = CS_CaliState_ShowCal4;
1130   5                                              }
1131   4                                              }
1132   3                                      }
1133   2                              CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_CaliDot3);
1134   2                      }
1135   1              
1136   1              if(R_CaliState == CS_CaliState_ShowCal4)
1137   1                      {
1138   2                      if(CS_SoftTimer(GetSoftTimerTime)>200) 
1139   2                              R_CaliState = CS_CaliState_SaveData;
1140   2                      CS_ScaleDisplay_FreshBuf(DisplayCal4,0);
1141   2                      }
1142   1              
1143   1              if(R_CaliState==CS_CaliState_SaveData)
1144   1                      {
1145   2                      
1146   2                      R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);
1147   2                      CS_Scale_ZeroProc(SetRunningZero,R_AD_PowerOnZero);
1148   2                      R_Scale_state = CS_Scale_state_weighting;
1149   2                      R_OpenWeight_Ad =  R_AD_CaliDot1/10;
1150   2      
1151   2                      /*
1152   2                      R_Debug_temp=R_AD_CaliDot2;
1153   2                      CS_ScaleDisplay_Debug();
1154   2                      while(1);
1155   2                      */
1156   2                      
1157   2                      *(mem_sensor_buf )= HI_UINT16(R_AD_CaliDot1);
1158   2                      *(mem_sensor_buf+1) = LO_UINT16(R_AD_CaliDot1);
1159   2                      *(mem_sensor_buf+2 )= HI_UINT16(R_AD_CaliDot2);
1160   2                      *(mem_sensor_buf+3) = LO_UINT16(R_AD_CaliDot2);
1161   2                      *(mem_sensor_buf+4 )= HI_UINT16(R_AD_CaliDot3);
1162   2                      *(mem_sensor_buf+5) = LO_UINT16(R_AD_CaliDot3);
1163   2                      SpiFlashOperator(CS_CMD_WRITE_FLASH);
1164   2      
1165   2                      
1166   2      
1167   2                      }
1168   1              return 0;
1169   1              
1170   1      }
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 20  

1171          
1172          
1173          
1174          ///////////////////////////////////待机流程
1175          
1176          #define CS_Standby_S1_ToSleep                           0
1177          #define CS_Standby_S2_WakeUp                            1
1178          #define CS_Standby_S3_xxxx                              2
1179          
1180          
1181          
1182          void CS_Scale_StandbyProc(u8_t B_Reset)
1183          {
1184   1              static u8_t xdata comm_doing;
1185   1              static u8_t xdata StandbyState;
1186   1      
1187   1              if(B_Reset==1)
1188   1                      {
1189   2                      StandbyState=CS_Standby_S1_ToSleep;
1190   2                      comm_doing=false;
1191   2                      return;
1192   2                      }
1193   1      
1194   1              if(B_Reset==2)
1195   1                      {
1196   2                      StandbyState=CS_Standby_S2_WakeUp;
1197   2                      comm_doing=false;
1198   2                      return;
1199   2                      }
1200   1              
1201   1              switch(StandbyState)
1202   1              {
1203   2              case CS_Standby_S1_ToSleep:
1204   2                      if(comm_doing==false)
1205   2                              {
1206   3                              comm_doing=true;
1207   3                              R_Weight_Com_Coo.now = CS_CommTo1186_SetSleepMode;
1208   3                              R_Weight_Com_Coo.sucess=false;
1209   3                              R_Weight_Com_Coo.fail=false;
1210   3                              //sys_state = SYS_ST_IDLE;                      //系统进入睡眠
1211   3                              }
1212   2                      if(R_Weight_Com_Coo.sucess==true)
1213   2                              {
1214   3                              comm_doing=false;
1215   3                              StandbyState =  CS_Standby_S2_WakeUp;
1216   3      
1217   3                              btCmdBuf.len = 0x01;
1218   3                              btCmdBuf.DATA[0] = CS_CMD_SLEEP_REQ;
1219   3                              BT_CmdFifoIn(&btCmdBuf);
1220   3      
1221   3                              //btCmdBuf.len = 2;
1222   3                              //btCmdBuf.DATA[0] = 0x20;
1223   3                              //btCmdBuf.DATA[1] = 0;
1224   3                              //BT_CmdFifoIn(&btCmdBuf);
1225   3                              
1226   3                               
1227   3                              sys_state = SYS_ST_IDLE;  //SYS_ST_SLEEP;                       //系统进入睡眠
1228   3                                              
1229   3                              }       
1230   2                      break;
1231   2              case CS_Standby_S2_WakeUp:
1232   2                      if(comm_doing==false)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 21  

1233   2                              {
1234   3                              comm_doing=true;
1235   3                              R_Weight_Com_Coo.now = CS_CommTo1186_ReadAdZero;
1236   3                              R_Weight_Com_Coo.sucess=false;
1237   3                              R_Weight_Com_Coo.fail=false;
1238   3                              }
1239   2                      if(R_Weight_Com_Coo.sucess==true)
1240   2                              {
1241   3                              comm_doing=false;
1242   3                              StandbyState =  CS_Standby_S1_ToSleep;  
1243   3                              sys_state = SYS_ST_RUN;
1244   3      
1245   3                              /*
1246   3                              while(1)
1247   3                              {
1248   3                              R_Debug_temp = R_AD_Zero;
1249   3                              CS_ScaleDisplay_Debug();
1250   3                              }
1251   3                              */
1252   3                              //清除异常状态
1253   3                              CS_Scale_JudgeOverLoad(ResetOverLoad);
1254   3                              CS_Scale_TimeOutProc(CS_Reset_AllTime);
1255   3                              R_Display_Err = 0;
1256   3                              
1257   3                              R_Scale_state = CS_Scale_state_weighting;
1258   3                              R_Weight_Com_Coo.now = CS_CommTo1186_ReadAd;    
1259   3                              }
1260   2                      break;
1261   2              default:
1262   2                      StandbyState = CS_Standby_S1_ToSleep;
1263   2                      break;
1264   2              }
1265   1              
1266   1              //R_Debug_temp = 456;
1267   1      
1268   1      }
1269          
1270          
1271          ///////////////////////////////////开机流程
1272          
1273          #define CS_PowerOn_State1_Reset                         0
1274          #define CS_PowerOn_State2_ReadOtp                               1
1275          #define CS_PowerOn_State3_ReadVersion                   2
1276          #define CS_PowerOn_State4_ReadTime                      3
1277          #define CS_PowerOn_State5_SetOpenWeight         4
1278          #define CS_PowerOn_State6_ShowOpenPic           5
1279          #define CS_PowerOn_State7_ShowOpenPicWait       6
1280          
1281          
1282          void CS_Scale_PowerOnProc(bool B_Reset)
1283          {
1284   1              static u8_t xdata comm_doing;
1285   1              static u8_t xdata PowerOnState;
1286   1              
1287   1              
1288   1              if(B_Reset)
1289   1                      {
1290   2                      PowerOnState=CS_PowerOn_State1_Reset;
1291   2                      comm_doing=false;
1292   2                      return;
1293   2                      }
1294   1              
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 22  

1295   1              //-----------S1
1296   1              if(PowerOnState==CS_PowerOn_State1_Reset)
1297   1                      {
1298   2                      if(comm_doing==false)
1299   2                              {
1300   3                              comm_doing=true;
1301   3                              R_Weight_Com_Coo.now = CS_CommTo1186_Reset;
1302   3                              }
1303   2                      else
1304   2                              {
1305   3                              comm_doing=false;
1306   3                              PowerOnState    = CS_PowerOn_State2_ReadOtp;
1307   3                              }               
1308   2                      }
1309   1              //-----------S2
1310   1              if(PowerOnState==CS_PowerOn_State2_ReadOtp)
1311   1                      {
1312   2                      if(comm_doing==false)
1313   2                              {
1314   3                              comm_doing=true;
1315   3                              R_Weight_Com_Coo.now = CS_CommTo1186_ReadOtp;
1316   3                              R_Weight_Com_Coo.sucess=false;
1317   3                              R_Weight_Com_Coo.fail=false;
1318   3                              }
1319   2                      if(R_Weight_Com_Coo.sucess==true)
1320   2                              {
1321   3                              comm_doing=false;
1322   3                              PowerOnState =  CS_PowerOn_State3_ReadVersion;
1323   3                              }
1324   2                      }
1325   1              //-----------S3
1326   1              if(PowerOnState==CS_PowerOn_State3_ReadVersion)
1327   1                      {
1328   2                      PowerOnState =  CS_PowerOn_State4_ReadTime;             
1329   2                      }
1330   1              //-----------S4
1331   1              if(PowerOnState==CS_PowerOn_State4_ReadTime)
1332   1                      {
1333   2                      if(comm_doing==false)
1334   2                              {
1335   3                              comm_doing=true;
1336   3                              R_Weight_Com_Coo.now = CS_CommTo1186_ReadTime;
1337   3                              R_Weight_Com_Coo.sucess=false;
1338   3                              R_Weight_Com_Coo.fail=false;
1339   3                              }
1340   2                      if(R_Weight_Com_Coo.sucess==true)
1341   2                              {
1342   3                              comm_doing=false;
1343   3                              PowerOnState =  CS_PowerOn_State5_SetOpenWeight;        
1344   3                              }
1345   2                      }
1346   1              //-----------S5
1347   1              if(PowerOnState==CS_PowerOn_State5_SetOpenWeight)
1348   1                      {
1349   2                      if(comm_doing==false)
1350   2                              {
1351   3                              comm_doing=true;
1352   3                              R_Weight_Com_Coo.now = CS_CommTo1186_SetOpenWeight;
1353   3                              R_Weight_Com_Coo.sucess=false;
1354   3                              R_Weight_Com_Coo.fail=false;
1355   3                              }
1356   2                      if(R_Weight_Com_Coo.sucess==true)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 23  

1357   2                              {
1358   3                              comm_doing=false;
1359   3                              PowerOnState =  CS_PowerOn_State6_ShowOpenPic;
1360   3                              }
1361   2                      }
1362   1              //-----------S6
1363   1              if(PowerOnState==CS_PowerOn_State6_ShowOpenPic)
1364   1                      {
1365   2                      if(comm_doing==false)
1366   2                              {
1367   3                              comm_doing=true;        
1368   3                              CS_ScaleDisplay_FreshBuf(DisplayData,8888);
1369   3                              R_Weight_Com_Coo.now = CS_CommTo1186_LcdDisplay;
1370   3                              R_Weight_Com_Coo.sucess=false;
1371   3                              R_Weight_Com_Coo.fail=false;
1372   3                              
1373   3                              }
1374   2                      if(R_Weight_Com_Coo.sucess==true)
1375   2                              {       
1376   3                              comm_doing=false;
1377   3                              R_Weight_Com_Coo.sucess=false;
1378   3                              PowerOnState =  CS_PowerOn_State7_ShowOpenPicWait;
1379   3                              CS_SoftTimer(ResetSoftTimer);
1380   3                              }               
1381   2                      }
1382   1              //-----------S7
1383   1              if(PowerOnState==CS_PowerOn_State7_ShowOpenPicWait)
1384   1                      {
1385   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)
1386   2                              {
1387   3                              R_Scale_state = CS_Scale_state_weighting;
1388   3                              R_Weight_Com_Coo.now = CS_CommTo1186_ReadAd;    
1389   3                              }
1390   2                      }
1391   1      
1392   1      }
1393          
1394          
1395          
1396          
1397          u8_t CS_SoftTimer(u8_t option)
1398          {
1399   1              static u8_t xdata timecount;                            //计时变量
1400   1              static u8_t xdata B_Timeout;
1401   1      
1402   1              if(option==ResetSoftTimer)
1403   1                      {
1404   2                      timecount=0;
1405   2                      B_Timeout = false;
1406   2                      }
1407   1      
1408   1              if(option==GetSoftTimerTime)
1409   1                      return  timecount;
1410   1      
1411   1              if(option==SoftTimerInc)
1412   1                      {
1413   2                      if(timecount<255 ) 
1414   2                      timecount++;
1415   2                      }
1416   1              
1417   1              
1418   1              if(timecount>SoftTimerTimeOut)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 24  

1419   1                      B_Timeout = true;
1420   1      
1421   1              if(option==GetIfTimeOut)
1422   1                      return  B_Timeout;
1423   1              
1424   1              return 0;
1425   1      
1426   1      }
1427          
1428          
1429          
1430          
1431          
1432          ///////////////////////////////////超时处理
1433          
1434          
1435          typedef struct _CS_TimeOut_T{
1436                  u8_t zero;      
1437                  u8_t lock;
1438                  u8_t unstable;
1439                  u8_t overload;
1440                  u8_t lowbat;
1441          }CS_TimeOut_T;
1442          
1443          
1444          
1445          void CS_Scale_TimeOutProc(u8_t option)
1446          {
1447   1              static  CS_TimeOut_T xdata R_TimeOut;
1448   1              static  u8_t xdata B_TimeBase_1s;               //1s时基
1449   1      
1450   1              if(option==CS_SetTimeBase1S)
1451   1                      {
1452   2                      B_TimeBase_1s = true;
1453   2                      return;
1454   2                      }
1455   1              //超时计数器复位
1456   1              if(option)
1457   1              {
1458   2              if(option==CS_Reset_ZeroTime)
1459   2                      R_TimeOut.zero=0;
1460   2              if(option==CS_Reset_LockTime)
1461   2                      R_TimeOut.lock=0;
1462   2              if(option==CS_Reset_UnstableTime)
1463   2                      R_TimeOut.unstable=0;
1464   2              if(option==CS_Reset_OverLoadTime)
1465   2                      R_TimeOut.overload=0;
1466   2              if(option==CS_Reset_LowBatTime)
1467   2                      R_TimeOut.lowbat=0;
1468   2              if(option==CS_Reset_AllTime)
1469   2                      {
1470   3                      R_TimeOut.zero=0;
1471   3                      R_TimeOut.lock=0;
1472   3                      R_TimeOut.unstable=0;
1473   3                      R_TimeOut.overload=0;
1474   3                      R_TimeOut.lowbat=0;
1475   3                      }
1476   2              return;
1477   2              }
1478   1                      
1479   1              if(B_TimeBase_1s == true)
1480   1              {
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 25  

1481   2                      B_TimeBase_1s = false;
1482   2      
1483   2                      //低电超时处理
1484   2                      if(CS_Scale_JudgeLowBat(GetIfLowBat) == true)
1485   2                      {
1486   3                              R_TimeOut.lowbat++;
1487   3      
1488   3                              if(R_TimeOut.lowbat>=CS_Scale_TimeOut_LowBat)
1489   3                              {
1490   4                                      R_Scale_state = CS_Scale_state_standby;
1491   4                                      CS_Scale_StandbyProc(1);
1492   4                                      R_TimeOut.lowbat=0;
1493   4                              }
1494   3                      return;                 
1495   3                      }
1496   2      
1497   2                      //超载超时处理
1498   2                      if(CS_Scale_JudgeOverLoad(GetIfOverLoad)== true)
1499   2                      {
1500   3                              R_TimeOut.overload++;
1501   3      
1502   3                              if(R_TimeOut.overload>=CS_Scale_TimeOut_OverLoad)
1503   3                              {
1504   4                                      R_Scale_state = CS_Scale_state_standby;
1505   4                                      CS_Scale_StandbyProc(1);
1506   4                                      R_TimeOut.overload=0;
1507   4                              }
1508   3                      return; 
1509   3      
1510   3                      }
1511   2                      
1512   2                      
1513   2                      //称重模式下的超时处理
1514   2                      if(R_Scale_state == CS_Scale_state_weighting)
1515   2                      {
1516   3                      
1517   3                      if(CS_Scale_ZeroProc(GetZeroState,0) != false)
1518   3                              {
1519   4                              R_TimeOut.zero++;
1520   4                              }
1521   3                      else
1522   3                              {
1523   4                              //R_Debug_temp=R_TimeOut.zero;
1524   4                              //CS_ScaleDisplay_Debug();
1525   4                              //while(1);
1526   4                              R_TimeOut.zero=0;
1527   4                              }
1528   3      
1529   3                      if(CS_Scale_JudgeSteady(GetIfSmallSteady)==true)
1530   3                              R_TimeOut.unstable=0;
1531   3                      else
1532   3                              R_TimeOut.unstable++;
1533   3      
1534   3      
1535   3                      if(R_TimeOut.zero >=CS_Scale_TimeOut_Zero||R_TimeOut.unstable>=CS_Scale_TimeOut_Unstable)
1536   3                              {
1537   4                                      R_Scale_state = CS_Scale_state_standby;
1538   4                                      CS_Scale_StandbyProc(1);
1539   4                                      R_TimeOut.zero=0;
1540   4                                      R_TimeOut.unstable=0;
1541   4                              }
1542   3                      return;
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 26  

1543   3      
1544   3                      }
1545   2                      
1546   2      
1547   2                      //锁定模式下的超时处理
1548   2                      if(R_Scale_state == CS_Scale_state_locking)
1549   2                      {
1550   3                              R_TimeOut.unstable=0;
1551   3                              R_TimeOut.lock++;
1552   3                              
1553   3                              if(R_TimeOut.lock>=CS_Scale_TimeOut_Lock)
1554   3                              {
1555   4                                      R_Scale_state = CS_Scale_state_standby;
1556   4                                      CS_Scale_StandbyProc(1);
1557   4                                      R_TimeOut.lock=0;
1558   4                              }
1559   3                      return;
1560   3                      }               
1561   2                      
1562   2      
1563   2              }
1564   1      
1565   1      }
1566          
1567          
1568          
1569          
1570          
1571          
1572          
1573          
1574          
1575          
1576          
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 27  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION CS_Scale_Proc (BEGIN)
                                           ; SOURCE LINE # 122
                                           ; SOURCE LINE # 123
                                           ; SOURCE LINE # 124
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0001
                                           ; SOURCE LINE # 125
                                           ; SOURCE LINE # 126
                 R     CLR     ?CS_Scale_PowerOnProc?BIT
                 R     CALL    CS_Scale_PowerOnProc
                                           ; SOURCE LINE # 127
             ?C0001:
                                           ; SOURCE LINE # 128
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#02H,?C0002
                                           ; SOURCE LINE # 129
                                           ; SOURCE LINE # 130
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 131
             ?C0002:
                                           ; SOURCE LINE # 133
                 R     MOV     DPTR,#B_Weight_AdOk
                       MOVX    A,@DPTR
                       XRL     A,#01H
                 R     xJNZ    ?C0009
                                           ; SOURCE LINE # 134
                                           ; SOURCE LINE # 135
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 137
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_ZeroProc
                       MOV     A,R7
                       ORL     A,R6
                 R     xJNZ    ?C0004
                                           ; SOURCE LINE # 138
                                           ; SOURCE LINE # 139
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#0AH
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 140
                       RET     
             ?C0004:
                                           ; SOURCE LINE # 142
                                           ; SOURCE LINE # 144
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0006
                                           ; SOURCE LINE # 145
                                           ; SOURCE LINE # 146
                 R     CALL    CS_Scale_WeightProc
                                           ; SOURCE LINE # 147
                 E     CALL    CS_ScaleDisplay
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 28  

                                           ; SOURCE LINE # 148
             ?C0006:
                                           ; SOURCE LINE # 149
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#04H,?C0007
                                           ; SOURCE LINE # 150
                                           ; SOURCE LINE # 151
                 E     CALL    CS_ScaleDisplay_SteadyFlash
                                           ; SOURCE LINE # 152
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_SteadyProc
                                           ; SOURCE LINE # 153
             ?C0007:
                                           ; SOURCE LINE # 154
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#03H,?C0008
                                           ; SOURCE LINE # 155
                                           ; SOURCE LINE # 156
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_CaliProc
                                           ; SOURCE LINE # 157
             ?C0008:
                                           ; SOURCE LINE # 159
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 160
                                           ; SOURCE LINE # 161
                                           ; SOURCE LINE # 162
             ?C0009:
                       RET     
             ; FUNCTION CS_Scale_Proc (END)

             ; FUNCTION CS_Scale_PowerOn (BEGIN)
                                           ; SOURCE LINE # 170
                                           ; SOURCE LINE # 171
                                           ; SOURCE LINE # 173
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0011
                                           ; SOURCE LINE # 174
                                           ; SOURCE LINE # 175
                 R     MOV     DPTR,#B_Weight_AdOk
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 176
                 E     MOV     DPTR,#R_Weight_Com_Coo+01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 177
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 179
                 R     MOV     DPTR,#R_Selet_Unit
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 181
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 182
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 29  

                 R     CLR     B_Debug_Test
                                           ; SOURCE LINE # 184
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_CaliProc
                                           ; SOURCE LINE # 185
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#04H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 187
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 188
                 R     SETB    ?CS_Scale_PowerOnProc?BIT
                 R     CALL    CS_Scale_PowerOnProc
                                           ; SOURCE LINE # 189
                                           ; SOURCE LINE # 190
             ?C0011:
                       RET     
             ; FUNCTION CS_Scale_PowerOn (END)

             ; FUNCTION CS_Scale_WeightProc (BEGIN)
                                           ; SOURCE LINE # 199
                                           ; SOURCE LINE # 200
                                           ; SOURCE LINE # 203
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_GetDeltaAD
;---- Variable 'R_AD_BUF' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 204
                       MOV     R5,AR7
                       MOV     R4,AR6
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 205
                 R     CALL    _CS_Scale_GetWeight
                                           ; SOURCE LINE # 206
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#07H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 207
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_LockProc
                                           ; SOURCE LINE # 208
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_JudgeOverLoad
                                           ; SOURCE LINE # 209
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_JudgeLowBat
                                           ; SOURCE LINE # 210
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_JudgeSteady
                                           ; SOURCE LINE # 212
                       RET     
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 30  

             ; FUNCTION CS_Scale_WeightProc (END)

             ; FUNCTION _CS_Scale_GetDeltaAD (BEGIN)
                                           ; SOURCE LINE # 216
                 R     MOV     DPTR,#option
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 217
                                           ; SOURCE LINE # 221
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_ZeroProc
;---- Variable 'R_AD_Zero' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 222
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0013
                                           ; SOURCE LINE # 223
                                           ; SOURCE LINE # 224
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                 R     MOV     DPTR,#ad_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 225
                 R     MOV     DPTR,#B_Weight_Pos
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 227
                 R     xJMP    ?C0014
             ?C0013:
                                           ; SOURCE LINE # 229
                                           ; SOURCE LINE # 230
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       CLR     C
                       MOV     A,R7
                       SUBB    A,R5
                       MOV     R7,A
                       MOV     A,R6
                       SUBB    A,R4
                 R     MOV     DPTR,#ad_temp
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 31  

                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 231
                       CLR     A
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 232
             ?C0014:
                                           ; SOURCE LINE # 235
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0015
                                           ; SOURCE LINE # 236
                                           ; SOURCE LINE # 237
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
                                           ; SOURCE LINE # 238
             ?C0015:
                                           ; SOURCE LINE # 239
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                                           ; SOURCE LINE # 240
             ?C0016:
                       RET     
             ; FUNCTION _CS_Scale_GetDeltaAD (END)

             ; FUNCTION _CS_Scale_AdcFilter (BEGIN)
                                           ; SOURCE LINE # 245
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
                 R     MOV     DPTR,#option
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 246
                                           ; SOURCE LINE # 259
                 R     xJNE    R7,#02H,?C0017
                                           ; SOURCE LINE # 260
                                           ; SOURCE LINE # 261
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 262
             ?C0017:
                                           ; SOURCE LINE # 265
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 32  

                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0019
                                           ; SOURCE LINE # 266
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOVX    A,@DPTR
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                       MOV     R6,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                 R     xJMP    ?C0020
             ?C0019:
                                           ; SOURCE LINE # 268
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF_OLD+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
             ?C0020:
                                           ; SOURCE LINE # 270
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_BUF_OLD
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 33  

                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 272
                       CLR     A
                       MOV     R7,#05H
                       MOV     R6,A
                       MOV     R5,A
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                       SETB    C
                 E     CALL    ?C?ULCMP
                 R     xJGE    ?C0022
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0021
             ?C0022:
                                           ; SOURCE LINE # 273
                                           ; SOURCE LINE # 274
                       CLR     A
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 275
                 R     MOV     DPTR,#R_AD_F1
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 276
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 277
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 278
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 279
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 34  

                                           ; SOURCE LINE # 280
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 281
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 282
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 283
                 R     xJMP    ?C0023
             ?C0021:
                                           ; SOURCE LINE # 285
                                           ; SOURCE LINE # 286
                       CLR     C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0C8H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0024
                                           ; SOURCE LINE # 287
                       INC     DPTR
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                 R     JNZ     ?C0234
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
             ?C0234:
             ?C0024:
                                           ; SOURCE LINE # 289
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       SETB    C
                       SUBB    A,#01H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0025
                                           ; SOURCE LINE # 290
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F1
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 35  

                       MOV     A,R5
                       MOVX    @DPTR,A
             ?C0025:
                                           ; SOURCE LINE # 291
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#02H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0026
                                           ; SOURCE LINE # 292
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F2
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0026:
                                           ; SOURCE LINE # 293
                       SETB    C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#03H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0027
                                           ; SOURCE LINE # 294
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F3
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0027:
                                           ; SOURCE LINE # 295
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       SETB    C
                       SUBB    A,#04H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0028
                                           ; SOURCE LINE # 296
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 36  

                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F4
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
             ?C0028:
                                           ; SOURCE LINE # 297
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#05H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0029
                                           ; SOURCE LINE # 298
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F5
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0029:
                                           ; SOURCE LINE # 299
                       SETB    C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#06H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0030
                                           ; SOURCE LINE # 300
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F6
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0030:
                                           ; SOURCE LINE # 301
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       SETB    C
                       SUBB    A,#07H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0031
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 37  

                                           ; SOURCE LINE # 302
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F7
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
             ?C0031:
                                           ; SOURCE LINE # 303
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#08H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0032
                                           ; SOURCE LINE # 304
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F8
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0032:
                                           ; SOURCE LINE # 305
                       SETB    C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#08H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0033
                                           ; SOURCE LINE # 306
                                           ; SOURCE LINE # 307
                 R     MOV     DPTR,#R_AD_F2
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F1
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 308
                 R     MOV     DPTR,#R_AD_F3
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F2
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 38  

                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 309
                 R     MOV     DPTR,#R_AD_F4
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F3
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 310
                 R     MOV     DPTR,#R_AD_F5
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F4
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 311
                 R     MOV     DPTR,#R_AD_F6
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F5
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 312
                 R     MOV     DPTR,#R_AD_F7
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F6
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 313
                 R     MOV     DPTR,#R_AD_F8
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F7
                       XCH     A,R7
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 39  

                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 314
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F8
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 315
             ?C0033:
                                           ; SOURCE LINE # 317
                 R     MOV     DPTR,#R_AD_F1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 318
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 40  

                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 319
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 320
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F4
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 41  

                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 321
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F5
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 322
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 42  

                 R     MOV     DPTR,#R_AD_F6
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 323
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F7
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 324
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 43  

                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F8
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 326
                       CLR     A
                       MOV     R3,#08H
                       MOV     R2,A
                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 327
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOV     A,R6
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 44  

                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 328
             ?C0023:
                                           ; SOURCE LINE # 329
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                                           ; SOURCE LINE # 330
             ?C0018:
                       RET     
             ; FUNCTION _CS_Scale_AdcFilter (END)

             ; FUNCTION _CS_Scale_GetWeight (BEGIN)
                                           ; SOURCE LINE # 335
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 336
                                           ; SOURCE LINE # 341
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#CaliDot1
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 342
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#CaliDot2
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 343
                       MOV     R7,#04H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#CaliDot3
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 345
                 R     MOV     DPTR,#CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 45  

                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJGE    ?C0034
                                           ; SOURCE LINE # 346
                                           ; SOURCE LINE # 347
                       MOV     R6,#013H
                       MOV     R7,#088H
                 E     CALL    ?C?LIMUL
                       INC     DPTR
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 348
                 R     MOV     DPTR,#CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R3,A
                       MOV     R2,AR6
                       CLR     A
                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
                 R     MOV     DPTR,#R_UnitWeight
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 350
             ?C0034:
                                           ; SOURCE LINE # 351
                 R     MOV     DPTR,#CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 46  

                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#ad_cal
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 353
                       CLR     C
                 R     MOV     DPTR,#CaliDot2+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#CaliDot2
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJLT    ?C0036
                                           ; SOURCE LINE # 354
                                           ; SOURCE LINE # 355
                 R     MOV     DPTR,#ad_cal
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#013H
                       MOV     R5,#088H
                 E     CALL    ?C?LIMUL
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 356
                 R     MOV     DPTR,#CaliDot2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R3,A
                       MOV     R2,AR6
                       CLR     A
                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
                       MOV     A,R7
                       ADD     A,#088H
                       MOV     R7,A
                       MOV     A,R6
                       ADDC    A,#013H
                 R     MOV     DPTR,#R_UnitWeight
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 47  

                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 358
             ?C0036:
                                           ; SOURCE LINE # 360
                 R     MOV     DPTR,#CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       CLR     C
                       MOV     A,R7
                       SUBB    A,R5
                       MOV     R7,A
                       MOV     A,R6
                       SUBB    A,R4
                 R     MOV     DPTR,#ad_cal
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 361
                 R     MOV     DPTR,#ad_cal
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#013H
                       MOV     R5,#088H
                 E     CALL    ?C?LIMUL
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 362
                 R     MOV     DPTR,#CaliDot3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R3,A
                       MOV     R2,AR6
                       CLR     A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 48  

                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
                       MOV     A,R7
                       ADD     A,#010H
                       MOV     R7,A
                       MOV     A,R6
                       ADDC    A,#027H
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
             ?C0035:
                       RET     
             ; FUNCTION _CS_Scale_GetWeight (END)

             ; FUNCTION CS_Scale_ChangeUnit (BEGIN)
                                           ; SOURCE LINE # 368
                                           ; SOURCE LINE # 369
                                           ; SOURCE LINE # 370
                 R     MOV     DPTR,#R_Selet_Unit
                       MOVX    A,@DPTR
                       DEC     A
                 R     xJZ     ?C0039
                       DEC     A
                 R     xJZ     ?C0041
                       DEC     A
                 R     xJZ     ?C0040
                       ADD     A,#03H
                 R     xJNZ    ?C0042
                                           ; SOURCE LINE # 371
                                           ; SOURCE LINE # 372
             ?C0038:
                                           ; SOURCE LINE # 373
                 R     MOV     DPTR,#R_Selet_Unit
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 374
                       RET     
                                           ; SOURCE LINE # 375
             ?C0039:
                                           ; SOURCE LINE # 376
                 R     MOV     DPTR,#R_Selet_Unit
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 377
                       RET     
                                           ; SOURCE LINE # 378
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 49  

             ?C0040:
                                           ; SOURCE LINE # 379
                 R     MOV     DPTR,#R_Selet_Unit
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 380
                       RET     
                                           ; SOURCE LINE # 381
             ?C0041:
                                           ; SOURCE LINE # 382
                       CLR     A
                 R     MOV     DPTR,#R_Selet_Unit
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 383
                       RET     
                                           ; SOURCE LINE # 384
             ?C0042:
                                           ; SOURCE LINE # 385
                       CLR     A
                 R     MOV     DPTR,#R_Selet_Unit
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 386
                                           ; SOURCE LINE # 387
                                           ; SOURCE LINE # 388
             ?C0043:
                       RET     
             ; FUNCTION CS_Scale_ChangeUnit (END)

             ; FUNCTION _CS_Scale_ZeroProc (BEGIN)
                                           ; SOURCE LINE # 392
;---- Variable 'setdata' assigned to Register 'R4/R5' ----
                 R     MOV     DPTR,#option
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 393
                                           ; SOURCE LINE # 410
                 R     xJNE    R7,#04H,?C0044
                                           ; SOURCE LINE # 411
                                           ; SOURCE LINE # 412
                       CLR     A
                 R     MOV     DPTR,#B_Weight_ZeroOk
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 413
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 414
             ?C0044:
                                           ; SOURCE LINE # 415
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     xJNE    A,#05H,?C0046
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 417
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 418
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 50  

                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 419
             ?C0046:
                                           ; SOURCE LINE # 420
                       MOV     A,R3
                 R     xJNE    A,#06H,?C0047
                                           ; SOURCE LINE # 421
                                           ; SOURCE LINE # 422
                       MOV     R7,AR5
                 R     MOV     DPTR,#R_AD_Zero
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 423
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 424
             ?C0047:
                                           ; SOURCE LINE # 425
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     xJNE    A,#08H,?C0048
                                           ; SOURCE LINE # 426
                                           ; SOURCE LINE # 427
                       CLR     A
                 R     MOV     DPTR,#B_LockDownCheck
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 428
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 429
             ?C0048:
                                           ; SOURCE LINE # 431
                       MOV     A,R5
                       XRL     A,#0AH
                 R     xJNZ    ?C0049
                                           ; SOURCE LINE # 432
                                           ; SOURCE LINE # 435
                 R     MOV     DPTR,#R_Weight_GetZeroTimeOut
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#03CH
                 R     xJGE    ?C0050
                                           ; SOURCE LINE # 436
                                           ; SOURCE LINE # 437
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 439
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 51  

                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
                                           ; SOURCE LINE # 440
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
                                           ; SOURCE LINE # 441
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_AdcFilter
;---- Variable 'R_AdFilTimes' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 443
                       CLR     C
                       MOV     A,R7
                       SUBB    A,#032H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJLT    ?C0049
                                           ; SOURCE LINE # 444
                                           ; SOURCE LINE # 445
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Zero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 446
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 447
                 R     MOV     DPTR,#B_Weight_ZeroOk
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 448
                                           ; SOURCE LINE # 449
                 R     xJMP    ?C0049
             ?C0050:
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 52  

                                           ; SOURCE LINE # 451
                                           ; SOURCE LINE # 452
                 R     MOV     DPTR,#R_AD_Zero
                       MOV     A,#0FH
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#0A0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 453
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,#0FH
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#0A0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 454
                 R     MOV     DPTR,#B_Weight_ZeroOk
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 455
                                           ; SOURCE LINE # 457
             ?C0049:
                                           ; SOURCE LINE # 459
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       XRL     A,#07H
                 R     xJNZ    ?C0053
                                           ; SOURCE LINE # 460
                                           ; SOURCE LINE # 461
                 R     MOV     DPTR,#B_Weight_Zero
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 463
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_GetDeltaAD
                 R     MOV     DPTR,#B_Weight_Pos
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 464
                       MOV     R7,#07H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#R_Open_Weight
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 466
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       SETB    C
                       SUBB    A,#02CH
                       MOV     A,R6
                       SUBB    A,#01H
                 R     xJLT    ?C0055
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0054
             ?C0055:
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 53  

                                           ; SOURCE LINE # 467
                 R     MOV     DPTR,#B_Weight_Zero
                       MOV     A,#01H
                       MOVX    @DPTR,A
             ?C0054:
                                           ; SOURCE LINE # 469
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#0C8H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJLT    ?C0057
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0056
             ?C0057:
                                           ; SOURCE LINE # 470
                                           ; SOURCE LINE # 471
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_JudgeSteady
                       MOV     A,R7
                       XRL     A,#01H
                 R     xJNZ    ?C0056
                                           ; SOURCE LINE # 472
                                           ; SOURCE LINE # 474
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_JudgeSteady
                                           ; SOURCE LINE # 477
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_LockProc
                       MOV     A,R7
                 R     xJNZ    ?C0059
                                           ; SOURCE LINE # 478
                                           ; SOURCE LINE # 479
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       CLR     C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0060
                                           ; SOURCE LINE # 480
                                           ; SOURCE LINE # 481
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 54  

                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 482
                       SETB    C
                 R     MOV     DPTR,#R_Open_Weight+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_Open_Weight
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJLT    ?C0056
                                           ; SOURCE LINE # 483
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_Zero
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 484
                 R     xJMP    ?C0056
             ?C0060:
                                           ; SOURCE LINE # 486
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_Zero
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 487
                 R     xJMP    ?C0056
             ?C0059:
                                           ; SOURCE LINE # 490
                                           ; SOURCE LINE # 491
                 R     MOV     DPTR,#B_LockDownCheck
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0056
                                           ; SOURCE LINE # 492
                                           ; SOURCE LINE # 493
                 R     MOV     DPTR,#R_AD_Zero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 55  

                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0065
                                           ; SOURCE LINE # 494
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                 R     xJMP    ?C0066
             ?C0065:
                                           ; SOURCE LINE # 496
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_Zero+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Zero
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0066:
                                           ; SOURCE LINE # 501
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_Zero
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 502
                       SETB    C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0AH
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0067
                                           ; SOURCE LINE # 503
                                           ; SOURCE LINE # 505
                 R     MOV     DPTR,#B_WeightZeroErr
                       MOV     A,#01H
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 56  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 506
                 R     MOV     DPTR,#R_Display_Err
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 507
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_LockProc
                                           ; SOURCE LINE # 508
             ?C0067:
                                           ; SOURCE LINE # 509
                 R     MOV     DPTR,#B_LockDownCheck
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 512
                                           ; SOURCE LINE # 513
                                           ; SOURCE LINE # 515
                                           ; SOURCE LINE # 516
             ?C0056:
                                           ; SOURCE LINE # 517
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 518
             ?C0053:
                                           ; SOURCE LINE # 520
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     xJNZ    ?C0068
                                           ; SOURCE LINE # 521
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0068:
                                           ; SOURCE LINE # 522
                       MOV     A,R5
                 R     xJNE    A,#02H,?C0069
                                           ; SOURCE LINE # 523
                 R     MOV     DPTR,#B_Weight_ZeroOk
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
             ?C0069:
                                           ; SOURCE LINE # 524
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     xJNE    A,#01H,?C0070
                                           ; SOURCE LINE # 525
                 R     MOV     DPTR,#R_AD_Zero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 57  

                       RET     
             ?C0070:
                                           ; SOURCE LINE # 526
                       MOV     A,R5
                 R     xJNE    A,#03H,?C0071
                                           ; SOURCE LINE # 527
                 R     MOV     DPTR,#B_Weight_Zero
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
             ?C0071:
                                           ; SOURCE LINE # 528
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                 R     xJNE    A,#09H,?C0072
                                           ; SOURCE LINE # 529
                 R     MOV     DPTR,#B_WeightZeroErr
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
             ?C0072:
                                           ; SOURCE LINE # 531
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                                           ; SOURCE LINE # 532
             ?C0045:
                       RET     
             ; FUNCTION _CS_Scale_ZeroProc (END)

             ; FUNCTION _CS_Scale_LockProc (BEGIN)
                                           ; SOURCE LINE # 543
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 544
                                           ; SOURCE LINE # 547
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0073
                                           ; SOURCE LINE # 548
                                           ; SOURCE LINE # 549
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 550
                       MOV     R7,#00H
                       RET     
                                           ; SOURCE LINE # 551
             ?C0073:
                                           ; SOURCE LINE # 553
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0075
                                           ; SOURCE LINE # 554
                                           ; SOURCE LINE # 555
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 556
             ?C0075:
                                           ; SOURCE LINE # 557
                       MOV     A,R7
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 58  

                 R     xJNE    A,#03H,?C0076
                                           ; SOURCE LINE # 558
                                           ; SOURCE LINE # 559
                       CLR     A
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 560
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 561
             ?C0076:
                                           ; SOURCE LINE # 563
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_ZeroProc
                       MOV     A,R7
                       XRL     A,#01H
                       ORL     A,R6
                 R     xJNZ    ?C0077
                                           ; SOURCE LINE # 564
                                           ; SOURCE LINE # 565
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    A,@DPTR
                       ANL     A,#0FDH
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 567
                 R     xJNB    ACC.0,?C0079
                                           ; SOURCE LINE # 568
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_UnitWeight
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 569
                 R     xJMP    ?C0079
             ?C0077:
                                           ; SOURCE LINE # 571
                                           ; SOURCE LINE # 572
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     xJNB    ACC.1,?C0080
                                           ; SOURCE LINE # 573
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_UnitWeight
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 59  

                 R     xJMP    ?C0079
             ?C0080:
                                           ; SOURCE LINE # 575
                       MOV     A,R7
                       ANL     A,#0FEH
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 576
             ?C0079:
                                           ; SOURCE LINE # 578
                       MOV     R7,#00H
                                           ; SOURCE LINE # 579
             ?C0074:
                       RET     
             ; FUNCTION _CS_Scale_LockProc (END)

             ; FUNCTION _CS_Scale_JudgeLowBat (BEGIN)
                                           ; SOURCE LINE # 622
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 623
                                           ; SOURCE LINE # 626
                                           ; SOURCE LINE # 627
                                           ; SOURCE LINE # 628
                                           ; SOURCE LINE # 629
                                           ; SOURCE LINE # 630
             ?C0082:
                                           ; SOURCE LINE # 632
                       CLR     A
                 R     MOV     DPTR,#B_Weight_LowBat
                       MOVX    @DPTR,A
             ?C0083:
                                           ; SOURCE LINE # 634
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0084
                                           ; SOURCE LINE # 635
                 R     MOV     DPTR,#B_Weight_LowBat
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0084:
                                           ; SOURCE LINE # 637
                       MOV     R7,#00H
                                           ; SOURCE LINE # 638
             ?C0085:
                       RET     
             ; FUNCTION _CS_Scale_JudgeLowBat (END)

             ; FUNCTION _CS_Scale_JudgeOverLoad (BEGIN)
                                           ; SOURCE LINE # 641
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 642
                                           ; SOURCE LINE # 646
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0086
                                           ; SOURCE LINE # 647
                                           ; SOURCE LINE # 648
                       CLR     A
                 R     MOV     DPTR,#R_Weight_OverLoadTimes
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 649
                       INC     DPTR
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 60  

                                           ; SOURCE LINE # 650
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 651
             ?C0086:
                                           ; SOURCE LINE # 653
                       SETB    C
                 R     MOV     DPTR,#R_UnitWeight+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0C4H
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       SUBB    A,#03BH
                 R     xJLT    ?C0088
                                           ; SOURCE LINE # 654
                 R     MOV     DPTR,#R_Weight_OverLoadTimes
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
             ?C0088:
                                           ; SOURCE LINE # 655
                 R     MOV     DPTR,#R_Weight_OverLoadTimes
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#02H
                 R     xJLT    ?C0089
                                           ; SOURCE LINE # 656
                                           ; SOURCE LINE # 657
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 658
                       INC     DPTR
                       DEC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 659
                 R     MOV     DPTR,#R_Display_Err
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 660
                 R     xJMP    ?C0090
             ?C0089:
                                           ; SOURCE LINE # 662
                       CLR     A
                 R     MOV     DPTR,#B_Weight_OverLoad
                       MOVX    @DPTR,A
             ?C0090:
                                           ; SOURCE LINE # 664
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0091
                                           ; SOURCE LINE # 665
                 R     MOV     DPTR,#B_Weight_OverLoad
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0091:
                                           ; SOURCE LINE # 667
                       MOV     R7,#00H
                                           ; SOURCE LINE # 668
             ?C0087:
                       RET     
             ; FUNCTION _CS_Scale_JudgeOverLoad (END)

C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 61  

             ; FUNCTION _CS_Scale_JudgeSteady (BEGIN)
                                           ; SOURCE LINE # 673
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 674
                                           ; SOURCE LINE # 682
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0092
                                           ; SOURCE LINE # 683
                                           ; SOURCE LINE # 684
                       CLR     A
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 685
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 686
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 687
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 688
             ?C0092:
                                           ; SOURCE LINE # 690
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0094
                                           ; SOURCE LINE # 691
                 R     MOV     DPTR,#B_Weight_SmallSteady
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0094:
                                           ; SOURCE LINE # 693
                       MOV     A,R7
                 R     xJNE    A,#03H,?C0095
                                           ; SOURCE LINE # 694
                 R     MOV     DPTR,#B_Weight_HeavySteady
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0095:
                                           ; SOURCE LINE # 696
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_LockProc
                       MOV     A,R7
                 R     xJNZ    ?C0096
                                           ; SOURCE LINE # 697
                                           ; SOURCE LINE # 699
                 R     MOV     DPTR,#R_Weight_kg_old
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 62  

                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0097
                                           ; SOURCE LINE # 700
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                 R     xJMP    ?C0098
             ?C0097:
                                           ; SOURCE LINE # 702
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_Weight_kg_old+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_kg_old
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0098:
                                           ; SOURCE LINE # 704
                       CLR     C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0AH
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0099
                                           ; SOURCE LINE # 705
                                           ; SOURCE LINE # 706
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FFH
                 R     xJGE    ?C0101
                                           ; SOURCE LINE # 707
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 708
                 R     xJMP    ?C0101
             ?C0099:
                                           ; SOURCE LINE # 710
                       CLR     A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 63  

                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    @DPTR,A
             ?C0101:
                                           ; SOURCE LINE # 713
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_kg_old
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 715
                       CLR     A
                 R     MOV     DPTR,#B_Weight_SmallSteady
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 716
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 718
                       CLR     C
                       MOV     A,R7
                       SUBB    A,#0FAH
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0102
                                           ; SOURCE LINE # 719
                                           ; SOURCE LINE # 720
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    A,@DPTR
                       SUBB    A,#028H
                 R     xJLT    ?C0096
                                           ; SOURCE LINE # 721
                       INC     DPTR
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 722
                 R     xJMP    ?C0096
             ?C0102:
                                           ; SOURCE LINE # 724
                                           ; SOURCE LINE # 725
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    A,@DPTR
                       SETB    C
                       SUBB    A,#028H
                 R     xJLT    ?C0096
                                           ; SOURCE LINE # 726
                                           ; SOURCE LINE # 727
                 R     MOV     DPTR,#B_Weight_HeavySteady
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 728
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 729
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 64  

                                           ; SOURCE LINE # 730
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_SteadyProc
                                           ; SOURCE LINE # 731
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 732
                                           ; SOURCE LINE # 733
                                           ; SOURCE LINE # 734
             ?C0096:
                                           ; SOURCE LINE # 735
                       MOV     R7,#00H
                                           ; SOURCE LINE # 736
             ?C0093:
                       RET     
             ; FUNCTION _CS_Scale_JudgeSteady (END)

             ; FUNCTION _CS_Scale_SteadyProc (BEGIN)
                                           ; SOURCE LINE # 745
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 746
                                           ; SOURCE LINE # 753
                       MOV     A,R7
                 R     xJNZ    ?C0106
                                           ; SOURCE LINE # 754
                                           ; SOURCE LINE # 755
                 R     MOV     DPTR,#B_Debug_Send
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 757
             ?C0106:
                                           ; SOURCE LINE # 759
                       MOV     R7,#03H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       XRL     A,#01H
                 R     xJNZ    ?C0107
                                           ; SOURCE LINE # 760
                                           ; SOURCE LINE # 761
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_JudgeSteady
                       MOV     A,R7
                       XRL     A,#01H
                 R     xJNZ    ?C0109
                                           ; SOURCE LINE # 762
                                           ; SOURCE LINE # 764
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_JudgeSteady
                                           ; SOURCE LINE # 766
                 R     MOV     DPTR,#R_Weight_Mem
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 65  

                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0110
                                           ; SOURCE LINE # 767
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                 R     MOV     DPTR,#R_Weight_Temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                 R     xJMP    ?C0111
             ?C0110:
                                           ; SOURCE LINE # 769
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_Weight_Mem+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_Mem
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     MOV     DPTR,#R_Weight_Temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0111:
                                           ; SOURCE LINE # 772
                       SETB    C
                 R     MOV     DPTR,#R_UnitWeight+01H
                       MOVX    A,@DPTR
                       SUBB    A,#058H
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       SUBB    A,#02H
                 R     xJLT    ?C0112
                                           ; SOURCE LINE # 773
                                           ; SOURCE LINE # 774
                 R     MOV     DPTR,#R_Weight_Temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,#019H
                 R     MOV     DPTR,#R_Weight_Temp
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0112
                                           ; SOURCE LINE # 775
                 R     MOV     DPTR,#R_Weight_Mem
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 66  

                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_UnitWeight
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 776
             ?C0112:
                                           ; SOURCE LINE # 778
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_Lock
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 779
                 R     MOV     DPTR,#R_Weight_Mem
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 780
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#08H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 781
                       CLR     A
                 R     MOV     DPTR,#ReadUTC
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 782
                       RET     
             ?C0109:
                                           ; SOURCE LINE # 784
                                           ; SOURCE LINE # 793
                 R     MOV     DPTR,#B_Debug_Send
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0115
                                           ; SOURCE LINE # 794
                                           ; SOURCE LINE # 796
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0116
                                           ; SOURCE LINE # 797
                                           ; SOURCE LINE # 798
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 799
                       CLR     A
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 800
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 67  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 801
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#082H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 802
             ?C0116:
                                           ; SOURCE LINE # 804
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    A,@DPTR
                       XRL     A,#01H
                 R     xJNZ    ?C0107
                                           ; SOURCE LINE # 805
                                           ; SOURCE LINE # 808
                 R     MOV     DPTR,#ReadUTC
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 809
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 811
                 R     MOV     DPTR,#R_1186_RTC
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 812
                 R     MOV     DPTR,#R_1186_RTC+01H
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 813
                 R     MOV     DPTR,#R_1186_RTC+02H
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 814
                 R     MOV     DPTR,#R_1186_RTC+03H
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+05H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 815
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       MOV     A,R4
                       MOV     R7,A
                       MOV     A,R2
                       MOV     R6,A
                       MOV     A,R7
                 R     MOV     DPTR,#SendData
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 816
                       MOV     R3,#01H
                 R     MOV     R2,#HIGH SendData
                 R     MOV     R1,#LOW SendData
                 E     CALL    _QueuePush
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 68  

                                           ; SOURCE LINE # 817
                 R     MOV     DPTR,#B_Debug_Send
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 818
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#080H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 821
                                           ; SOURCE LINE # 822
                       RET     
             ?C0115:
                                           ; SOURCE LINE # 824
                                           ; SOURCE LINE # 825
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_GetDeltaAD
;---- Variable 'R_AD_BUF' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 826
                       MOV     R5,AR7
                       MOV     R4,AR6
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 827
                 R     CALL    _CS_Scale_GetWeight
                                           ; SOURCE LINE # 828
                 R     CALL    CS_Scale_ReturnLock
                                           ; SOURCE LINE # 829
                                           ; SOURCE LINE # 830
                                           ; SOURCE LINE # 831
                                           ; SOURCE LINE # 849
             ?C0107:
                       RET     
             ; FUNCTION _CS_Scale_SteadyProc (END)

             ; FUNCTION CS_Scale_ReturnLock (BEGIN)
                                           ; SOURCE LINE # 853
                                           ; SOURCE LINE # 854
                                           ; SOURCE LINE # 857
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0119
                                           ; SOURCE LINE # 858
                                           ; SOURCE LINE # 859
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 69  

                       MOV     A,R4
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 860
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0123
                                           ; SOURCE LINE # 861
                                           ; SOURCE LINE # 862
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 863
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 864
                                           ; SOURCE LINE # 865
                       RET     
             ?C0119:
                                           ; SOURCE LINE # 867
                                           ; SOURCE LINE # 868
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_Weight_Lock+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 869
                       CLR     C
                       SUBB    A,#02CH
                       MOV     A,R6
                       SUBB    A,#01H
                 R     xJLT    ?C0123
                                           ; SOURCE LINE # 870
                                           ; SOURCE LINE # 872
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 873
                       MOV     R7,A
                 R     CALL    _CS_Scale_LockProc
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 70  

                                           ; SOURCE LINE # 874
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 876
                                           ; SOURCE LINE # 877
                                           ; SOURCE LINE # 879
             ?C0123:
                       RET     
             ; FUNCTION CS_Scale_ReturnLock (END)

             ; FUNCTION _CS_MemoryWeightClear_Timer (BEGIN)
                                           ; SOURCE LINE # 885
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 886
                                           ; SOURCE LINE # 890
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0124
                                           ; SOURCE LINE # 891
                                           ; SOURCE LINE # 892
                       CLR     A
                 R     MOV     DPTR,#timecount
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 893
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 894
             ?C0124:
                                           ; SOURCE LINE # 896
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0125
                                           ; SOURCE LINE # 897
                                           ; SOURCE LINE # 898
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FFH
                 R     xJGE    ?C0125
                                           ; SOURCE LINE # 899
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 900
             ?C0125:
                                           ; SOURCE LINE # 902
                 R     MOV     DPTR,#B_Timeout
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0129
                                           ; SOURCE LINE # 903
                                           ; SOURCE LINE # 904
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       SETB    C
                       SUBB    A,#096H
                 R     xJLT    ?C0129
                                           ; SOURCE LINE # 905
                                           ; SOURCE LINE # 906
                       INC     DPTR
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 907
                       CLR     A
                 R     MOV     DPTR,#R_Weight_Mem
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 71  

                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 908
                                           ; SOURCE LINE # 909
                                           ; SOURCE LINE # 910
             ?C0129:
                       RET     
             ; FUNCTION _CS_MemoryWeightClear_Timer (END)

             ; FUNCTION _CS_Scale_CaliProc (BEGIN)
                                           ; SOURCE LINE # 926
;---- Variable 'option' assigned to Register 'R5' ----
                       MOV     R5,AR7
                                           ; SOURCE LINE # 927
                                           ; SOURCE LINE # 939
                       MOV     A,R5
                 R     xJNE    A,#05H,?C0130
                                           ; SOURCE LINE # 940
                                           ; SOURCE LINE # 941
                       CLR     A
                 R     MOV     DPTR,#R_CaliState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 942
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 943
             ?C0130:
                                           ; SOURCE LINE # 944
                       MOV     A,R5
                       XRL     A,#01H
                 R     xJNZ    ?C0132
                                           ; SOURCE LINE # 945
                                           ; SOURCE LINE # 974
                       MOV     DPTR,#04C08H
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       CLR     A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 975
                       MOVX    A,@DPTR
                       MOV     R6,A
                       MOV     DPTR,#04C09H
                       MOVX    A,@DPTR
                       MOV     R3,A
                       MOV     A,R6
                       MOV     A,R3
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 976
                       MOV     DPTR,#04C0AH
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 72  

                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       CLR     A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 977
                       MOVX    A,@DPTR
                       MOV     R6,A
                       MOV     DPTR,#04C0BH
                       MOVX    A,@DPTR
                       MOV     R3,A
                       MOV     A,R6
                       MOV     A,R3
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 978
                       MOV     DPTR,#04C0CH
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       CLR     A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 979
                       MOVX    A,@DPTR
                       MOV     R6,A
                       MOV     DPTR,#04C0DH
                       MOVX    A,@DPTR
                       MOV     R3,A
                       MOV     A,R6
                       MOV     A,R3
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 983
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0134
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#070H
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 73  

                       MOV     A,R6
                       SUBB    A,#017H
                 R     xJLT    ?C0133
             ?C0134:
                                           ; SOURCE LINE # 984
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0136
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#070H
                       MOV     A,R6
                       SUBB    A,#017H
                 R     xJLT    ?C0133
             ?C0136:
                                           ; SOURCE LINE # 985
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0138
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#070H
                       MOV     A,R6
                       SUBB    A,#017H
                 R     xJLT    ?C0133
             ?C0138:
                                           ; SOURCE LINE # 986
                                           ; SOURCE LINE # 987
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOV     A,#017H
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#070H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 988
                       INC     DPTR
                       MOV     A,#013H
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#088H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 989
                       INC     DPTR
                       MOV     A,#0FH
                       MOVX    @DPTR,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 74  

                       MOV     A,#0A0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 990
             ?C0133:
                                           ; SOURCE LINE # 993
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#00H
                       MOV     R5,#0AH
                 E     CALL    ?C?UIDIV
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 994
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 995
             ?C0132:
                                           ; SOURCE LINE # 996
                       MOV     A,R5
                 R     xJNE    A,#06H,?C0139
                                           ; SOURCE LINE # 997
                                           ; SOURCE LINE # 998
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#00H
                       MOV     R5,#0AH
                 E     CALL    ?C?UIDIV
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 999
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 1000
             ?C0139:
                                           ; SOURCE LINE # 1002
                       MOV     A,R5
                 R     xJNE    A,#07H,?C0140
                                           ; SOURCE LINE # 1003
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 75  

                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0140:
                                           ; SOURCE LINE # 1004
                       MOV     A,R5
                 R     xJNE    A,#02H,?C0141
                                           ; SOURCE LINE # 1005
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0141:
                                           ; SOURCE LINE # 1006
                       MOV     A,R5
                 R     xJNE    A,#03H,?C0142
                                           ; SOURCE LINE # 1007
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0142:
                                           ; SOURCE LINE # 1008
                       MOV     A,R5
                 R     xJNE    A,#04H,?C0143
                                           ; SOURCE LINE # 1009
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0143:
                                           ; SOURCE LINE # 1011
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
                                           ; SOURCE LINE # 1012
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 76  

                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
                                           ; SOURCE LINE # 1013
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_AdcFilter
                 R     MOV     DPTR,#R_AdFilTimes
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1019
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0144
                                           ; SOURCE LINE # 1020
                                           ; SOURCE LINE # 1022
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1023
                       CLR     C
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#03CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0145
                                           ; SOURCE LINE # 1024
                                           ; SOURCE LINE # 1025
                       MOV     R7,#05H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 1026
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1027
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1028
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1029
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 77  

             ?C0145:
                                           ; SOURCE LINE # 1030
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1031
             ?C0144:
                                           ; SOURCE LINE # 1033
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0146
                                           ; SOURCE LINE # 1034
                                           ; SOURCE LINE # 1035
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0147
                                           ; SOURCE LINE # 1036
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#02H
                       MOVX    @DPTR,A
             ?C0147:
                                           ; SOURCE LINE # 1037
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#081H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1038
             ?C0146:
                                           ; SOURCE LINE # 1040
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#02H
                 R     xJNZ    ?C0148
                                           ; SOURCE LINE # 1041
                                           ; SOURCE LINE # 1042
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1043
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 78  

                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1045
                       SETB    C
                 R     MOV     DPTR,#R_OpenWeight_Ad+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0150
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0149
             ?C0150:
                                           ; SOURCE LINE # 1046
                                           ; SOURCE LINE # 1047
                       CLR     C
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#03CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0151
                                           ; SOURCE LINE # 1048
                                           ; SOURCE LINE # 1049
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#05H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 1050
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1051
             ?C0151:
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 79  

                                           ; SOURCE LINE # 1052
                       CLR     A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1053
                 R     xJMP    ?C0152
             ?C0149:
                                           ; SOURCE LINE # 1055
                                           ; SOURCE LINE # 1056
                       SETB    C
                 R     MOV     DPTR,#R_AD_CaliDot1+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0EEH
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       SUBB    A,#02H
                 R     xJLT    ?C0152
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#03CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0152
                                           ; SOURCE LINE # 1057
                                           ; SOURCE LINE # 1058
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1059
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1060
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1061
                                           ; SOURCE LINE # 1062
             ?C0152:
                                           ; SOURCE LINE # 1063
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1065
             ?C0148:
                                           ; SOURCE LINE # 1067
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#03H,?C0154
                                           ; SOURCE LINE # 1068
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 80  

                                           ; SOURCE LINE # 1069
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0155
                                           ; SOURCE LINE # 1070
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#04H
                       MOVX    @DPTR,A
             ?C0155:
                                           ; SOURCE LINE # 1071
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#082H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1072
             ?C0154:
                                           ; SOURCE LINE # 1074
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#04H
                 R     xJNZ    ?C0156
                                           ; SOURCE LINE # 1075
                                           ; SOURCE LINE # 1076
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1077
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1079
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 81  

                       SUBB    A,R6
                 R     xJGE    ?C0158
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0157
             ?C0158:
                                           ; SOURCE LINE # 1080
                                           ; SOURCE LINE # 1081
                       CLR     A
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1082
                 R     xJMP    ?C0159
             ?C0157:
                                           ; SOURCE LINE # 1084
                                           ; SOURCE LINE # 1085
                       CLR     C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,R5
                       MOV     R7,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,R4
                       MOV     R6,A
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1087
                       SETB    C
                       SUBB    A,#0EEH
                       MOV     A,R6
                       SUBB    A,#02H
                 R     xJLT    ?C0159
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#03CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0159
                                           ; SOURCE LINE # 1088
                                           ; SOURCE LINE # 1089
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 82  

                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1090
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1091
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#05H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1092
                                           ; SOURCE LINE # 1093
             ?C0159:
                                           ; SOURCE LINE # 1094
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1095
             ?C0156:
                                           ; SOURCE LINE # 1097
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#05H,?C0161
                                           ; SOURCE LINE # 1098
                                           ; SOURCE LINE # 1099
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0162
                                           ; SOURCE LINE # 1100
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#06H
                       MOVX    @DPTR,A
             ?C0162:
                                           ; SOURCE LINE # 1101
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#083H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1102
             ?C0161:
                                           ; SOURCE LINE # 1104
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#06H
                 R     xJNZ    ?C0163
                                           ; SOURCE LINE # 1105
                                           ; SOURCE LINE # 1106
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 83  

                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1107
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1109
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJGE    ?C0165
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0164
             ?C0165:
                                           ; SOURCE LINE # 1110
                                           ; SOURCE LINE # 1111
                       CLR     A
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1112
                 R     xJMP    ?C0166
             ?C0164:
                                           ; SOURCE LINE # 1114
                                           ; SOURCE LINE # 1115
                       CLR     C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 84  

                       SUBB    A,R5
                       MOV     R7,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,R4
                       MOV     R6,A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1117
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0167
                                           ; SOURCE LINE # 1118
                                           ; SOURCE LINE # 1119
                       CLR     A
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1121
                 R     xJMP    ?C0166
             ?C0167:
                                           ; SOURCE LINE # 1123
                                           ; SOURCE LINE # 1124
                       CLR     C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,R5
                       MOV     R7,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,R4
                       MOV     R6,A
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1126
                       SETB    C
                       SUBB    A,#0EEH
                       MOV     A,R6
                       SUBB    A,#02H
                 R     xJLT    ?C0166
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#03CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0166
                                           ; SOURCE LINE # 1127
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 85  

                                           ; SOURCE LINE # 1128
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1129
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#07H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1130
                                           ; SOURCE LINE # 1131
                                           ; SOURCE LINE # 1132
             ?C0166:
                                           ; SOURCE LINE # 1133
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1134
             ?C0163:
                                           ; SOURCE LINE # 1136
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#07H,?C0170
                                           ; SOURCE LINE # 1137
                                           ; SOURCE LINE # 1138
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0171
                                           ; SOURCE LINE # 1139
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#08H
                       MOVX    @DPTR,A
             ?C0171:
                                           ; SOURCE LINE # 1140
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#084H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1141
             ?C0170:
                                           ; SOURCE LINE # 1143
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#08H
                 R     xJNZ    ?C0172
                                           ; SOURCE LINE # 1144
                                           ; SOURCE LINE # 1146
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 86  

                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1147
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 1148
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1149
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R4,#00H
                       MOV     R5,#0AH
                       MOV     R7,A
                       MOV     R6,AR2
                 E     CALL    ?C?UIDIV
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1157
                       MOV     A,R2
                       MOV     DPTR,#04C08H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1158
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     DPTR,#04C09H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1159
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     A,R4
                       MOV     DPTR,#04C0AH
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1160
                       MOV     A,R5
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1161
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 87  

                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     A,R4
                       MOV     DPTR,#04C0CH
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1162
                       MOV     A,R5
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1163
                       MOV     R7,#041H
                 E     CALL    _SpiFlashOperator
                                           ; SOURCE LINE # 1167
             ?C0172:
                                           ; SOURCE LINE # 1168
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                                           ; SOURCE LINE # 1170
             ?C0131:
                       RET     
             ; FUNCTION _CS_Scale_CaliProc (END)

             ; FUNCTION _CS_Scale_StandbyProc (BEGIN)
                                           ; SOURCE LINE # 1182
;---- Variable 'B_Reset' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1183
                                           ; SOURCE LINE # 1187
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0173
                                           ; SOURCE LINE # 1188
                                           ; SOURCE LINE # 1189
                       CLR     A
                 R     MOV     DPTR,#StandbyState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1190
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 1192
             ?C0173:
                                           ; SOURCE LINE # 1194
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0175
                                           ; SOURCE LINE # 1195
                                           ; SOURCE LINE # 1196
                 R     MOV     DPTR,#StandbyState
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1197
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 1199
             ?C0175:
                                           ; SOURCE LINE # 1201
                 R     MOV     DPTR,#StandbyState
                       MOVX    A,@DPTR
                       DEC     A
                 R     xJZ     ?C0180
                       INC     A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 88  

                 R     xJNZ    ?C0183
                                           ; SOURCE LINE # 1202
                                           ; SOURCE LINE # 1203
             ?C0177:
                                           ; SOURCE LINE # 1204
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0178
                                           ; SOURCE LINE # 1205
                                           ; SOURCE LINE # 1206
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1207
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#0A0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1208
                       CLR     A
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1209
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1211
             ?C0178:
                                           ; SOURCE LINE # 1212
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    A,@DPTR
                       XRL     A,#01H
                 R     xJNZ    ?C0174
                                           ; SOURCE LINE # 1213
                                           ; SOURCE LINE # 1214
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1215
                       INC     DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1217
                 E     MOV     DPTR,#btCmdBuf
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1218
                       INC     DPTR
                       MOV     A,#020H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1219
                       MOV     R3,#01H
                 E     MOV     R2,#HIGH btCmdBuf
                 E     MOV     R1,#LOW btCmdBuf
                 E     CALL    _BT_CmdFifoIn
                                           ; SOURCE LINE # 1227
                 E     MOV     DPTR,#sys_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1229
                                           ; SOURCE LINE # 1230
                       RET     
                                           ; SOURCE LINE # 1231
             ?C0180:
                                           ; SOURCE LINE # 1232
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 89  

                 R     xJNZ    ?C0181
                                           ; SOURCE LINE # 1233
                                           ; SOURCE LINE # 1234
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1235
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#085H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1236
                       CLR     A
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1237
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1238
             ?C0181:
                                           ; SOURCE LINE # 1239
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0174
                                           ; SOURCE LINE # 1240
                                           ; SOURCE LINE # 1241
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1242
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1243
                 E     MOV     DPTR,#sys_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1253
                       MOV     R7,A
                 R     CALL    _CS_Scale_JudgeOverLoad
                                           ; SOURCE LINE # 1254
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 1255
                       CLR     A
                 R     MOV     DPTR,#R_Display_Err
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1257
                 R     MOV     DPTR,#R_Scale_state
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1258
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#080H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1259
                                           ; SOURCE LINE # 1260
                       RET     
                                           ; SOURCE LINE # 1261
             ?C0183:
                                           ; SOURCE LINE # 1262
                       CLR     A
                 R     MOV     DPTR,#StandbyState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1263
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 90  

                                           ; SOURCE LINE # 1264
                                           ; SOURCE LINE # 1268
             ?C0174:
                       RET     
             ; FUNCTION _CS_Scale_StandbyProc (END)

             ; FUNCTION CS_Scale_PowerOnProc (BEGIN)
                                           ; SOURCE LINE # 1282
                                           ; SOURCE LINE # 1283
                                           ; SOURCE LINE # 1288
                 R     xJNB    B_Reset,?C0184
                                           ; SOURCE LINE # 1289
                                           ; SOURCE LINE # 1290
                       CLR     A
                 R     MOV     DPTR,#PowerOnState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1291
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 1293
             ?C0184:
                                           ; SOURCE LINE # 1296
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0186
                                           ; SOURCE LINE # 1297
                                           ; SOURCE LINE # 1298
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0187
                                           ; SOURCE LINE # 1299
                                           ; SOURCE LINE # 1300
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1301
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#0C5H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1302
                 R     xJMP    ?C0186
             ?C0187:
                                           ; SOURCE LINE # 1304
                                           ; SOURCE LINE # 1305
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1306
                       INC     DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1307
                                           ; SOURCE LINE # 1308
             ?C0186:
                                           ; SOURCE LINE # 1310
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0189
                                           ; SOURCE LINE # 1311
                                           ; SOURCE LINE # 1312
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 91  

                 R     xJNZ    ?C0190
                                           ; SOURCE LINE # 1313
                                           ; SOURCE LINE # 1314
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1315
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#084H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1316
                       CLR     A
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1317
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1318
             ?C0190:
                                           ; SOURCE LINE # 1319
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0189
                                           ; SOURCE LINE # 1320
                                           ; SOURCE LINE # 1321
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1322
                       INC     DPTR
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1323
                                           ; SOURCE LINE # 1324
             ?C0189:
                                           ; SOURCE LINE # 1326
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#02H,?C0192
                                           ; SOURCE LINE # 1327
                                           ; SOURCE LINE # 1328
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1329
             ?C0192:
                                           ; SOURCE LINE # 1331
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#03H,?C0193
                                           ; SOURCE LINE # 1332
                                           ; SOURCE LINE # 1333
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0194
                                           ; SOURCE LINE # 1334
                                           ; SOURCE LINE # 1335
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1336
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#082H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1337
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 92  

                       CLR     A
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1338
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1339
             ?C0194:
                                           ; SOURCE LINE # 1340
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0193
                                           ; SOURCE LINE # 1341
                                           ; SOURCE LINE # 1342
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1343
                       INC     DPTR
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1344
                                           ; SOURCE LINE # 1345
             ?C0193:
                                           ; SOURCE LINE # 1347
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#04H,?C0196
                                           ; SOURCE LINE # 1348
                                           ; SOURCE LINE # 1349
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0197
                                           ; SOURCE LINE # 1350
                                           ; SOURCE LINE # 1351
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1352
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#0A1H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1353
                       CLR     A
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1354
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1355
             ?C0197:
                                           ; SOURCE LINE # 1356
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0196
                                           ; SOURCE LINE # 1357
                                           ; SOURCE LINE # 1358
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1359
                       INC     DPTR
                       MOV     A,#05H
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 93  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1360
                                           ; SOURCE LINE # 1361
             ?C0196:
                                           ; SOURCE LINE # 1363
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                       XRL     A,#05H
                 R     xJNZ    ?C0199
                                           ; SOURCE LINE # 1364
                                           ; SOURCE LINE # 1365
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0200
                                           ; SOURCE LINE # 1366
                                           ; SOURCE LINE # 1367
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1368
                       MOV     R5,#0B8H
                       MOV     R4,#022H
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1369
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#0E0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1370
                       CLR     A
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1371
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1373
             ?C0200:
                                           ; SOURCE LINE # 1374
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0199
                                           ; SOURCE LINE # 1375
                                           ; SOURCE LINE # 1376
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1377
                 E     MOV     DPTR,#R_Weight_Com_Coo+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1378
                 R     MOV     DPTR,#PowerOnState
                       MOV     A,#06H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1379
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1380
                                           ; SOURCE LINE # 1381
             ?C0199:
                                           ; SOURCE LINE # 1383
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#06H,?C0185
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 94  

                                           ; SOURCE LINE # 1384
                                           ; SOURCE LINE # 1385
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0185
                                           ; SOURCE LINE # 1386
                                           ; SOURCE LINE # 1387
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1388
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOV     A,#080H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1389
                                           ; SOURCE LINE # 1390
                                           ; SOURCE LINE # 1392
             ?C0185:
                       RET     
             ; FUNCTION CS_Scale_PowerOnProc (END)

             ; FUNCTION _CS_SoftTimer (BEGIN)
                                           ; SOURCE LINE # 1397
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1398
                                           ; SOURCE LINE # 1402
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0204
                                           ; SOURCE LINE # 1403
                                           ; SOURCE LINE # 1404
                       CLR     A
                 R     MOV     DPTR,#timecount
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1405
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1406
             ?C0204:
                                           ; SOURCE LINE # 1408
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0205
                                           ; SOURCE LINE # 1409
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0205:
                                           ; SOURCE LINE # 1411
                       MOV     A,R7
                 R     xJNZ    ?C0207
                                           ; SOURCE LINE # 1412
                                           ; SOURCE LINE # 1413
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FFH
                 R     xJGE    ?C0207
                                           ; SOURCE LINE # 1414
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 95  

                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1415
             ?C0207:
                                           ; SOURCE LINE # 1418
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       SETB    C
                       SUBB    A,#096H
                 R     xJLT    ?C0209
                                           ; SOURCE LINE # 1419
                       INC     DPTR
                       MOV     A,#01H
                       MOVX    @DPTR,A
             ?C0209:
                                           ; SOURCE LINE # 1421
                       MOV     A,R7
                 R     xJNE    A,#03H,?C0210
                                           ; SOURCE LINE # 1422
                 R     MOV     DPTR,#B_Timeout
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0210:
                                           ; SOURCE LINE # 1424
                       MOV     R7,#00H
                                           ; SOURCE LINE # 1426
             ?C0206:
                       RET     
             ; FUNCTION _CS_SoftTimer (END)

             ; FUNCTION _CS_Scale_TimeOutProc (BEGIN)
                                           ; SOURCE LINE # 1445
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1446
                                           ; SOURCE LINE # 1450
                       MOV     A,R7
                 R     xJNE    A,#07H,?C0211
                                           ; SOURCE LINE # 1451
                                           ; SOURCE LINE # 1452
                 R     MOV     DPTR,#B_TimeBase_1s
                       MOV     A,#01H
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 1454
             ?C0211:
                                           ; SOURCE LINE # 1456
                       MOV     A,R7
                 R     xJZ     ?C0213
                                           ; SOURCE LINE # 1457
                                           ; SOURCE LINE # 1458
                 R     xJNE    A,#01H,?C0214
                                           ; SOURCE LINE # 1459
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
             ?C0214:
                                           ; SOURCE LINE # 1460
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0215
                                           ; SOURCE LINE # 1461
                       CLR     A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 96  

                 R     MOV     DPTR,#R_TimeOut+01H
                       MOVX    @DPTR,A
             ?C0215:
                                           ; SOURCE LINE # 1462
                       MOV     A,R7
                 R     xJNE    A,#03H,?C0216
                                           ; SOURCE LINE # 1463
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
             ?C0216:
                                           ; SOURCE LINE # 1464
                       MOV     A,R7
                 R     xJNE    A,#04H,?C0217
                                           ; SOURCE LINE # 1465
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+03H
                       MOVX    @DPTR,A
             ?C0217:
                                           ; SOURCE LINE # 1466
                       MOV     A,R7
                 R     xJNE    A,#05H,?C0218
                                           ; SOURCE LINE # 1467
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+04H
                       MOVX    @DPTR,A
             ?C0218:
                                           ; SOURCE LINE # 1468
                       MOV     A,R7
                       XRL     A,#06H
                 R     xJNZ    ?C0212
                                           ; SOURCE LINE # 1469
                                           ; SOURCE LINE # 1470
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1471
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1472
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1473
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1474
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1475
                       RET     
                                           ; SOURCE LINE # 1477
             ?C0213:
                                           ; SOURCE LINE # 1479
                 R     MOV     DPTR,#B_TimeBase_1s
                       MOVX    A,@DPTR
                       XRL     A,#01H
                 R     xJNZ    ?C0212
                                           ; SOURCE LINE # 1480
                                           ; SOURCE LINE # 1481
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1484
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_JudgeLowBat
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 97  

                 R     xJNE    R7,#01H,?C0221
                                           ; SOURCE LINE # 1485
                                           ; SOURCE LINE # 1486
                 R     MOV     DPTR,#R_TimeOut+04H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1488
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#03H
                 R     xJLT    ?C0212
                                           ; SOURCE LINE # 1489
                                           ; SOURCE LINE # 1490
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1491
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1492
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1493
                       RET     
                                           ; SOURCE LINE # 1495
             ?C0221:
                                           ; SOURCE LINE # 1498
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_JudgeOverLoad
                 R     xJNE    R7,#01H,?C0223
                                           ; SOURCE LINE # 1499
                                           ; SOURCE LINE # 1500
                 R     MOV     DPTR,#R_TimeOut+03H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1502
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#03H
                 R     xJLT    ?C0212
                                           ; SOURCE LINE # 1503
                                           ; SOURCE LINE # 1504
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1505
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1506
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1507
                       RET     
                                           ; SOURCE LINE # 1510
             ?C0223:
                                           ; SOURCE LINE # 1514
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 98  

                       XRL     A,#01H
                 R     xJNZ    ?C0225
                                           ; SOURCE LINE # 1515
                                           ; SOURCE LINE # 1517
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_ZeroProc
                       MOV     A,R7
                       ORL     A,R6
                 R     xJZ     ?C0226
                                           ; SOURCE LINE # 1518
                                           ; SOURCE LINE # 1519
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1520
                 R     xJMP    ?C0227
             ?C0226:
                                           ; SOURCE LINE # 1522
                                           ; SOURCE LINE # 1526
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1527
             ?C0227:
                                           ; SOURCE LINE # 1529
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_JudgeSteady
                 R     xJNE    R7,#01H,?C0228
                                           ; SOURCE LINE # 1530
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
                 R     xJMP    ?C0229
             ?C0228:
                                           ; SOURCE LINE # 1532
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
             ?C0229:
                                           ; SOURCE LINE # 1535
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FH
                 R     xJGE    ?C0231
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FH
                 R     xJLT    ?C0212
             ?C0231:
                                           ; SOURCE LINE # 1536
                                           ; SOURCE LINE # 1537
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1538
                       MOV     R7,#01H
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 99  

                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1539
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1540
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1541
                       RET     
                                           ; SOURCE LINE # 1544
             ?C0225:
                                           ; SOURCE LINE # 1548
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#04H,?C0212
                                           ; SOURCE LINE # 1549
                                           ; SOURCE LINE # 1550
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1551
                 R     MOV     DPTR,#R_TimeOut+01H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1553
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FH
                 R     xJLT    ?C0212
                                           ; SOURCE LINE # 1554
                                           ; SOURCE LINE # 1555
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1556
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1557
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1558
                                           ; SOURCE LINE # 1560
                                           ; SOURCE LINE # 1563
                                           ; SOURCE LINE # 1565
             ?C0212:
                       RET     
             ; FUNCTION _CS_Scale_TimeOutProc (END)

C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 100 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


s8_t . . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
_CS_Scale_JudgeLowBat. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  B_Weight_LowBat. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001FH  1
u8_t . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
UART_CardProtcol . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
YC_UARTPARAM_t . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  15
  uartCtrl . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  pRxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0001H  3
  pTxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0004H  3
  rxBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0007H  2
  txBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0009H  2
  baud . . . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   000BH  4
pxdbyte. . . . . . . . . . . . . . . .  TYPEDEF  DATA   PTR      -----  2
YC_LedBlink. . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  6
  active_state . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  gpio_num . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  light_time . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  dark_time. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
R_Weight_Lock. . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    0040H  2
btCmdBuf . . . . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  25
pdbyte . . . . . . . . . . . . . . . .  TYPEDEF  -----  PTR      -----  1
B_Debug_Test . . . . . . . . . . . . .  PUBLIC   DATA   BIT      0000H  1
CS_Scale_PowerOn . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
UART_HalfDuplex. . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CS_Weight_T. . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  10
  origin . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  kg . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  lb . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
  st . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0006H  2
  jin. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0008H  2
R_Display_Err. . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0042H  1
DFIFO0 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0094H  1
_CS_SoftTimer. . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  timecount. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0038H  1
  B_Timeout. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0039H  1
DFIFO1 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0095H  1
UART_Parity. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
dbyte. . . . . . . . . . . . . . . . .  TYPEDEF  DATA   U_CHAR   -----  1
DFIFO2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0096H  1
CS_ComState. . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  4
  now. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  pre. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  sucess . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  fail . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
R_Weight_Mem . . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    0043H  2
pxbyte . . . . . . . . . . . . . . . .  TYPEDEF  -----  PTR      -----  2
ibyte. . . . . . . . . . . . . . . . .  TYPEDEF  IDATA  U_CHAR   -----  1
BT_EVENTFIFO . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
YC_UtilTimer . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  61
  timer_flages . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  callback . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
  timer_end. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0019H  32
  last_timer . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0039H  4
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 101 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


R_Weight_Com_Coo . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  4
R_Scale_state. . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0045H  1
_CS_Scale_JudgeSteady. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  weight_temp. . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  R_Weight_kg_old. . . . . . . . . . .  STATIC   XDATA  U_INT    0022H  2
  R_Weight_SameTimes . . . . . . . . .  STATIC   XDATA  U_CHAR   0024H  1
  B_Weight_SmallSteady . . . . . . . .  STATIC   XDATA  U_CHAR   0025H  1
  B_Weight_HeavySteady . . . . . . . .  STATIC   XDATA  U_CHAR   0026H  1
_CS_Scale_TimeOutProc. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  R_TimeOut. . . . . . . . . . . . . .  STATIC   XDATA  STRUCT   003AH  5
  B_TimeBase_1s. . . . . . . . . . . .  STATIC   XDATA  U_CHAR   003FH  1
CS_Scale_PowerOnProc . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  B_Reset. . . . . . . . . . . . . . .  AUTO     DATA   BIT      0000H  1
  comm_doing . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0036H  1
  PowerOnState . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0037H  1
_QueuePush . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
s32_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
YC_UARTPARAM . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  15
  uartCtrl . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  pRxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0001H  3
  pTxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0004H  3
  rxBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0007H  2
  txBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0009H  2
  baud . . . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   000BH  4
bool . . . . . . . . . . . . . . . . .  TYPEDEF  DATA   BIT      -----  1
CS_Scale_ChangeUnit. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
u32_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
s16_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
xbyte. . . . . . . . . . . . . . . . .  TYPEDEF  XDATA  U_CHAR   -----  1
_CS_MemoryWeightClear_Timer. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  timecount. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0029H  1
  B_Timeout. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   002AH  1
u16_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
dint . . . . . . . . . . . . . . . . .  TYPEDEF  DATA   U_INT    -----  2
_CS_Scale_StandbyProc. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  B_Reset. . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  comm_doing . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0034H  1
  StandbyState . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0035H  1
R_Selet_Unit . . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0046H  1
R_Debug_temp . . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    0047H  2
_CS_Scale_AdcFilter. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0001H  2
  ad_temp. . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0003H  4
  R_AD_FilTimes. . . . . . . . . . . .  STATIC   XDATA  U_INT    0001H  2
  R_AD_BUF_OLD . . . . . . . . . . . .  STATIC   XDATA  U_INT    0003H  2
  R_AD_F1. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0005H  2
  R_AD_F2. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0007H  2
  R_AD_F3. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0009H  2
  R_AD_F4. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    000BH  2
  R_AD_F5. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    000DH  2
  R_AD_F6. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    000FH  2
  R_AD_F7. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0011H  2
  R_AD_F8. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0013H  2
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 102 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


byte . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
DeviceInfo_t . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  10
  registerFlag . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bindFlag . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  loginFlag. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  userNum. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  deviceID . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0004H  6
_CS_ScaleDisplay_FreshBuf. . . . . . .  EXTERN   CODE   PROC     -----  -----
YC_UartCTRLBit_e . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
UART_DataLen . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CS_ScaleDisplay. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
R_UnitWeight . . . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0049H  10
uint . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
CS_Scale_WeightProc. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  R_AD_BUF . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
BT_CMDFIFO_t . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
_CS_Scale_SteadyProc . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  R_AD_BUF . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
  R_Weight_Temp. . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  B_Debug_Send . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0027H  1
  ReadUTC. . . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0028H  1
  SendData . . . . . . . . . . . . . .  AUTO     XDATA  STRUCT   0002H  6
UART_BaudSet . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_BT_CmdFifoIn. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
R_1186_RTC . . . . . . . . . . . . . .  PUBLIC   XDATA  ARRAY    0053H  4
B_Weight_AdOk. . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0057H  1
_CS_Scale_GetWeight. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  ad_temp. . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0002H  4
  ad_cal . . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0006H  2
  CaliDot1 . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0008H  2
  CaliDot2 . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    000AH  2
  CaliDot3 . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    000CH  2
CS_Scale_ReturnLock. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  weight_temp. . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
R_AD_Original. . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    0058H  2
_CS_Scale_CaliProc . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
  R_AD_CaliDot1. . . . . . . . . . . .  STATIC   XDATA  U_INT    002BH  2
  R_AD_CaliDot2. . . . . . . . . . . .  STATIC   XDATA  U_INT    002DH  2
  R_AD_CaliDot3. . . . . . . . . . . .  STATIC   XDATA  U_INT    002FH  2
  R_CaliState. . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0031H  1
  R_OpenWeight_Ad. . . . . . . . . . .  STATIC   XDATA  U_INT    0032H  2
  R_AdFilTimes . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  weight_temp. . . . . . . . . . . . .  AUTO     XDATA  U_INT    0002H  2
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0004H  2
  R_AD_PowerOnZero . . . . . . . . . .  AUTO     XDATA  U_INT    0006H  2
_CS_TimeOut_T. . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  5
  zero . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  lock . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  unstable . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  overload . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  lowbat . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
_CS_Scale_JudgeOverLoad. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 103 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  R_Weight_OverLoadTimes . . . . . . .  STATIC   XDATA  U_CHAR   0020H  1
  B_Weight_OverLoad. . . . . . . . . .  STATIC   XDATA  U_CHAR   0021H  1
_CS_Scale_GetDeltaAD . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  B_Weight_Pos . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0000H  1
  ad_temp. . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0001H  2
  R_AD_Zero. . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
CS_Scale_Proc. . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
YC_LedBlink_t. . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  6
  active_state . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  gpio_num . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  light_time . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  dark_time. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
_CS_Scale_LockProc . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  B_Weight_Downing_Lock. . . . . . . .  STATIC   XDATA  U_CHAR   001EH  1
sys_state. . . . . . . . . . . . . . .  EXTERN   XDATA  U_CHAR   -----  1
p_TimerCallback. . . . . . . . . . . .  TYPEDEF  -----  PTR      -----  3
UART_Enable. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
R_1186sys_state. . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   005AH  1
HistoryList_t. . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  63
  head . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  tail . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  size . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  measureData. . . . . . . . . . . . .  MEMBER   -----  ARRAY    0003H  60
UART_EnableFlowControl . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_SpiFlashOperator. . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
BT_CMDFIFO . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
YC_UartCTRLBit . . . . . . . . . . . .  * TAG *  -----  ENUM     -----  -----
UserMeasureData. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  6
  weight . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  UTCTime. . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0002H  4
BT_EVENTFIFO_t . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
CS_TimeOut_T . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  5
  zero . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  lock . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  unstable . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  overload . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  lowbat . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
YC_UtilTimer_t . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  61
  timer_flages . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  callback . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
  timer_end. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0019H  32
  last_timer . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0039H  4
_CS_Weight_T . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  10
  origin . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  kg . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  lb . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
  st . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0006H  2
  jin. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0008H  2
_CS_ComState . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  4
  now. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
C51 COMPILER V9.01   CS_SCALE_PROC                                                         03/23/2017 21:06:41 PAGE 104 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  pre. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  sucess . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  fail . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
_CS_Scale_ZeroProc . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  setdata. . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0004H  2
  R_Weight_GetZeroTimeOut. . . . . . .  STATIC   XDATA  U_CHAR   0015H  1
  R_AD_PowerOnZero . . . . . . . . . .  STATIC   XDATA  U_INT    0016H  2
  R_AD_Zero. . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0018H  2
  B_Weight_Zero. . . . . . . . . . . .  STATIC   XDATA  U_CHAR   001AH  1
  B_Weight_ZeroOk. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001BH  1
  B_LockDownCheck. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001CH  1
  B_WeightZeroErr. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001DH  1
  R_AdFilTimes . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0001H  2
  weight_temp. . . . . . . . . . . . .  AUTO     XDATA  U_INT    0003H  2
  R_Open_Weight. . . . . . . . . . . .  AUTO     XDATA  U_INT    0005H  2
  B_Weight_Pos . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0007H  1
CS_ScaleDisplay_SteadyFlash. . . . . .  EXTERN   CODE   PROC     -----  -----


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   5855    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     91      52
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
