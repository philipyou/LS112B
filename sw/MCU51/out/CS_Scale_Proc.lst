C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE CS_SCALE_PROC
OBJECT MODULE PLACED IN out/CS_Scale_Proc.obj
COMPILER INVOKED BY: C:\Keil\c51\bin\C51.exe CS_Scale_Proc.c OBJECT(out/CS_Scale_Proc.obj) OBJECTADVANCED OPTIMIZE(9,SPE
                    -ED) BROWSE CODE SYMBOLS DF(ENABLE_APE) PR(out/CS_Scale_Proc.lst) OT(7,SPEED) LARGE

line level    source

   1          #include "YC_Define.h"
   2          #include "YC_Peripheral.h"
   3          #include "system.h"
   4          #include "CS_Scale_Proc.h"
   5          #include "CS_CommTo1186.h"
   6          #include "CS_ScaleDisplay.h"
   7          #include "btreg.h"
   8          #include "BT_IPC.h"
   9          #include "lxProtocol.h"
  10          
  11          #include "retation_variable.h"
  12          #include "YC_Utilities.h"
  13          #include "hwreg.h"
  14          
  15          
  16          
  17          bool    B_Debug_Test;                           //调试模式
  18          u16_t xdata R_Debug_temp;               //调试用
  19          
  20          u8_t   xdata R_Selet_Unit;                      //单位选择状态
  21          u8_t      xdata R_Scale_state;          //秤的状态
  22          u8_t      xdata R_Display_Err;          //显示错误信息
  23                  
  24          
  25          //全局变量--------------------
  26          u16_t xdata  R_AD_Original;             //原始AD值
  27          u8_t      xdata  R_1186sys_state;               //1186系统状态
  28          u8_t   xdata  B_Weight_AdOk;            //AD准备好标志
  29          
  30          
  31          u8_t xdata  R_1186_RTC[4];                      //1186的RTC时间
  32          
  33          
  34          u16_t xdata R_Weight_Mem;               //记忆重量
  35          u16_t xdata R_Weight_Lock;              //锁定重量
  36          CS_Weight_T  xdata R_UnitWeight;        //重量值
  37          
  38          
  39          
  40          //////////////////////////////////////////////系统参数
  41          
  42          #define CS_Scale_FiterX                                 0x05            //滑动滤波范围5个AD内码
  43          #define CS_Scale_MaxWeight                              15300           //最大称量重量153.00kg
  44          #define CS_Scale_MinLockWeight                  250                     //最小锁定重量2.50kg
  45          #define CS_Scale_RetLockWeightInc               1000            //加重解锁重量10kg
  46          #define CS_Scale_RetLockWeightDec               300                     //减重解锁重量3kg
  47          #define CS_Scale_SameWeightRange                10                      //判断是同一个重量的阈值20个AD内码
  48          #define CS_Scale_TimeOut_Zero                   15                      //零位超时关机时间15s
  49          #define CS_Scale_TimeOut_Lock                   15                      //锁定超时关机时间15s
  50          #define CS_Scale_TimeOut_Unstable               15                      //不稳定关机时间15s
  51          #define CS_Scale_TimeOut_OverLoad               3                       //超重关机时间3s
  52          #define CS_Scale_TimeOut_LowBat         3                       //低电关机时间3s
  53          #define CS_Scale_TimeOut_ZeroErr                3                       //零点错误显示时间3s  *
  54          #define SameZeroRange                                   10                      //认为是同一个零点的误差范围
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 2   

  55          #define ScaleWeightMin                                  10                      //秤体重量左边界值
  56          #define ScaleWeightMax                                  15                      //秤体重量右边界值
  57          #define ScaleStartMemoryWeight                  600                     //秤开始记忆重量范围
  58          #define CS_CaliStateData_Up                             6000            //标定数据有效值上限(对应AD内码)
  59          #define CS_CaliStateData_Down                   1000            //标定数据有效值下限(对应AD内码)
  60          #define   CS_PowerOnAD_Steadytimes              10                      //稳定开机稳定次数
  61          #define   CS_SmallWeight_Steadytimes            6                       //判断稳定的次数
  62          #define   CS_BigWeight_Steadytimes              5                       //判断稳定的次数
  63          #define   CS_Cali_Steadytimes                           12                      //标定时判断稳定的次数
  64          #define CS_MemoryRange                          25                      //记忆重量范围
  65          
  66          
  67          //////////////////////////////////////////////内部函数声明
  68          
  69          void CS_Scale_WeightProc(void);
  70          
  71          
  72          #define GetDeltaAD                                      0
  73          #define GetADDirection                          1
  74          u16_t CS_Scale_GetDeltaAD(u8_t option);
  75          
  76          
  77          #define ScaleAdcFilterRun                       0
  78          #define ScaleAdcFilterReset                     1
  79          #define ScaleAdcFilterGetFilTimes       2
  80          u16_t CS_Scale_AdcFilter(u8_t option,u16_t R_AD_BUF);
  81          
  82          
  83          void CS_Scale_GetWeight(u16_t R_AD_BUF);
  84          
  85          #define Run                                                     0
  86          #define ResetTimes                                      1
  87          #define GetTimes                                        2
  88          u8_t CS_Scale_SameWeightTimes(u8_t option);
  89          
  90          #define JudgeSteadyRun                          0
  91          #define ResetSteady                                     1
  92          #define GetIfSmallSteady                        2
  93          #define GetIfHeavySteady                        3
  94          u8_t CS_Scale_JudgeSteady(u8_t option);
  95          
  96          
  97          
  98          #define LockProcRun                                     0
  99          #define SetDowningLock                          1
 100          #define GetIfLock                                       2
 101          u8_t CS_Scale_LockProc(u8_t option);
 102          
 103          
 104          #define SteadyProcReset                         0
 105          #define SteadyProcRun                           1
 106          void CS_Scale_SteadyProc(u8_t option);
 107          
 108          
 109          void CS_Scale_ReturnLock(void);
 110          
 111          
 112          void CS_Scale_StandbyProc(u8_t B_Reset);
 113          
 114          
 115          void CS_Scale_PowerOnProc(bool B_Reset);
 116          
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 3   

 117          /*
 118          R_Debug_temp=1234;
 119          CS_ScaleDisplay_Debug();
 120          while(1);
 121          
 122          */
 123          
 124          //////////////////////////////////////////主流程
 125          
 126          void CS_Scale_Proc(void)
 127          {
 128   1              if(R_Scale_state == CS_Scale_state_init)
 129   1                      {       
 130   2                      CS_Scale_PowerOnProc(0);
 131   2                      }
 132   1              if(R_Scale_state == CS_Scale_state_standby)
 133   1                      {
 134   2                      CS_Scale_StandbyProc(0);                
 135   2                      }
 136   1                      
 137   1              if(B_Weight_AdOk == true)
 138   1                      {               
 139   2                      B_Weight_AdOk = false;  
 140   2                      
 141   2                      if(CS_Scale_ZeroProc(GetPowerOnZeroState,0)== false)    //还没上电取零点先取零点
 142   2                              {
 143   3                              CS_Scale_ZeroProc(FindPowerOnZero,0);
 144   3                              }
 145   2                      else
 146   2                              {
 147   3                                      
 148   3                              if(R_Scale_state == CS_Scale_state_weighting)
 149   3                                      {
 150   4                                      CS_Scale_WeightProc();
 151   4                                      CS_ScaleDisplay();
 152   4                                      }
 153   3                              if(R_Scale_state == CS_Scale_state_locking)
 154   3                                      {                                       
 155   4                                      CS_ScaleDisplay_SteadyFlash();
 156   4                                      if(CS_SoftTimer(GetIfTimeOut) == true)  //锁定闪现时间到
 157   4                                              {
 158   5                                              CS_Scale_SteadyProc(SteadyProcRun);
 159   5                                              CS_ScaleDisplay();
 160   5                                              }
 161   4                                      }
 162   3                              if(R_Scale_state == CS_Scale_state_caling)
 163   3                                      {
 164   4                                      CS_Scale_CaliProc(CaliProcRun);
 165   4                                      }       
 166   3                              
 167   3                              CS_Scale_TimeOutProc(0);
 168   3                              }
 169   2                      }
 170   1      }       
 171          
 172          
 173          
 174          //////////////////////////////////////////开机流程
 175          
 176          
 177          
 178          void CS_Scale_PowerOn(void)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 4   

 179          {
 180   1              
 181   1              if(R_Scale_state == CS_Scale_state_init)
 182   1                      {
 183   2                      B_Weight_AdOk = false;
 184   2                      R_Weight_Com_Coo.pre =CS_CommTo1186_Null;       
 185   2                      R_Weight_Com_Coo.now = CS_CommTo1186_Null;      
 186   2                      //R_Scale_state =       CS_Scale_state_weighting;
 187   2                      R_Selet_Unit = CS_ScaleDisplay_L_gongjin;
 188   2      
 189   2                      R_Debug_temp = 0;
 190   2                      B_Debug_Test =false;
 191   2                      
 192   2                      CS_Scale_CaliProc(CaliProcSetCali);             
 193   2                      CS_Scale_ZeroProc(ZeroProcReset,0);     
 194   2                      
 195   2                      CS_Scale_TimeOutProc(CS_Reset_AllTime);
 196   2                      CS_Scale_PowerOnProc(1);
 197   2                      }
 198   1      }
 199          
 200          
 201          
 202          
 203          
 204          
 205          //////////////////////////////////////////正常称重流程
 206          
 207          void CS_Scale_WeightProc(void)
 208          {
 209   1              u16_t   R_AD_BUF;
 210   1              
 211   1              R_AD_BUF = CS_Scale_GetDeltaAD(GetDeltaAD);
 212   1              R_AD_BUF = CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
 213   1              CS_Scale_GetWeight(R_AD_BUF);
 214   1              CS_Scale_SameWeightTimes(Run);
 215   1              CS_Scale_ZeroProc(RunningZero,0);
 216   1              CS_Scale_LockProc(LockProcRun);
 217   1              CS_Scale_JudgeOverLoad(0);
 218   1              //CS_Scale_JudgeLowBat(0);
 219   1              CS_Scale_JudgeSteady(JudgeSteadyRun);
 220   1              
 221   1      }
 222          
 223          
 224          //当前AD和零点AD的差值
 225          u16_t CS_Scale_GetDeltaAD(u8_t option)
 226          {
 227   1              static       u8_t xdata B_Weight_Pos;                           //正负AD变化标志
 228   1              u16_t   ad_temp;
 229   1              u16_t      R_AD_Zero;
 230   1              R_AD_Zero = CS_Scale_ZeroProc(GetRunningZero,0);
 231   1              if(R_AD_Original>R_AD_Zero)
 232   1                      {
 233   2                      ad_temp = R_AD_Original - R_AD_Zero;
 234   2                      B_Weight_Pos = true;
 235   2      
 236   2                      }
 237   1              else
 238   1                      {
 239   2                      ad_temp = R_AD_Zero - R_AD_Original;
 240   2                      B_Weight_Pos = false;           
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 5   

 241   2                      }
 242   1      
 243   1              
 244   1              if(option == GetADDirection)
 245   1                      {
 246   2                      return  B_Weight_Pos;
 247   2                      }       
 248   1              return ad_temp;
 249   1      }
 250          
 251          
 252          
 253          //滑动平均滤波
 254          u16_t CS_Scale_AdcFilter(u8_t option,u16_t R_AD_BUF)
 255          {
 256   1              u32_t   ad_temp;
 257   1              static  u16_t xdata R_AD_FilTimes;
 258   1              static  u16_t xdata R_AD_BUF_OLD;
 259   1              static  u16_t xdata R_AD_F1;
 260   1              static  u16_t xdata R_AD_F2;
 261   1              static  u16_t xdata R_AD_F3;
 262   1              static  u16_t xdata R_AD_F4;
 263   1              static  u16_t xdata R_AD_F5;
 264   1              static  u16_t xdata R_AD_F6;
 265   1              static  u16_t xdata R_AD_F7;
 266   1              static  u16_t xdata R_AD_F8;    
 267   1                      
 268   1              if(option==ScaleAdcFilterGetFilTimes)
 269   1                      {
 270   2                      return  R_AD_FilTimes;
 271   2                      }
 272   1              
 273   1              
 274   1              if(R_AD_BUF >R_AD_BUF_OLD)
 275   1                      ad_temp = R_AD_BUF - R_AD_BUF_OLD;
 276   1              else
 277   1                      ad_temp = R_AD_BUF_OLD - R_AD_BUF;
 278   1      
 279   1              R_AD_BUF_OLD    =       R_AD_BUF;
 280   1              
 281   1              if((ad_temp > CS_Scale_FiterX) ||(option==ScaleAdcFilterReset)) 
 282   1                      {                                               
 283   2                      R_AD_FilTimes = 0;
 284   2                      R_AD_F1             = 0;
 285   2                      R_AD_F2             = 0;
 286   2                      R_AD_F3             = 0;
 287   2                      R_AD_F4             = 0;
 288   2                      R_AD_F5             = 0;
 289   2                      R_AD_F6             = 0;
 290   2                      R_AD_F7             = 0;
 291   2                      R_AD_F8             = 0;
 292   2                      }
 293   1              else
 294   1                      {
 295   2                      if(R_AD_FilTimes < 200 )
 296   2                      R_AD_FilTimes ++;       
 297   2      
 298   2                              if(R_AD_FilTimes<=1)
 299   2                                      R_AD_F1 = R_AD_BUF;     
 300   2                              if(R_AD_FilTimes<=2)
 301   2                                      R_AD_F2 = R_AD_BUF;
 302   2                              if(R_AD_FilTimes<=3)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 6   

 303   2                                      R_AD_F3 = R_AD_BUF;
 304   2                              if(R_AD_FilTimes<=4)
 305   2                                      R_AD_F4 = R_AD_BUF;
 306   2                              if(R_AD_FilTimes<=5)
 307   2                                      R_AD_F5 = R_AD_BUF;
 308   2                              if(R_AD_FilTimes<=6)
 309   2                                      R_AD_F6 = R_AD_BUF;
 310   2                              if(R_AD_FilTimes<=7)
 311   2                                      R_AD_F7 = R_AD_BUF;
 312   2                              if(R_AD_FilTimes<=8)
 313   2                                      R_AD_F8 = R_AD_BUF;
 314   2                              if(R_AD_FilTimes>8)
 315   2                                      {
 316   3                                      R_AD_F1 = R_AD_F2;
 317   3                                      R_AD_F2 = R_AD_F3;
 318   3                                      R_AD_F3 = R_AD_F4;
 319   3                                      R_AD_F4 = R_AD_F5;
 320   3                                      R_AD_F5 = R_AD_F6;
 321   3                                      R_AD_F6 = R_AD_F7;
 322   3                                      R_AD_F7 = R_AD_F8;
 323   3                                      R_AD_F8 = R_AD_BUF;
 324   3                                      }
 325   2      
 326   2                      ad_temp = R_AD_F1;
 327   2                      ad_temp += R_AD_F2;
 328   2                      ad_temp += R_AD_F3;
 329   2                      ad_temp += R_AD_F4;
 330   2                      ad_temp += R_AD_F5;
 331   2                      ad_temp += R_AD_F6;
 332   2                      ad_temp += R_AD_F7;
 333   2                      ad_temp += R_AD_F8;
 334   2      
 335   2                      R_AD_BUF = ad_temp / 8 ;
 336   2                      R_AD_BUF_OLD    =       R_AD_BUF;
 337   2                      }
 338   1              return  R_AD_BUF;
 339   1      }
 340          
 341          
 342          
 343          
 344          void CS_Scale_GetWeight(u16_t R_AD_BUF)
 345          {
 346   1              u32_t   ad_temp;
 347   1              u16_t   ad_cal;
 348   1              u16_t   CaliDot1,CaliDot2,CaliDot3;
 349   1              
 350   1              CaliDot1 =CS_Scale_CaliProc(CaliProcGetCaliDot1);
 351   1              CaliDot2 =CS_Scale_CaliProc(CaliProcGetCaliDot2);
 352   1              CaliDot3 =CS_Scale_CaliProc(CaliProcGetCaliDot3);
 353   1              
 354   1              if(R_AD_BUF <= CaliDot1 )
 355   1                      {
 356   2                      ad_temp = (u32_t)R_AD_BUF  * 5000;      
 357   2                      R_UnitWeight.origin = ad_temp / CaliDot1;
 358   2                      return;
 359   2                      }
 360   1              ad_cal = R_AD_BUF - CaliDot1;
 361   1      
 362   1              if(ad_cal <=CaliDot2)
 363   1                      {
 364   2                      ad_temp = (u32_t)ad_cal  * 5000;        
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 7   

 365   2                      R_UnitWeight.origin = ad_temp / CaliDot2 +5000 ;
 366   2                      return;
 367   2                      }
 368   1              
 369   1              ad_cal  = R_AD_BUF - CaliDot1 - CaliDot2 ;      
 370   1              ad_temp = (u32_t)ad_cal  * 5000;        
 371   1              R_UnitWeight.origin = ad_temp /CaliDot3 +10000 ;
 372   1      
 373   1              
 374   1      }
 375          
 376          
 377          void CS_Scale_ChangeUnit()
 378          {
 379   1              switch(R_Selet_Unit)
 380   1                      {
 381   2                      /*
 382   2                      case CS_ScaleDisplay_L_kg:
 383   2                              R_Selet_Unit=CS_ScaleDisplay_L_lb;
 384   2                              break;
 385   2                      case CS_ScaleDisplay_L_lb:
 386   2                              R_Selet_Unit=CS_ScaleDisplay_L_jin;
 387   2                              break;
 388   2                      */
 389   2                      case CS_ScaleDisplay_L_jin:
 390   2                              R_Selet_Unit=CS_ScaleDisplay_L_gongjin;
 391   2                              break;
 392   2                      case CS_ScaleDisplay_L_gongjin:
 393   2                              R_Selet_Unit=CS_ScaleDisplay_L_jin;
 394   2                              break;
 395   2                      default :
 396   2                              R_Selet_Unit=CS_ScaleDisplay_L_gongjin;
 397   2                              break;
 398   2                      }
 399   1      }
 400          
 401          
 402          
 403          u16_t  CS_Scale_ZeroProc(u8_t option,u16_t setdata)
 404          {
 405   1              static  u8_t       xdata R_Weight_GetZeroTimeOut = 0;   
 406   1              static  u16_t  xdata R_AD_PowerOnZero;  //上电零点AD值
 407   1              static  u16_t  xdata R_AD_Zero;                 //零点AD值
 408   1              static  u8_t    xdata B_Weight_Zero;            //处于零点标志
 409   1              static  u8_t    xdata B_Weight_ZeroOk;  //上电获取完零点标志
 410   1              static  u8_t       xdata B_LockDownCheck;       //下秤后第一次稳定追零
 411   1              static  u8_t       xdata B_WeightZeroErr;               //零点错误标志
 412   1              
 413   1              u16_t   R_AdFilTimes;
 414   1              u16_t   R_AD_BUF;
 415   1              u16_t   weight_temp;
 416   1              u16_t   R_Open_Weight;
 417   1              u8_t            B_Weight_Pos;
 418   1      
 419   1              
 420   1              
 421   1              if(option==ZeroProcReset)
 422   1                      {
 423   2                      B_Weight_ZeroOk = 0;
 424   2                      return 0;               
 425   2                      }
 426   1              if(option==SetPowerOnZero)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 8   

 427   1                      {
 428   2                      R_AD_PowerOnZero = setdata;
 429   2                      return 0;               
 430   2                      }
 431   1              if(option==SetRunningZero)
 432   1                      {
 433   2                      R_AD_Zero = setdata;
 434   2                      return 0;               
 435   2                      }
 436   1              if(option==ClrLockDownCheckFlag)
 437   1                      {
 438   2                      B_LockDownCheck=false;
 439   2                      return 0;
 440   2                      }
 441   1              
 442   1              if(option==FindPowerOnZero)
 443   1              {
 444   2                      
 445   2              
 446   2                      if(R_Weight_GetZeroTimeOut <60)
 447   2                      {
 448   3                      R_Weight_GetZeroTimeOut ++;
 449   3                      
 450   3                      R_AD_BUF = R_AD_Original;
 451   3                      R_AD_BUF=CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
 452   3                      R_AdFilTimes = CS_Scale_AdcFilter(ScaleAdcFilterGetFilTimes,R_AD_BUF);
 453   3                      
 454   3                              if(R_AdFilTimes >=CS_PowerOnAD_Steadytimes)
 455   3                                      {
 456   4                                      R_AD_Zero       = R_AD_BUF;
 457   4                                      R_AD_PowerOnZero = R_AD_BUF;
 458   4                                      B_Weight_ZeroOk = true;
 459   4                                      }
 460   3                      }
 461   2                      else
 462   2                      {
 463   3                      R_AD_Zero       = 4000;
 464   3                      R_AD_PowerOnZero = 4000;
 465   3                      B_Weight_ZeroOk = true;
 466   3                      }
 467   2      
 468   2              }
 469   1      
 470   1              if(option==RunningZero)
 471   1              {
 472   2              B_Weight_Zero = false;          
 473   2              //3kg以下才追零包括负重量
 474   2              B_Weight_Pos = CS_Scale_GetDeltaAD(GetADDirection);             //获取AD方向
 475   2              R_Open_Weight = CS_Scale_CaliProc(CaliProcGetOpenWeight);       //获取开机重量值
 476   2      
 477   2      
 478   2              
 479   2              
 480   2              if(R_UnitWeight.origin <= 300 ||B_Weight_Pos ==false)   
 481   2                      B_Weight_Zero = true;
 482   2      
 483   2                      if(R_UnitWeight.origin <= 200 || B_Weight_Pos==false)
 484   2                              {               
 485   3                                      if(CS_Scale_SameWeightTimes(GetTimes)>CS_SmallWeight_Steadytimes        )
 486   3                                              {
 487   4      
 488   4                                              CS_Scale_SameWeightTimes(ResetTimes);
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 9   

 489   4                                              
 490   4                                              //非锁定状态正常追零
 491   4                                              if(CS_Scale_LockProc(GetIfLock)==false) 
 492   4                                                      {
 493   5                                                      if(R_AD_Original >= R_AD_PowerOnZero)
 494   5                                                              {
 495   6                                                              weight_temp = R_AD_Original - R_AD_PowerOnZero;
 496   6                                                              if(weight_temp < R_Open_Weight)
 497   6                                                                      R_AD_Zero = R_AD_Original;
 498   6                                                              }
 499   5                                                      else
 500   5                                                              R_AD_Zero = R_AD_Original;                                      
 501   5                                                      }
 502   4                                              //锁定状态下秤第一次追零做防提起处理
 503   4                                              else                    
 504   4                                                      {
 505   5                      
 506   5                                                      //R_Debug_temp=555;
 507   5                                                      //CS_ScaleDisplay_Debug();
 508   5                                                      //while(1);
 509   5                                                      
 510   5                                                      if(B_LockDownCheck==false)
 511   5                                                              {
 512   6                                                              if(R_AD_Original>R_AD_Zero)
 513   6                                                                      weight_temp = R_AD_Original - R_AD_Zero;
 514   6                                                              else
 515   6                                                                      weight_temp = R_AD_Zero - R_AD_Original;
 516   6      
 517   6      
 518   6                                                              
 519   6                                                              //跟锁定前的零点做比较不等于一个秤体重量的处理
 520   6                                                              //if(weight_temp<ScaleWeightMin&&weight_temp>ScaleWeightMax)
 521   6                                                                      //{
 522   6                                                                      R_AD_Zero = R_AD_Original;      //更新零点
 523   6                                                                      if(weight_temp>SameZeroRange)
 524   6                                                                              {
 525   7                                                                              //跟称重前不是一个零点报零点错并解锁
 526   7                                                                              B_WeightZeroErr=true;
 527   7                                                                              R_Display_Err=CS_ScaleDisplay_L_err;
 528   7                                                                              CS_SoftTimer(ResetSoftTimer);
 529   7                                              
 530   7                                                                              }
 531   6                                                                      B_LockDownCheck=true;
 532   6                                                                      }
 533   5      
 534   5                                                              }                               
 535   4                                                              
 536   4                                              }
 537   3                              }
 538   2      
 539   2              if(B_WeightZeroErr==true)
 540   2                      {
 541   3                      if(CS_SoftTimer(GetSoftTimerTime)>200)
 542   3                              {
 543   4                              R_Display_Err=0;
 544   4                              B_WeightZeroErr=false;
 545   4                              CS_Scale_LockProc(LockProcUnLock);
 546   4                              }                                       
 547   3                      }
 548   2              return  0;              
 549   2              }
 550   1      
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 10  

 551   1              if(option==GetPowerOnZero)
 552   1                      return  R_AD_PowerOnZero;
 553   1              if(option==GetPowerOnZeroState)
 554   1                      return  B_Weight_ZeroOk;
 555   1              if(option==GetRunningZero)
 556   1                      return  R_AD_Zero;
 557   1              if(option==GetZeroState)
 558   1                      return  B_Weight_Zero;
 559   1              if(option==GetIfZeroErr)
 560   1                      return   B_WeightZeroErr;
 561   1              
 562   1              return 0;       
 563   1      }
 564          
 565          
 566          
 567          #define LockProcZeroLock                        1
 568          #define LockProcZeroUnLock                      0xfe
 569          #define LockProcDownLock                        2
 570          #define LockProcDownUnLock              0xfd
 571          #define LockProcLock                    LockProcZeroLock+LockProcDownLock
 572          #define LockProcUnLock                          3
 573          
 574          u8_t CS_Scale_LockProc(u8_t option)
 575          {
 576   1              static u8_t xdata B_Weight_Downing_Lock;                //下秤过程有重物在上面锁住
 577   1              
 578   1              if(option==SetDowningLock)
 579   1                      {
 580   2                      B_Weight_Downing_Lock =LockProcLock;
 581   2                      return 0;
 582   2                      }
 583   1      
 584   1              if(option==GetIfLock)
 585   1                      {
 586   2                      return B_Weight_Downing_Lock;
 587   2                      }
 588   1              if(option==LockProcUnLock)
 589   1                      {
 590   2                      B_Weight_Downing_Lock =false;
 591   2                      return 0;
 592   2                      }
 593   1              
 594   1              if(CS_Scale_ZeroProc(GetZeroState,0)==true)             //处于零位
 595   1                      {
 596   2                      B_Weight_Downing_Lock &=LockProcDownUnLock ;
 597   2                      
 598   2                      if(B_Weight_Downing_Lock&LockProcZeroLock)
 599   2                      R_UnitWeight.origin = R_Weight_Lock;
 600   2                      }
 601   1              else
 602   1                      {
 603   2                      if(B_Weight_Downing_Lock&LockProcDownLock)
 604   2                              R_UnitWeight.origin = R_Weight_Lock;
 605   2                      else
 606   2                              B_Weight_Downing_Lock &= LockProcZeroUnLock;
 607   2                      }
 608   1      
 609   1              return 0;
 610   1      }
 611          
 612          
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 11  

 613          
 614          
 615          //该部分工作移交给1186处理，不做误开机处理
 616          /*
 617          void CS_Scale_AvoidFalseBoot(void)
 618          {
 619                  static u8_t xdata R_Weight_ZeroTimes;
 620                  static u8_t xdata B_Weight_PowerOn;             //开机标志
 621                  static u8_t xdata B_Weight_AutoOpen;            //自动上秤标志
 622                  
 623                  if(R_UnitWeight.origin == 0)
 624                          {
 625                          if(R_Weight_ZeroTimes<255)
 626                                  R_Weight_ZeroTimes++;
 627                          }       
 628                  else
 629                          {
 630                          R_Weight_ZeroTimes = 0;
 631                          }
 632          
 633                  
 634                  if(R_Weight_ZeroTimes == 1)
 635                          {
 636                          if(B_Weight_AutoOpen)
 637                          B_Weight_PowerOn = false;
 638                          else
 639                          B_Weight_PowerOn = true;        
 640                          }
 641                  else
 642                          {
 643                          B_Weight_PowerOn = true;
 644                          B_Weight_AutoOpen = false;
 645                          }
 646          }       
 647          */
 648          
 649          
 650          #define CS_Scale_LowBatBit      0x02
 651          #define GetIfLowBat                     1
 652          
 653          u8_t CS_Scale_JudgeLowBat(u8_t option)
 654          {
 655   1              static  u8_t xdata B_Weight_LowBat;                     //低电标志
 656   1              
 657   1              if(R_1186sys_state&CS_Scale_LowBatBit)
 658   1                      {
 659   2                      B_Weight_LowBat = true;
 660   2                      R_Display_Err=CS_ScaleDisplay_L_err;
 661   2                      }
 662   1              else
 663   1                      B_Weight_LowBat = false;
 664   1      
 665   1              if(option==GetIfLowBat)
 666   1                      return B_Weight_LowBat;
 667   1              
 668   1                      return 0;       
 669   1      }
 670          
 671          
 672          u8_t CS_Scale_JudgeOverLoad(u8_t option)
 673          {
 674   1      
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 12  

 675   1              static  u8_t      xdata R_Weight_OverLoadTimes;
 676   1              static  u8_t  xdata  B_Weight_OverLoad;                 //超载标志
 677   1              if(option==ResetOverLoad)
 678   1                      {
 679   2                      R_Weight_OverLoadTimes = 0;
 680   2                      B_Weight_OverLoad = false;
 681   2                      return 0;
 682   2                      }
 683   1              
 684   1              if(R_UnitWeight.origin > CS_Scale_MaxWeight)
 685   1                      R_Weight_OverLoadTimes++;
 686   1              if(R_Weight_OverLoadTimes >=2)
 687   1                      {
 688   2                      R_Weight_OverLoadTimes = 2;
 689   2                      B_Weight_OverLoad = true;
 690   2                      R_Display_Err=CS_ScaleDisplay_L_err;
 691   2                      }
 692   1              else
 693   1                      B_Weight_OverLoad = false;
 694   1      
 695   1              if(option==GetIfOverLoad)
 696   1                      return B_Weight_OverLoad;
 697   1              
 698   1                      return 0;
 699   1      }
 700          
 701          
 702          
 703          u8_t CS_Scale_SameWeightTimes(u8_t option)
 704          {
 705   1              u16_t   weight_temp;
 706   1              static  u16_t xdata R_Weight_kg_old;
 707   1              static  u8_t      xdata R_Weight_SameTimes;
 708   1      
 709   1              if(option==ResetTimes)
 710   1                      {
 711   2                      R_Weight_SameTimes = 0;
 712   2                      return 0;
 713   2                      }       
 714   1      
 715   1              if(option==GetTimes)
 716   1                      return R_Weight_SameTimes;
 717   1              
 718   1              
 719   1              if(R_UnitWeight.origin > R_Weight_kg_old)
 720   1                      weight_temp = R_UnitWeight.origin -R_Weight_kg_old;
 721   1              else
 722   1                      weight_temp = R_Weight_kg_old -R_UnitWeight.origin;
 723   1                      
 724   1              if(weight_temp <  CS_Scale_SameWeightRange)
 725   1                      {
 726   2                      if(R_Weight_SameTimes<255)
 727   2                      R_Weight_SameTimes++;
 728   2                      }
 729   1                      else
 730   1                      R_Weight_SameTimes = 0;
 731   1      
 732   1              R_Weight_kg_old = R_UnitWeight.origin;
 733   1      
 734   1              return 0;       
 735   1      }
 736          
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 13  

 737          
 738          
 739          
 740          u8_t CS_Scale_JudgeSteady(u8_t option)
 741          {
 742   1      
 743   1              u16_t   R_Weight_Temp;
 744   1              //static        u8_t xdata B_Weight_SmallSteady;                //小重量稳定标志
 745   1              static  u8_t xdata B_Weight_HeavySteady;        //大重量稳定标志
 746   1              
 747   1              if(option==ResetSteady)
 748   1                      {
 749   2                      B_Weight_HeavySteady = false;
 750   2                      return 0;
 751   2                      }       
 752   1      
 753   1              if(option==GetIfHeavySteady)
 754   1                      return B_Weight_HeavySteady;
 755   1              
 756   1              if(CS_Scale_LockProc(GetIfLock)==false)
 757   1                      {
 758   2              
 759   2                      B_Weight_HeavySteady = false;
 760   2                      if(R_UnitWeight.origin>=CS_Scale_MinLockWeight  )
 761   2                      {
 762   3                              if(CS_Scale_SameWeightTimes(GetTimes)>CS_BigWeight_Steadytimes)
 763   3                                      {
 764   4                                      B_Weight_HeavySteady = true;    
 765   4      
 766   4                                      if(R_UnitWeight.origin>R_Weight_Mem)
 767   4                                      R_Weight_Temp = R_UnitWeight.origin -R_Weight_Mem;
 768   4                                      else
 769   4                                      R_Weight_Temp = R_Weight_Mem - R_UnitWeight.origin;
 770   4      
 771   4                                              //在记忆范围内记忆
 772   4                                      if(R_UnitWeight.origin > ScaleStartMemoryWeight)
 773   4                                              {
 774   5                                              if(R_Weight_Temp<CS_MemoryRange)
 775   5                                              R_UnitWeight.origin = R_Weight_Mem;
 776   5                                              }
 777   4                                      
 778   4                                      R_Weight_Lock = R_UnitWeight.origin;
 779   4                                      R_Weight_Mem = R_UnitWeight.origin;
 780   4                                              
 781   4                                      R_Scale_state = CS_Scale_state_locking;
 782   4                                      CS_SoftTimer(ResetSoftTimer);           //软件定时器开始用于锁定闪显示计时
 783   4                                      CS_Scale_SteadyProc(SteadyProcReset);
 784   4                                      CS_Scale_TimeOutProc(CS_Reset_AllTime);
 785   4                                      }
 786   3                              }
 787   2                      }
 788   1              return 0;
 789   1      }
 790          
 791          
 792          
 793          
 794          ///////////////////////////////////锁定流程
 795          
 796          
 797          
 798          void CS_Scale_SteadyProc(u8_t option)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 14  

 799          {
 800   1              u16_t   R_AD_BUF;       
 801   1      
 802   1              static  u8_t xdata B_Debug_Send;        
 803   1              static  u8_t xdata ReadUTC;
 804   1              UserMeasureData SendData;
 805   1      
 806   1              if(option==SteadyProcReset)
 807   1                      {
 808   2                      B_Debug_Send=false;
 809   2                      return;
 810   2                      }
 811   1              
 812   1              
 813   1                      if(CS_Scale_JudgeSteady(GetIfHeavySteady) == true)
 814   1                              {
 815   2                              
 816   2                              CS_Scale_JudgeSteady(ResetSteady);
 817   2                      
 818   2                              CS_Scale_ZeroProc(ClrLockDownCheckFlag,0);
 819   2                              ReadUTC = false;        //初始化读ADC
 820   2                              }
 821   1                      else
 822   1                              {
 823   2                              
 824   2                              /*
 825   2                              if(wechatStatus == WECHAT_ST_OK&&B_Debug_Send==false)
 826   2                                      {
 827   2                                      sendMeasureData();
 828   2                                      B_Debug_Send=true;
 829   2                                      }
 830   2                              */              
 831   2                              if(B_Debug_Send==false)
 832   2                                      {
 833   3                                      
 834   3                                      if(ReadUTC==false)
 835   3                                              {
 836   4                                              ReadUTC=true;
 837   4                                              CS_Scale_1186ComSend(CS_CommTo1186_ReadTime);   
 838   4                                              }
 839   3                                      
 840   3                                      if(CS_If1186ComSucess()==true)
 841   3                                              {
 842   4                                              
 843   4                                              
 844   4                                              ReadUTC=false;
 845   4                                              
 846   4                                              SendData.UTCTime[0]=R_1186_RTC[0];
 847   4                                              SendData.UTCTime[1]=R_1186_RTC[1];      
 848   4                                              SendData.UTCTime[2]=R_1186_RTC[2];      
 849   4                                              SendData.UTCTime[3]=R_1186_RTC[3];      
 850   4                                              SendData.weight=ESWAP(R_UnitWeight.origin);
 851   4                                              QueuePush(&SendData);
 852   4                                              B_Debug_Send=true;
 853   4      
 854   4                                              CS_Scale_1186ComSend(CS_CommTo1186_ReadAd);
 855   4                              
 856   4                                              //CS_SoftTimer(ResetSoftTimer); 
 857   4                                              
 858   4                                              }
 859   3                                      
 860   3                                      }
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 15  

 861   2                              else
 862   2                                      {
 863   3                                      R_AD_BUF = CS_Scale_GetDeltaAD(GetDeltaAD);
 864   3                                      R_AD_BUF = CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
 865   3                                      CS_Scale_GetWeight(R_AD_BUF);                           
 866   3                                      CS_Scale_ReturnLock();
 867   3                                      
 868   3                                       R_UnitWeight.origin = R_Weight_Lock;   //锁定重量
 869   3                                      }
 870   2                              }
 871   1              
 872   1      
 873   1                              /*
 874   1                              if(CS_SoftTimer(GetSoftTimerTime)<200)
 875   1                                      {
 876   1                              R_Debug_temp=SendData.UTCTime;
 877   1                              CS_ScaleDisplay_Debug();                        
 878   1                              return;
 879   1                                      }
 880   1                              */      
 881   1                              /* B_Debug_Test =true;
 882   1                              if(B_Debug_Test)
 883   1                                      {
 884   1                                      R_Debug_temp=888;
 885   1                                      CS_ScaleDisplay_Debug();
 886   1                                      while(1);
 887   1                                      }
 888   1                              */
 889   1      }
 890          
 891          
 892          
 893          void CS_Scale_ReturnLock(void)
 894          {
 895   1              u16_t   weight_temp;
 896   1              
 897   1              if( R_UnitWeight.origin > R_Weight_Lock)
 898   1                      {
 899   2                      weight_temp = R_UnitWeight.origin -R_Weight_Lock;
 900   2                      if(weight_temp >= CS_Scale_RetLockWeightInc)
 901   2                              {
 902   3                              R_Scale_state = CS_Scale_state_weighting;
 903   3                              CS_Scale_TimeOutProc(CS_Reset_AllTime);
 904   3                              }
 905   2                      }
 906   1              else
 907   1                      {
 908   2                      weight_temp = R_Weight_Lock -R_UnitWeight.origin;
 909   2                      if(weight_temp >= CS_Scale_RetLockWeightDec)
 910   2                              {
 911   3                              
 912   3                              R_Scale_state = CS_Scale_state_weighting;
 913   3                              CS_Scale_LockProc(SetDowningLock);
 914   3                              CS_Scale_TimeOutProc(CS_Reset_AllTime);
 915   3                              
 916   3                              }
 917   2                      }
 918   1      
 919   1      }
 920          
 921          #define StartClearMemWeightTimer        1
 922          #define MemWeightTimerInc                       2
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 16  

 923          #define MemWeightTimer                  30
 924          
 925          void CS_MemoryWeightClear_Timer(u8_t option)
 926          {
 927   1              static u8_t xdata timecount;                            //计时变量
 928   1              static u8_t xdata B_Timeout;
 929   1      
 930   1              if(option==StartClearMemWeightTimer)
 931   1                      {
 932   2                      timecount=0;
 933   2                      B_Timeout = false;
 934   2                      }
 935   1      
 936   1              if(option==MemWeightTimerInc)
 937   1                      {
 938   2                      if(timecount<255 ) 
 939   2                      timecount++;
 940   2                      }
 941   1              
 942   1              if(B_Timeout == false)
 943   1                      {
 944   2                      if(timecount>SoftTimerTimeOut)
 945   2                              {
 946   3                              B_Timeout = true;
 947   3                              R_Weight_Mem = 0;       //时间到清记忆重量
 948   3                              }
 949   2                      }
 950   1      }
 951          
 952          
 953          ///////////////////////////////////标定流程
 954          #define CS_CaliState_GetZero                    0
 955          #define CS_CaliState_ShowCal1                   1
 956          #define CS_CaliState_GetCal1                    2
 957          #define CS_CaliState_ShowCal2                   3
 958          #define CS_CaliState_GetCal2                    4
 959          #define CS_CaliState_ShowCal3                   5
 960          #define CS_CaliState_GetCal3                    6
 961          #define CS_CaliState_ShowCal4                   7
 962          #define CS_CaliState_SaveData                   8
 963          #define CS_CaliState_ShowPass                   9
 964          #define CS_CaliState_ShowErr                    10
 965          
 966          u16_t CS_Scale_CaliProc(u8_t option)
 967          {
 968   1              static  u16_t xdata R_AD_CaliDot1;              //第一个标定点AD值
 969   1              static  u16_t xdata R_AD_CaliDot2;              //第二个标定点AD值
 970   1              static  u16_t xdata R_AD_CaliDot3;              //第三个标定点AD值
 971   1              static  u8_t      xdata R_CaliState;                    //标定状态
 972   1              static  u16_t xdata R_OpenWeight_Ad;    //开机重量AD值
 973   1              
 974   1              u16_t   R_AdFilTimes;   
 975   1              u16_t   weight_temp;
 976   1              u16_t   R_AD_BUF;
 977   1              u16_t   R_AD_PowerOnZero;
 978   1      
 979   1              if(option==CaliProcReset)
 980   1                      {
 981   2                      R_CaliState=CS_CaliState_GetZero;
 982   2                      return  0;
 983   2                      }
 984   1              if(option==CaliProcSetCali)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 17  

 985   1                      {
 986   2      /*
 987   2                      *(mem_sensor_buf )= 12;
 988   2                      *(mem_sensor_buf+1) = 12;
 989   2                      *(mem_sensor_buf+2 )= 12;
 990   2                      *(mem_sensor_buf+3) = 12;
 991   2                      *(mem_sensor_buf+4 )= 12;
 992   2                      *(mem_sensor_buf+5) = 12;
 993   2                      SpiFlashOperator(CS_CMD_WRITE_FLASH);
 994   2                      //YC_Delay10ms(10);
 995   2                      
 996   2                      *(mem_sensor_buf )= 0;
 997   2                      *(mem_sensor_buf+1) = 0;
 998   2                      *(mem_sensor_buf+2 )= 0;
 999   2                      *(mem_sensor_buf+3) = 0;
1000   2                      *(mem_sensor_buf+4 )= 0;
1001   2                      *(mem_sensor_buf+5) = 0;
1002   2                      
1003   2                      
1004   2                      SpiFlashOperator( CS_CMD_READ_FLASH);
1005   2                      
1006   2                      
1007   2                      
1008   2                      R_Debug_temp=(u16_t) *(mem_sensor_buf+2 ) ;
1009   2                      CS_ScaleDisplay_Debug();
1010   2                      while(1);
1011   2                      */
1012   2                      //YC_Delay1S(1);
1013   2                      
1014   2                      R_AD_BUF = *(mem_sensor_buf );
1015   2                      R_AD_CaliDot1 =R_AD_BUF<<8 |  (*(mem_sensor_buf+1));
1016   2                      R_AD_BUF = *(mem_sensor_buf+2 );
1017   2                      R_AD_CaliDot2 =R_AD_BUF<<8 |  (*(mem_sensor_buf+3));
1018   2                      R_AD_BUF = *(mem_sensor_buf+4 );
1019   2                      R_AD_CaliDot3 =R_AD_BUF<<8 |  (*(mem_sensor_buf+5));    
1020   2      
1021   2                      
1022   2      
1023   2                      if(R_AD_CaliDot1<CS_CaliStateData_Down || R_AD_CaliDot1>CS_CaliStateData_Up)
1024   2                              if(R_AD_CaliDot2<CS_CaliStateData_Down||R_AD_CaliDot2>CS_CaliStateData_Up)
1025   2                                      if(R_AD_CaliDot3<CS_CaliStateData_Down||R_AD_CaliDot3>CS_CaliStateData_Up)
1026   2                                              {
1027   3                                              R_AD_CaliDot1   = 6000;
1028   3                                              R_AD_CaliDot2   = 5000;
1029   3                                              R_AD_CaliDot3   = 4000; 
1030   3                                              }       
1031   2                      
1032   2                      
1033   2                      R_OpenWeight_Ad = R_AD_CaliDot1/10;
1034   2                      return  0;              
1035   2                      }
1036   1              if(option==CaliProcSetOpenWeight)
1037   1                      {
1038   2                      R_OpenWeight_Ad = R_AD_CaliDot1/10;
1039   2                      return  0;
1040   2                      }
1041   1              
1042   1              if(option==CaliProcGetOpenWeight)
1043   1                      return R_OpenWeight_Ad;
1044   1              if(option==CaliProcGetCaliDot1)
1045   1                      return R_AD_CaliDot1;
1046   1              if(option==CaliProcGetCaliDot2)
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 18  

1047   1                      return R_AD_CaliDot2;
1048   1              if(option==CaliProcGetCaliDot3)
1049   1                      return R_AD_CaliDot3;
1050   1              
1051   1              R_AD_BUF = R_AD_Original;
1052   1              R_AD_BUF=CS_Scale_AdcFilter(ScaleAdcFilterRun,R_AD_BUF);
1053   1              R_AdFilTimes = CS_Scale_AdcFilter(ScaleAdcFilterGetFilTimes,R_AD_BUF);
1054   1              
1055   1              
1056   1      
1057   1              //数据稳定才处理
1058   1                      
1059   1              if(R_CaliState==CS_CaliState_GetZero) 
1060   1                      {       
1061   2      
1062   2                              R_AD_CaliDot1 = R_AD_BUF;       //暂存零点用于显示
1063   2                              if(R_AdFilTimes>=CS_Cali_Steadytimes)
1064   2                                      {
1065   3                              CS_Scale_ZeroProc(SetPowerOnZero,R_AD_BUF);     
1066   3                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1067   3                              CS_SoftTimer(ResetSoftTimer);
1068   3                              R_CaliState = CS_CaliState_ShowCal1;
1069   3                                      }
1070   2                      CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_BUF);
1071   2                      }
1072   1              
1073   1              if(R_CaliState == CS_CaliState_ShowCal1)
1074   1                      {
1075   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)  
1076   2                              R_CaliState = CS_CaliState_GetCal1;
1077   2                      CS_ScaleDisplay_FreshBuf(DisplayCal1,0);
1078   2                      }
1079   1      
1080   1              if(R_CaliState==CS_CaliState_GetCal1)
1081   1                      {       
1082   2                              R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);  
1083   2                              R_AD_CaliDot1 = R_AD_BUF - R_AD_PowerOnZero;
1084   2                                      
1085   2                              if((R_AD_CaliDot1 < R_OpenWeight_Ad)||(R_AD_BUF < R_AD_PowerOnZero))
1086   2                                      {
1087   3                                      if(R_AdFilTimes>=CS_Cali_Steadytimes)
1088   3                                              {
1089   4                                              CS_Scale_ZeroProc(SetPowerOnZero,R_AD_BUF);     
1090   4                                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1091   4                                              }
1092   3                                      R_AD_CaliDot1 = 0;
1093   3                                      }
1094   2                              else
1095   2                                      {
1096   3                                      if((R_AD_CaliDot1> 750)&&(R_AdFilTimes>=CS_Cali_Steadytimes))
1097   3                                              {                               
1098   4                                              CS_SoftTimer(ResetSoftTimer);
1099   4                                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1100   4                                              R_CaliState = CS_CaliState_ShowCal2;
1101   4                                              }
1102   3                                      }
1103   2                              CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_CaliDot1);
1104   2                              
1105   2                      }
1106   1      
1107   1              if(R_CaliState == CS_CaliState_ShowCal2)
1108   1                      {
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 19  

1109   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)  
1110   2                              R_CaliState = CS_CaliState_GetCal2;
1111   2                      CS_ScaleDisplay_FreshBuf(DisplayCal2,0);
1112   2                      }
1113   1              
1114   1              if(R_CaliState==CS_CaliState_GetCal2)
1115   1                      {               
1116   2                              R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);          
1117   2                              weight_temp = R_AD_BUF - R_AD_PowerOnZero;
1118   2                                              
1119   2                              if((weight_temp < R_AD_CaliDot1)||(R_AD_BUF < R_AD_PowerOnZero))
1120   2                                      {
1121   3                                      R_AD_CaliDot2 = 0;
1122   3                                      }
1123   2                              else
1124   2                                      {
1125   3                                      R_AD_CaliDot2 = weight_temp -R_AD_CaliDot1;
1126   3                              
1127   3                                      if((R_AD_CaliDot2> 750)&& (R_AdFilTimes>=CS_Cali_Steadytimes))
1128   3                                              {
1129   4                                              CS_Scale_AdcFilter(ScaleAdcFilterReset,R_AD_BUF);
1130   4                                              CS_SoftTimer(ResetSoftTimer);
1131   4                                              R_CaliState = CS_CaliState_ShowCal3;
1132   4                                              }
1133   3                                      }
1134   2                              CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_CaliDot2);
1135   2                      }
1136   1      
1137   1              if(R_CaliState == CS_CaliState_ShowCal3)
1138   1                      {
1139   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)  
1140   2                              R_CaliState = CS_CaliState_GetCal3;
1141   2                      CS_ScaleDisplay_FreshBuf(DisplayCal3,0);
1142   2                      }
1143   1              
1144   1              if(R_CaliState==CS_CaliState_GetCal3)
1145   1                      {               
1146   2                              R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);          
1147   2                              weight_temp = R_AD_BUF - R_AD_PowerOnZero;
1148   2                                              
1149   2                              if((weight_temp < R_AD_CaliDot1)||(R_AD_BUF < R_AD_PowerOnZero))
1150   2                                      {
1151   3                                      R_AD_CaliDot3 = 0;
1152   3                                      }
1153   2                              else
1154   2                                      {
1155   3                                      weight_temp = weight_temp -R_AD_CaliDot1;
1156   3      
1157   3                                      if(weight_temp < R_AD_CaliDot2)
1158   3                                              {
1159   4                                              R_AD_CaliDot3 = 0;
1160   4                                              
1161   4                                              }
1162   3                                      else
1163   3                                              {
1164   4                                      R_AD_CaliDot3 = weight_temp -R_AD_CaliDot2;
1165   4                              
1166   4                                      if((R_AD_CaliDot3> 750)&& (R_AdFilTimes>=CS_Cali_Steadytimes))
1167   4                                              {
1168   5                                              CS_SoftTimer(ResetSoftTimer);
1169   5                                              R_CaliState = CS_CaliState_ShowCal4;
1170   5                                              }
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 20  

1171   4                                              }
1172   3                                      }
1173   2                              CS_ScaleDisplay_FreshBuf(DisplayData,R_AD_CaliDot3);
1174   2                      }
1175   1              
1176   1              if(R_CaliState == CS_CaliState_ShowCal4)
1177   1                      {
1178   2                      if(CS_SoftTimer(GetSoftTimerTime)>200) 
1179   2                              R_CaliState = CS_CaliState_SaveData;
1180   2                      CS_ScaleDisplay_FreshBuf(DisplayCal4,0);
1181   2                      }
1182   1              
1183   1              if(R_CaliState==CS_CaliState_SaveData)
1184   1                      {
1185   2                      
1186   2                      R_AD_PowerOnZero =CS_Scale_ZeroProc(GetPowerOnZero,0);
1187   2                      CS_Scale_ZeroProc(SetRunningZero,R_AD_PowerOnZero);
1188   2                      R_Scale_state = CS_Scale_state_weighting;
1189   2                      R_OpenWeight_Ad =  R_AD_CaliDot1/10;
1190   2      
1191   2                      /*
1192   2                      R_Debug_temp=R_AD_CaliDot2;
1193   2                      CS_ScaleDisplay_Debug();
1194   2                      while(1);
1195   2                      */
1196   2                      
1197   2                      *(mem_sensor_buf )= HI_UINT16(R_AD_CaliDot1);
1198   2                      *(mem_sensor_buf+1) = LO_UINT16(R_AD_CaliDot1);
1199   2                      *(mem_sensor_buf+2 )= HI_UINT16(R_AD_CaliDot2);
1200   2                      *(mem_sensor_buf+3) = LO_UINT16(R_AD_CaliDot2);
1201   2                      *(mem_sensor_buf+4 )= HI_UINT16(R_AD_CaliDot3);
1202   2                      *(mem_sensor_buf+5) = LO_UINT16(R_AD_CaliDot3);
1203   2                      SpiFlashOperator(CS_CMD_WRITE_FLASH);
1204   2      
1205   2                      
1206   2      
1207   2                      }
1208   1              return 0;
1209   1              
1210   1      }
1211          
1212          
1213          
1214          ///////////////////////////////////待机流程
1215          
1216          #define CS_Standby_S1_ToSleep                           0
1217          #define CS_Standby_S2_WakeUp                            1
1218          #define CS_Standby_S3_xxxx                              2
1219          
1220          
1221          
1222          void CS_Scale_StandbyProc(u8_t B_Reset)
1223          {
1224   1              static u8_t xdata comm_doing;
1225   1              static u8_t xdata StandbyState;
1226   1      
1227   1              if(B_Reset==1)
1228   1                      {
1229   2                      StandbyState=CS_Standby_S1_ToSleep;
1230   2                      comm_doing=false;
1231   2                      return;
1232   2                      }
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 21  

1233   1      
1234   1              if(B_Reset==2)
1235   1                      {
1236   2                      StandbyState=CS_Standby_S2_WakeUp;
1237   2                      comm_doing=false;
1238   2                      return;
1239   2                      }
1240   1              
1241   1              switch(StandbyState)
1242   1              {
1243   2              case CS_Standby_S1_ToSleep:
1244   2                      if(comm_doing==false)
1245   2                              {
1246   3                              comm_doing=true;
1247   3      
1248   3                              CS_Scale_1186ComSend(CS_CommTo1186_SetSleepMode);
1249   3                              //sys_state = SYS_ST_IDLE;                      //系统进入睡眠
1250   3                              }
1251   2                      if(CS_If1186ComSucess()==true)
1252   2                              {
1253   3                              comm_doing=false;
1254   3                              StandbyState =  CS_Standby_S2_WakeUp;
1255   3      
1256   3                              btCmdBuf.len = 0x01;
1257   3                              btCmdBuf.DATA[0] = CS_CMD_SLEEP_REQ;
1258   3                              BT_CmdFifoIn(&btCmdBuf);
1259   3      
1260   3                              //btCmdBuf.len = 2;
1261   3                              //btCmdBuf.DATA[0] = 0x20;
1262   3                              //btCmdBuf.DATA[1] = 0;
1263   3                              //BT_CmdFifoIn(&btCmdBuf);
1264   3                              
1265   3                               
1266   3                              sys_state = SYS_ST_IDLE;  //SYS_ST_SLEEP;                       //系统进入睡眠
1267   3                                              
1268   3                              }       
1269   2                      break;
1270   2              case CS_Standby_S2_WakeUp:
1271   2                      if(comm_doing==false)
1272   2                              {
1273   3                              comm_doing=true;
1274   3                              CS_Scale_1186ComSend(CS_CommTo1186_ReadAdZero);
1275   3                              }
1276   2                      if(CS_If1186ComSucess()==true)
1277   2                              {
1278   3                              comm_doing=false;
1279   3                              StandbyState =  CS_Standby_S1_ToSleep;  
1280   3                              sys_state = SYS_ST_RUN;
1281   3      
1282   3                              /*
1283   3                              while(1)
1284   3                              {
1285   3                              R_Debug_temp = R_AD_Zero;
1286   3                              CS_ScaleDisplay_Debug();
1287   3                              }
1288   3                              */
1289   3                              //清除异常状态
1290   3                              CS_Scale_JudgeOverLoad(ResetOverLoad);
1291   3                              CS_Scale_TimeOutProc(CS_Reset_AllTime);
1292   3                              R_Display_Err = 0;
1293   3                              
1294   3                              R_Scale_state = CS_Scale_state_weighting;
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 22  

1295   3                              
1296   3                              CS_Scale_1186ComSend(CS_CommTo1186_ReadAd);
1297   3                              
1298   3                              }
1299   2                      break;
1300   2              default:
1301   2                      StandbyState = CS_Standby_S1_ToSleep;
1302   2                      break;
1303   2              }
1304   1              
1305   1              //R_Debug_temp = 456;
1306   1      
1307   1      }
1308          
1309          
1310          ///////////////////////////////////开机流程
1311          
1312          #define CS_PowerOn_State1_Reset                         0
1313          #define CS_PowerOn_State2_ReadOtp                               1
1314          #define CS_PowerOn_State3_ReadVersion                   2
1315          #define CS_PowerOn_State4_ReadTime                      3
1316          #define CS_PowerOn_State5_SetOpenWeight         4
1317          #define CS_PowerOn_State6_ShowOpenPic           5
1318          #define CS_PowerOn_State7_ShowOpenPicWait       6
1319          
1320          
1321          void CS_Scale_PowerOnProc(bool B_Reset)
1322          {
1323   1              static u8_t xdata comm_doing;
1324   1              static u8_t xdata PowerOnState;
1325   1              
1326   1              
1327   1              if(B_Reset)
1328   1                      {
1329   2                      PowerOnState=CS_PowerOn_State1_Reset;
1330   2                      comm_doing=false;
1331   2                      return;
1332   2                      }
1333   1              
1334   1              //-----------S1
1335   1              if(PowerOnState==CS_PowerOn_State1_Reset)
1336   1                      {
1337   2                      if(comm_doing==false)
1338   2                              {
1339   3                              comm_doing=true;
1340   3                              CS_Scale_1186ComSend(CS_CommTo1186_Reset);
1341   3                              }
1342   2                      else
1343   2                              {
1344   3                              comm_doing=false;
1345   3                              PowerOnState    = CS_PowerOn_State2_ReadOtp;
1346   3                              }               
1347   2                      }
1348   1              //-----------S2
1349   1              if(PowerOnState==CS_PowerOn_State2_ReadOtp)
1350   1                      {
1351   2                      if(comm_doing==false)
1352   2                              {
1353   3                              comm_doing=true;
1354   3                              CS_Scale_1186ComSend(CS_CommTo1186_ReadOtp);
1355   3                              
1356   3                              }
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 23  

1357   2                      if(CS_If1186ComSucess()==true)
1358   2                              {
1359   3                              comm_doing=false;
1360   3                              PowerOnState =  CS_PowerOn_State3_ReadVersion;
1361   3                              }
1362   2                      }
1363   1              //-----------S3
1364   1              if(PowerOnState==CS_PowerOn_State3_ReadVersion)
1365   1                      {
1366   2                      PowerOnState =  CS_PowerOn_State4_ReadTime;             
1367   2                      }
1368   1              //-----------S4
1369   1              if(PowerOnState==CS_PowerOn_State4_ReadTime)
1370   1                      {
1371   2                      if(comm_doing==false)
1372   2                              {
1373   3                              comm_doing=true;
1374   3                              CS_Scale_1186ComSend(CS_CommTo1186_ReadTime);
1375   3                              }
1376   2                      if(CS_If1186ComSucess()==true)
1377   2                              {
1378   3                              comm_doing=false;
1379   3                              PowerOnState =  CS_PowerOn_State5_SetOpenWeight;        
1380   3                              }
1381   2                      }
1382   1              //-----------S5
1383   1              if(PowerOnState==CS_PowerOn_State5_SetOpenWeight)
1384   1                      {
1385   2                      if(comm_doing==false)
1386   2                              {
1387   3                              comm_doing=true;
1388   3                              CS_Scale_1186ComSend(CS_CommTo1186_SetOpenWeight);
1389   3                              }
1390   2                      if(CS_If1186ComSucess()==true)
1391   2                              {
1392   3                              comm_doing=false;
1393   3                              PowerOnState =  CS_PowerOn_State6_ShowOpenPic;
1394   3                              }
1395   2                      }
1396   1              //-----------S6
1397   1              if(PowerOnState==CS_PowerOn_State6_ShowOpenPic)
1398   1                      {
1399   2                      if(comm_doing==false)
1400   2                              {
1401   3                              comm_doing=true;        
1402   3                              CS_ScaleDisplay_FreshBuf(DisplayData,8888);
1403   3                              CS_Scale_1186ComSend(CS_CommTo1186_LcdDisplay);
1404   3                              }
1405   2                      if(CS_If1186ComSucess()==true)
1406   2                              {       
1407   3                              comm_doing=false;
1408   3                              PowerOnState =  CS_PowerOn_State7_ShowOpenPicWait;
1409   3                              CS_SoftTimer(ResetSoftTimer);
1410   3                              }               
1411   2                      }
1412   1              //-----------S7
1413   1              if(PowerOnState==CS_PowerOn_State7_ShowOpenPicWait)
1414   1                      {
1415   2                      if(CS_SoftTimer(GetSoftTimerTime)>200)
1416   2                              {
1417   3                              R_Scale_state = CS_Scale_state_weighting;
1418   3                              CS_Scale_1186ComSend(CS_CommTo1186_ReadAd);
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 24  

1419   3                              }
1420   2                      }
1421   1      
1422   1      }
1423          
1424          
1425          
1426          
1427          u8_t CS_SoftTimer(u8_t option)
1428          {
1429   1              static u8_t xdata timecount;                            //计时变量
1430   1              static u8_t xdata B_Timeout;
1431   1      
1432   1              if(option==ResetSoftTimer)
1433   1                      {
1434   2                      timecount=0;
1435   2                      B_Timeout = false;
1436   2                      }
1437   1      
1438   1              if(option==GetSoftTimerTime)
1439   1                      return  timecount;
1440   1      
1441   1              if(option==SoftTimerInc)
1442   1                      {
1443   2                      if(timecount<255 ) 
1444   2                      timecount++;
1445   2                      }
1446   1              
1447   1              
1448   1              if(timecount>SoftTimerTimeOut)
1449   1                      B_Timeout = true;
1450   1      
1451   1              if(option==GetIfTimeOut)
1452   1                      return  B_Timeout;
1453   1              
1454   1              return 0;
1455   1      
1456   1      }
1457          
1458          
1459          
1460          
1461          
1462          ///////////////////////////////////超时处理
1463          
1464          
1465          typedef struct _CS_TimeOut_T{
1466                  u8_t zero;      
1467                  u8_t lock;
1468                  u8_t unstable;
1469                  u8_t overload;
1470                  u8_t lowbat;
1471          }CS_TimeOut_T;
1472          
1473          
1474          void CS_Scale_TimeOutProc(u8_t option)
1475          {
1476   1              static  CS_TimeOut_T xdata R_TimeOut;
1477   1              static  u8_t xdata B_TimeBase_1s;               //1s时基
1478   1      
1479   1              if(option==CS_SetTimeBase1S)
1480   1                      {
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 25  

1481   2                      B_TimeBase_1s = true;
1482   2                      return;
1483   2                      }
1484   1              //超时计数器复位
1485   1              if(option)
1486   1              {
1487   2              if(option==CS_Reset_ZeroTime)
1488   2                      R_TimeOut.zero=0;
1489   2              if(option==CS_Reset_LockTime)
1490   2                      R_TimeOut.lock=0;
1491   2              if(option==CS_Reset_UnstableTime)
1492   2                      R_TimeOut.unstable=0;
1493   2              if(option==CS_Reset_OverLoadTime)
1494   2                      R_TimeOut.overload=0;
1495   2              if(option==CS_Reset_LowBatTime)
1496   2                      R_TimeOut.lowbat=0;
1497   2              if(option==CS_Reset_AllTime)
1498   2                      {
1499   3                      R_TimeOut.zero=0;
1500   3                      R_TimeOut.lock=0;
1501   3                      R_TimeOut.unstable=0;
1502   3                      R_TimeOut.overload=0;
1503   3                      R_TimeOut.lowbat=0;
1504   3                      }
1505   2              return;
1506   2              }
1507   1                      
1508   1              if(B_TimeBase_1s == true)
1509   1              {
1510   2                      B_TimeBase_1s = false;
1511   2      
1512   2                      
1513   2                      //低电超时处理
1514   2                      if(CS_Scale_JudgeLowBat(GetIfLowBat) == true)
1515   2                      {
1516   3                              R_TimeOut.lowbat++;
1517   3      
1518   3                              if(R_TimeOut.lowbat>=CS_Scale_TimeOut_LowBat)
1519   3                              {
1520   4                                      R_Scale_state = CS_Scale_state_standby;
1521   4                                      CS_Scale_StandbyProc(1);
1522   4                                      R_TimeOut.lowbat=0;
1523   4                              }
1524   3                      return;                 
1525   3                      }
1526   2      
1527   2                      //超载超时处理
1528   2                      if(CS_Scale_JudgeOverLoad(GetIfOverLoad)== true)
1529   2                      {
1530   3                              R_TimeOut.overload++;
1531   3      
1532   3                              if(R_TimeOut.overload>=CS_Scale_TimeOut_OverLoad)
1533   3                              {
1534   4                                      R_Scale_state = CS_Scale_state_standby;
1535   4                                      CS_Scale_StandbyProc(1);
1536   4                                      R_TimeOut.overload=0;
1537   4                              }
1538   3                      return; 
1539   3      
1540   3                      }
1541   2                      
1542   2                      
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 26  

1543   2                      //称重模式下的超时处理
1544   2                      if(R_Scale_state == CS_Scale_state_weighting)
1545   2                      {
1546   3                      
1547   3                      if(CS_Scale_ZeroProc(GetZeroState,0) == true)
1548   3                              {
1549   4                              R_TimeOut.unstable=0;
1550   4                              R_TimeOut.zero++;
1551   4                              }
1552   3                      else
1553   3                              {
1554   4                              R_TimeOut.zero=0;
1555   4                              R_TimeOut.unstable++;
1556   4                              }
1557   3      
1558   3                      if(R_TimeOut.zero >=CS_Scale_TimeOut_Zero||R_TimeOut.unstable>=CS_Scale_TimeOut_Unstable)
1559   3                              {
1560   4                                      //R_Debug_temp=R_TimeOut.unstable;
1561   4                                      //CS_ScaleDisplay_Debug();
1562   4                                      //while(1);
1563   4                                      
1564   4                                      R_Scale_state = CS_Scale_state_standby;
1565   4                                      CS_Scale_StandbyProc(1);
1566   4                                      R_TimeOut.zero=0;
1567   4                                      R_TimeOut.unstable=0;
1568   4                              }
1569   3                      return;
1570   3      
1571   3                      }
1572   2                      
1573   2      
1574   2                      //锁定模式下的超时处理
1575   2                      if(R_Scale_state == CS_Scale_state_locking)
1576   2                      {
1577   3                              R_TimeOut.unstable=0;
1578   3                              R_TimeOut.lock++;
1579   3                              
1580   3                              if(R_TimeOut.lock>=CS_Scale_TimeOut_Lock)
1581   3                              {
1582   4                                      
1583   4                                      R_Scale_state = CS_Scale_state_standby;
1584   4                                      CS_Scale_StandbyProc(1);
1585   4                                      R_TimeOut.lock=0;
1586   4                              }
1587   3                      return;
1588   3                      }               
1589   2                      
1590   2      
1591   2              }
1592   1      
1593   1      }
1594          
1595          
1596          
1597          
1598          
1599          
1600          
1601          
1602          
1603          
1604          
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 27  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION CS_Scale_Proc (BEGIN)
                                           ; SOURCE LINE # 126
                                           ; SOURCE LINE # 127
                                           ; SOURCE LINE # 128
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0001
                                           ; SOURCE LINE # 129
                                           ; SOURCE LINE # 130
                 R     CLR     ?CS_Scale_PowerOnProc?BIT
                 R     CALL    CS_Scale_PowerOnProc
                                           ; SOURCE LINE # 131
             ?C0001:
                                           ; SOURCE LINE # 132
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#02H,?C0002
                                           ; SOURCE LINE # 133
                                           ; SOURCE LINE # 134
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 135
             ?C0002:
                                           ; SOURCE LINE # 137
                 R     MOV     DPTR,#B_Weight_AdOk
                       MOVX    A,@DPTR
                       XRL     A,#01H
                 R     xJNZ    ?C0010
                                           ; SOURCE LINE # 138
                                           ; SOURCE LINE # 139
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 141
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_ZeroProc
                       MOV     A,R7
                       ORL     A,R6
                 R     xJNZ    ?C0004
                                           ; SOURCE LINE # 142
                                           ; SOURCE LINE # 143
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#0AH
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 144
                       RET     
             ?C0004:
                                           ; SOURCE LINE # 146
                                           ; SOURCE LINE # 148
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0006
                                           ; SOURCE LINE # 149
                                           ; SOURCE LINE # 150
                 R     CALL    CS_Scale_WeightProc
                                           ; SOURCE LINE # 151
                 E     CALL    CS_ScaleDisplay
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 28  

                                           ; SOURCE LINE # 152
             ?C0006:
                                           ; SOURCE LINE # 153
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#04H,?C0007
                                           ; SOURCE LINE # 154
                                           ; SOURCE LINE # 155
                 E     CALL    CS_ScaleDisplay_SteadyFlash
                                           ; SOURCE LINE # 156
                       MOV     R7,#03H
                 R     CALL    _CS_SoftTimer
                 R     xJNE    R7,#01H,?C0007
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 158
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_SteadyProc
                                           ; SOURCE LINE # 159
                 E     CALL    CS_ScaleDisplay
                                           ; SOURCE LINE # 160
                                           ; SOURCE LINE # 161
             ?C0007:
                                           ; SOURCE LINE # 162
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#03H,?C0009
                                           ; SOURCE LINE # 163
                                           ; SOURCE LINE # 164
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_CaliProc
                                           ; SOURCE LINE # 165
             ?C0009:
                                           ; SOURCE LINE # 167
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 168
                                           ; SOURCE LINE # 169
                                           ; SOURCE LINE # 170
             ?C0010:
                       RET     
             ; FUNCTION CS_Scale_Proc (END)

             ; FUNCTION CS_Scale_PowerOn (BEGIN)
                                           ; SOURCE LINE # 178
                                           ; SOURCE LINE # 179
                                           ; SOURCE LINE # 181
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0012
                                           ; SOURCE LINE # 182
                                           ; SOURCE LINE # 183
                 R     MOV     DPTR,#B_Weight_AdOk
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 184
                 E     MOV     DPTR,#R_Weight_Com_Coo+01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 185
                 E     MOV     DPTR,#R_Weight_Com_Coo
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 187
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 29  

                 R     MOV     DPTR,#R_Selet_Unit
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 189
                       CLR     A
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 190
                 R     CLR     B_Debug_Test
                                           ; SOURCE LINE # 192
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_CaliProc
                                           ; SOURCE LINE # 193
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#04H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 195
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 196
                 R     SETB    ?CS_Scale_PowerOnProc?BIT
                 R     CALL    CS_Scale_PowerOnProc
                                           ; SOURCE LINE # 197
                                           ; SOURCE LINE # 198
             ?C0012:
                       RET     
             ; FUNCTION CS_Scale_PowerOn (END)

             ; FUNCTION CS_Scale_WeightProc (BEGIN)
                                           ; SOURCE LINE # 207
                                           ; SOURCE LINE # 208
                                           ; SOURCE LINE # 211
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_GetDeltaAD
;---- Variable 'R_AD_BUF' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 212
                       MOV     R5,AR7
                       MOV     R4,AR6
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 213
                 R     CALL    _CS_Scale_GetWeight
                                           ; SOURCE LINE # 214
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_SameWeightTimes
                                           ; SOURCE LINE # 215
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#07H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 216
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_LockProc
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 30  

                                           ; SOURCE LINE # 217
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_JudgeOverLoad
                                           ; SOURCE LINE # 219
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_JudgeSteady
                                           ; SOURCE LINE # 221
                       RET     
             ; FUNCTION CS_Scale_WeightProc (END)

             ; FUNCTION _CS_Scale_GetDeltaAD (BEGIN)
                                           ; SOURCE LINE # 225
                 R     MOV     DPTR,#option
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 226
                                           ; SOURCE LINE # 230
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_ZeroProc
;---- Variable 'R_AD_Zero' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 231
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0014
                                           ; SOURCE LINE # 232
                                           ; SOURCE LINE # 233
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                 R     MOV     DPTR,#ad_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 234
                 R     MOV     DPTR,#B_Weight_Pos
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 236
                 R     xJMP    ?C0015
             ?C0014:
                                           ; SOURCE LINE # 238
                                           ; SOURCE LINE # 239
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 31  

                       MOVX    A,@DPTR
                       MOV     R5,A
                       CLR     C
                       MOV     A,R7
                       SUBB    A,R5
                       MOV     R7,A
                       MOV     A,R6
                       SUBB    A,R4
                 R     MOV     DPTR,#ad_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 240
                       CLR     A
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 241
             ?C0015:
                                           ; SOURCE LINE # 244
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0016
                                           ; SOURCE LINE # 245
                                           ; SOURCE LINE # 246
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
                                           ; SOURCE LINE # 247
             ?C0016:
                                           ; SOURCE LINE # 248
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                                           ; SOURCE LINE # 249
             ?C0017:
                       RET     
             ; FUNCTION _CS_Scale_GetDeltaAD (END)

             ; FUNCTION _CS_Scale_AdcFilter (BEGIN)
                                           ; SOURCE LINE # 254
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
                 R     MOV     DPTR,#option
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 255
                                           ; SOURCE LINE # 268
                 R     xJNE    R7,#02H,?C0018
                                           ; SOURCE LINE # 269
                                           ; SOURCE LINE # 270
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 32  

                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 271
             ?C0018:
                                           ; SOURCE LINE # 274
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0020
                                           ; SOURCE LINE # 275
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOVX    A,@DPTR
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                       MOV     R6,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                 R     xJMP    ?C0021
             ?C0020:
                                           ; SOURCE LINE # 277
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF_OLD+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 33  

                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
             ?C0021:
                                           ; SOURCE LINE # 279
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 281
                       CLR     A
                       MOV     R7,#05H
                       MOV     R6,A
                       MOV     R5,A
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                       SETB    C
                 E     CALL    ?C?ULCMP
                 R     xJGE    ?C0023
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0022
             ?C0023:
                                           ; SOURCE LINE # 282
                                           ; SOURCE LINE # 283
                       CLR     A
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 284
                 R     MOV     DPTR,#R_AD_F1
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 285
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 286
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 34  

                                           ; SOURCE LINE # 287
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 288
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 289
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 290
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 291
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
                 R     xJMP    ?C0024
             ?C0022:
                                           ; SOURCE LINE # 294
                                           ; SOURCE LINE # 295
                       CLR     C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0C8H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0025
                                           ; SOURCE LINE # 296
                       INC     DPTR
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                 R     JNZ     ?C0232
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
             ?C0232:
             ?C0025:
                                           ; SOURCE LINE # 298
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       SETB    C
                       SUBB    A,#01H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0026
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 35  

                                           ; SOURCE LINE # 299
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F1
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
             ?C0026:
                                           ; SOURCE LINE # 300
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#02H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0027
                                           ; SOURCE LINE # 301
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F2
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0027:
                                           ; SOURCE LINE # 302
                       SETB    C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#03H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0028
                                           ; SOURCE LINE # 303
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F3
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0028:
                                           ; SOURCE LINE # 304
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 36  

                       SETB    C
                       SUBB    A,#04H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0029
                                           ; SOURCE LINE # 305
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F4
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
             ?C0029:
                                           ; SOURCE LINE # 306
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#05H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0030
                                           ; SOURCE LINE # 307
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F5
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0030:
                                           ; SOURCE LINE # 308
                       SETB    C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#06H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0031
                                           ; SOURCE LINE # 309
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F6
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0031:
                                           ; SOURCE LINE # 310
                 R     MOV     DPTR,#R_AD_FilTimes
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 37  

                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       SETB    C
                       SUBB    A,#07H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0032
                                           ; SOURCE LINE # 311
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F7
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
             ?C0032:
                                           ; SOURCE LINE # 312
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#08H
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJGE    ?C0033
                                           ; SOURCE LINE # 313
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F8
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0033:
                                           ; SOURCE LINE # 314
                       SETB    C
                 R     MOV     DPTR,#R_AD_FilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#08H
                 R     MOV     DPTR,#R_AD_FilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0034
                                           ; SOURCE LINE # 315
                                           ; SOURCE LINE # 316
                 R     MOV     DPTR,#R_AD_F2
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F1
                       XCH     A,R7
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 38  

                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 317
                 R     MOV     DPTR,#R_AD_F3
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F2
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 318
                 R     MOV     DPTR,#R_AD_F4
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F3
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 319
                 R     MOV     DPTR,#R_AD_F5
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F4
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 320
                 R     MOV     DPTR,#R_AD_F6
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F5
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 321
                 R     MOV     DPTR,#R_AD_F7
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F6
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 39  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 322
                 R     MOV     DPTR,#R_AD_F8
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F7
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 323
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_F8
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 324
             ?C0034:
                                           ; SOURCE LINE # 326
                 R     MOV     DPTR,#R_AD_F1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 327
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 40  

                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 328
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 329
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 41  

                 R     MOV     DPTR,#R_AD_F4
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 330
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F5
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 331
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 42  

                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F6
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 332
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F7
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 43  

                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 333
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R0,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R1,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     MOV     DPTR,#R_AD_F8
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     A
                       MOV     R4,A
                       MOV     R5,A
                       MOV     A,R3
                       ADD     A,R7
                       MOV     R7,A
                       MOV     A,R2
                       ADDC    A,R6
                       MOV     R6,A
                       MOV     A,R5
                       ADDC    A,R1
                       MOV     R5,A
                       MOV     A,R4
                       ADDC    A,R0
                       MOV     R4,A
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 335
                       CLR     A
                       MOV     R3,#08H
                       MOV     R2,A
                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 44  

                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 336
                 R     MOV     DPTR,#R_AD_BUF_OLD
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 337
             ?C0024:
                                           ; SOURCE LINE # 338
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                                           ; SOURCE LINE # 339
             ?C0019:
                       RET     
             ; FUNCTION _CS_Scale_AdcFilter (END)

             ; FUNCTION _CS_Scale_GetWeight (BEGIN)
                                           ; SOURCE LINE # 344
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 345
                                           ; SOURCE LINE # 350
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#CaliDot1
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 351
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#CaliDot2
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 352
                       MOV     R7,#04H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#CaliDot3
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 45  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 354
                 R     MOV     DPTR,#CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJGE    ?C0035
                                           ; SOURCE LINE # 355
                                           ; SOURCE LINE # 356
                       MOV     R6,#013H
                       MOV     R7,#088H
                 E     CALL    ?C?LIMUL
                       INC     DPTR
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 357
                 R     MOV     DPTR,#CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R3,A
                       MOV     R2,AR6
                       CLR     A
                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
                 R     MOV     DPTR,#R_UnitWeight
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 359
             ?C0035:
                                           ; SOURCE LINE # 360
                 R     MOV     DPTR,#CaliDot1
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 46  

                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#ad_cal
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 362
                       CLR     C
                 R     MOV     DPTR,#CaliDot2+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#CaliDot2
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJLT    ?C0037
                                           ; SOURCE LINE # 363
                                           ; SOURCE LINE # 364
                 R     MOV     DPTR,#ad_cal
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#013H
                       MOV     R5,#088H
                 E     CALL    ?C?LIMUL
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
                                           ; SOURCE LINE # 365
                 R     MOV     DPTR,#CaliDot2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R3,A
                       MOV     R2,AR6
                       CLR     A
                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 47  

                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
                       MOV     A,R7
                       ADD     A,#088H
                       MOV     R7,A
                       MOV     A,R6
                       ADDC    A,#013H
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 367
             ?C0037:
                                           ; SOURCE LINE # 369
                 R     MOV     DPTR,#CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       CLR     C
                       MOV     A,R7
                       SUBB    A,R5
                       MOV     R7,A
                       MOV     A,R6
                       SUBB    A,R4
                 R     MOV     DPTR,#ad_cal
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 370
                 R     MOV     DPTR,#ad_cal
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#013H
                       MOV     R5,#088H
                 E     CALL    ?C?LIMUL
                 R     MOV     DPTR,#ad_temp
                 E     CALL    ?C?LSTXDATA
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 48  

                                           ; SOURCE LINE # 371
                 R     MOV     DPTR,#CaliDot3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R3,A
                       MOV     R2,AR6
                       CLR     A
                       MOV     R1,A
                       MOV     R0,A
                 R     MOV     DPTR,#ad_temp
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 E     CALL    ?C?ULDIV
                       MOV     A,R7
                       ADD     A,#010H
                       MOV     R7,A
                       MOV     A,R6
                       ADDC    A,#027H
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 374
             ?C0036:
                       RET     
             ; FUNCTION _CS_Scale_GetWeight (END)

             ; FUNCTION CS_Scale_ChangeUnit (BEGIN)
                                           ; SOURCE LINE # 377
                                           ; SOURCE LINE # 378
                                           ; SOURCE LINE # 379
                 R     MOV     DPTR,#R_Selet_Unit
                       MOVX    A,@DPTR
                       ADD     A,#0FEH
                 R     xJZ     ?C0040
                       DEC     A
                 R     xJNZ    ?C0041
                                           ; SOURCE LINE # 380
                                           ; SOURCE LINE # 389
             ?C0039:
                                           ; SOURCE LINE # 390
                 R     MOV     DPTR,#R_Selet_Unit
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 391
                       RET     
                                           ; SOURCE LINE # 392
             ?C0040:
                                           ; SOURCE LINE # 393
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 49  

                 R     MOV     DPTR,#R_Selet_Unit
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 394
                       RET     
                                           ; SOURCE LINE # 395
             ?C0041:
                                           ; SOURCE LINE # 396
                 R     MOV     DPTR,#R_Selet_Unit
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 397
                                           ; SOURCE LINE # 398
                                           ; SOURCE LINE # 399
             ?C0042:
                       RET     
             ; FUNCTION CS_Scale_ChangeUnit (END)

             ; FUNCTION _CS_Scale_ZeroProc (BEGIN)
                                           ; SOURCE LINE # 403
;---- Variable 'setdata' assigned to Register 'R4/R5' ----
                 R     MOV     DPTR,#option
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 404
                                           ; SOURCE LINE # 421
                 R     xJNE    R7,#04H,?C0043
                                           ; SOURCE LINE # 422
                                           ; SOURCE LINE # 423
                       CLR     A
                 R     MOV     DPTR,#B_Weight_ZeroOk
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 424
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 425
             ?C0043:
                                           ; SOURCE LINE # 426
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R3,A
                 R     xJNE    A,#05H,?C0045
                                           ; SOURCE LINE # 427
                                           ; SOURCE LINE # 428
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 429
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 430
             ?C0045:
                                           ; SOURCE LINE # 431
                       MOV     A,R3
                 R     xJNE    A,#06H,?C0046
                                           ; SOURCE LINE # 432
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 50  

                                           ; SOURCE LINE # 433
                       MOV     R7,AR5
                 R     MOV     DPTR,#R_AD_Zero
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 434
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 435
             ?C0046:
                                           ; SOURCE LINE # 436
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     xJNE    A,#08H,?C0047
                                           ; SOURCE LINE # 437
                                           ; SOURCE LINE # 438
                       CLR     A
                 R     MOV     DPTR,#B_LockDownCheck
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 439
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 440
             ?C0047:
                                           ; SOURCE LINE # 442
                       MOV     A,R5
                       XRL     A,#0AH
                 R     xJNZ    ?C0048
                                           ; SOURCE LINE # 443
                                           ; SOURCE LINE # 446
                 R     MOV     DPTR,#R_Weight_GetZeroTimeOut
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#03CH
                 R     xJGE    ?C0049
                                           ; SOURCE LINE # 447
                                           ; SOURCE LINE # 448
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 450
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 51  

                                           ; SOURCE LINE # 451
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
                                           ; SOURCE LINE # 452
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_AdcFilter
;---- Variable 'R_AdFilTimes' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 454
                       CLR     C
                       MOV     A,R7
                       SUBB    A,#0AH
                       MOV     A,R6
                       SUBB    A,#00H
                 R     xJLT    ?C0048
                                           ; SOURCE LINE # 455
                                           ; SOURCE LINE # 456
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Zero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 457
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 458
                 R     MOV     DPTR,#B_Weight_ZeroOk
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 459
                                           ; SOURCE LINE # 460
                 R     xJMP    ?C0048
             ?C0049:
                                           ; SOURCE LINE # 462
                                           ; SOURCE LINE # 463
                 R     MOV     DPTR,#R_AD_Zero
                       MOV     A,#0FH
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#0A0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 464
                 R     MOV     DPTR,#R_AD_PowerOnZero
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 52  

                       MOV     A,#0FH
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#0A0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 465
                 R     MOV     DPTR,#B_Weight_ZeroOk
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 466
                                           ; SOURCE LINE # 468
             ?C0048:
                                           ; SOURCE LINE # 470
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       XRL     A,#07H
                 R     xJNZ    ?C0052
                                           ; SOURCE LINE # 471
                                           ; SOURCE LINE # 472
                 R     MOV     DPTR,#B_Weight_Zero
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 474
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_GetDeltaAD
                 R     MOV     DPTR,#B_Weight_Pos
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 475
                       MOV     R7,#07H
                 R     CALL    _CS_Scale_CaliProc
                 R     MOV     DPTR,#R_Open_Weight
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 480
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       SETB    C
                       SUBB    A,#02CH
                       MOV     A,R6
                       SUBB    A,#01H
                 R     xJLT    ?C0054
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0053
             ?C0054:
                                           ; SOURCE LINE # 481
                 R     MOV     DPTR,#B_Weight_Zero
                       MOV     A,#01H
                       MOVX    @DPTR,A
             ?C0053:
                                           ; SOURCE LINE # 483
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#0C8H
                       MOV     A,R6
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 53  

                       SUBB    A,#00H
                 R     xJLT    ?C0056
                 R     MOV     DPTR,#B_Weight_Pos
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0055
             ?C0056:
                                           ; SOURCE LINE # 484
                                           ; SOURCE LINE # 485
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_SameWeightTimes
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#06H
                 R     xJLT    ?C0055
                                           ; SOURCE LINE # 486
                                           ; SOURCE LINE # 488
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_SameWeightTimes
                                           ; SOURCE LINE # 491
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_LockProc
                       MOV     A,R7
                 R     xJNZ    ?C0058
                                           ; SOURCE LINE # 492
                                           ; SOURCE LINE # 493
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       CLR     C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0059
                                           ; SOURCE LINE # 494
                                           ; SOURCE LINE # 495
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 496
                       SETB    C
                 R     MOV     DPTR,#R_Open_Weight+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_Open_Weight
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 54  

                       SUBB    A,R6
                 R     xJLT    ?C0055
                                           ; SOURCE LINE # 497
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_Zero
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 498
                 R     xJMP    ?C0055
             ?C0059:
                                           ; SOURCE LINE # 500
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_Zero
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 501
                 R     xJMP    ?C0055
             ?C0058:
                                           ; SOURCE LINE # 504
                                           ; SOURCE LINE # 510
                 R     MOV     DPTR,#B_LockDownCheck
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0055
                                           ; SOURCE LINE # 511
                                           ; SOURCE LINE # 512
                 R     MOV     DPTR,#R_AD_Zero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0064
                                           ; SOURCE LINE # 513
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 55  

                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                 R     xJMP    ?C0065
             ?C0064:
                                           ; SOURCE LINE # 515
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_Zero+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_Zero
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0065:
                                           ; SOURCE LINE # 522
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_AD_Zero
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 523
                       SETB    C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0AH
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0066
                                           ; SOURCE LINE # 524
                                           ; SOURCE LINE # 526
                 R     MOV     DPTR,#B_WeightZeroErr
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 527
                 R     MOV     DPTR,#R_Display_Err
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 528
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 530
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 56  

             ?C0066:
                                           ; SOURCE LINE # 531
                 R     MOV     DPTR,#B_LockDownCheck
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 532
                                           ; SOURCE LINE # 534
                                           ; SOURCE LINE # 536
                                           ; SOURCE LINE # 537
             ?C0055:
                                           ; SOURCE LINE # 539
                 R     MOV     DPTR,#B_WeightZeroErr
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0067
                                           ; SOURCE LINE # 540
                                           ; SOURCE LINE # 541
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0067
                                           ; SOURCE LINE # 542
                                           ; SOURCE LINE # 543
                       CLR     A
                 R     MOV     DPTR,#R_Display_Err
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 544
                 R     MOV     DPTR,#B_WeightZeroErr
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 545
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_LockProc
                                           ; SOURCE LINE # 546
                                           ; SOURCE LINE # 547
             ?C0067:
                                           ; SOURCE LINE # 548
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 549
             ?C0052:
                                           ; SOURCE LINE # 551
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     xJNZ    ?C0069
                                           ; SOURCE LINE # 552
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0069:
                                           ; SOURCE LINE # 553
                       MOV     A,R5
                 R     xJNE    A,#02H,?C0070
                                           ; SOURCE LINE # 554
                 R     MOV     DPTR,#B_Weight_ZeroOk
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 57  

                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
             ?C0070:
                                           ; SOURCE LINE # 555
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     xJNE    A,#01H,?C0071
                                           ; SOURCE LINE # 556
                 R     MOV     DPTR,#R_AD_Zero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0071:
                                           ; SOURCE LINE # 557
                       MOV     A,R5
                 R     xJNE    A,#03H,?C0072
                                           ; SOURCE LINE # 558
                 R     MOV     DPTR,#B_Weight_Zero
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
             ?C0072:
                                           ; SOURCE LINE # 559
                 R     MOV     DPTR,#option
                       MOVX    A,@DPTR
                 R     xJNE    A,#09H,?C0073
                                           ; SOURCE LINE # 560
                 R     MOV     DPTR,#B_WeightZeroErr
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R6,#00H
                       RET     
             ?C0073:
                                           ; SOURCE LINE # 562
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                                           ; SOURCE LINE # 563
             ?C0044:
                       RET     
             ; FUNCTION _CS_Scale_ZeroProc (END)

             ; FUNCTION _CS_Scale_LockProc (BEGIN)
                                           ; SOURCE LINE # 574
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 575
                                           ; SOURCE LINE # 578
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0074
                                           ; SOURCE LINE # 579
                                           ; SOURCE LINE # 580
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 581
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 58  

                       MOV     R7,#00H
                       RET     
                                           ; SOURCE LINE # 582
             ?C0074:
                                           ; SOURCE LINE # 584
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0076
                                           ; SOURCE LINE # 585
                                           ; SOURCE LINE # 586
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 587
             ?C0076:
                                           ; SOURCE LINE # 588
                       MOV     A,R7
                 R     xJNE    A,#03H,?C0077
                                           ; SOURCE LINE # 589
                                           ; SOURCE LINE # 590
                       CLR     A
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 591
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 592
             ?C0077:
                                           ; SOURCE LINE # 594
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_ZeroProc
                       MOV     A,R7
                       XRL     A,#01H
                       ORL     A,R6
                 R     xJNZ    ?C0078
                                           ; SOURCE LINE # 595
                                           ; SOURCE LINE # 596
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    A,@DPTR
                       ANL     A,#0FDH
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 598
                 R     xJNB    ACC.0,?C0080
                                           ; SOURCE LINE # 599
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_UnitWeight
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 600
                 R     xJMP    ?C0080
             ?C0078:
                                           ; SOURCE LINE # 602
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 59  

                                           ; SOURCE LINE # 603
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     xJNB    ACC.1,?C0081
                                           ; SOURCE LINE # 604
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       MOV     R5,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_UnitWeight
                       XCH     A,R5
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
                 R     xJMP    ?C0080
             ?C0081:
                                           ; SOURCE LINE # 606
                       MOV     A,R7
                       ANL     A,#0FEH
                 R     MOV     DPTR,#B_Weight_Downing_Lock
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 607
             ?C0080:
                                           ; SOURCE LINE # 609
                       MOV     R7,#00H
                                           ; SOURCE LINE # 610
             ?C0075:
                       RET     
             ; FUNCTION _CS_Scale_LockProc (END)

             ; FUNCTION _CS_Scale_JudgeLowBat (BEGIN)
                                           ; SOURCE LINE # 653
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 654
                                           ; SOURCE LINE # 657
                 R     MOV     DPTR,#R_1186sys_state
                       MOVX    A,@DPTR
                 R     xJNB    ACC.1,?C0083
                                           ; SOURCE LINE # 658
                                           ; SOURCE LINE # 659
                 R     MOV     DPTR,#B_Weight_LowBat
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 660
                 R     MOV     DPTR,#R_Display_Err
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 661
                 R     xJMP    ?C0084
             ?C0083:
                                           ; SOURCE LINE # 663
                       CLR     A
                 R     MOV     DPTR,#B_Weight_LowBat
                       MOVX    @DPTR,A
             ?C0084:
                                           ; SOURCE LINE # 665
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0085
                                           ; SOURCE LINE # 666
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 60  

                 R     MOV     DPTR,#B_Weight_LowBat
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0085:
                                           ; SOURCE LINE # 668
                       MOV     R7,#00H
                                           ; SOURCE LINE # 669
             ?C0086:
                       RET     
             ; FUNCTION _CS_Scale_JudgeLowBat (END)

             ; FUNCTION _CS_Scale_JudgeOverLoad (BEGIN)
                                           ; SOURCE LINE # 672
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 673
                                           ; SOURCE LINE # 677
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0087
                                           ; SOURCE LINE # 678
                                           ; SOURCE LINE # 679
                       CLR     A
                 R     MOV     DPTR,#R_Weight_OverLoadTimes
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 680
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 681
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 682
             ?C0087:
                                           ; SOURCE LINE # 684
                       SETB    C
                 R     MOV     DPTR,#R_UnitWeight+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0C4H
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       SUBB    A,#03BH
                 R     xJLT    ?C0089
                                           ; SOURCE LINE # 685
                 R     MOV     DPTR,#R_Weight_OverLoadTimes
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
             ?C0089:
                                           ; SOURCE LINE # 686
                 R     MOV     DPTR,#R_Weight_OverLoadTimes
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#02H
                 R     xJLT    ?C0090
                                           ; SOURCE LINE # 687
                                           ; SOURCE LINE # 688
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 689
                       INC     DPTR
                       DEC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 690
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 61  

                 R     MOV     DPTR,#R_Display_Err
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 691
                 R     xJMP    ?C0091
             ?C0090:
                                           ; SOURCE LINE # 693
                       CLR     A
                 R     MOV     DPTR,#B_Weight_OverLoad
                       MOVX    @DPTR,A
             ?C0091:
                                           ; SOURCE LINE # 695
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0092
                                           ; SOURCE LINE # 696
                 R     MOV     DPTR,#B_Weight_OverLoad
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0092:
                                           ; SOURCE LINE # 698
                       MOV     R7,#00H
                                           ; SOURCE LINE # 699
             ?C0088:
                       RET     
             ; FUNCTION _CS_Scale_JudgeOverLoad (END)

             ; FUNCTION _CS_Scale_SameWeightTimes (BEGIN)
                                           ; SOURCE LINE # 703
;---- Variable 'weight_temp' assigned to Register 'R4/R5' ----
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 704
                                           ; SOURCE LINE # 709
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0093
                                           ; SOURCE LINE # 710
                                           ; SOURCE LINE # 711
                       CLR     A
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 712
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 713
             ?C0093:
                                           ; SOURCE LINE # 715
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0095
                                           ; SOURCE LINE # 716
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0095:
                                           ; SOURCE LINE # 719
                 R     MOV     DPTR,#R_Weight_kg_old
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_UnitWeight
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 62  

                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R3,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R2
                       SUBB    A,R6
                 R     xJLT    ?C0096
                                           ; SOURCE LINE # 720
                 R     MOV     DPTR,#R_Weight_kg_old
                       MOVX    A,@DPTR
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     A,R3
                       SUBB    A,R7
                       MOV     R5,A
                       MOV     A,R2
                       SUBB    A,R6
                       MOV     R4,A
                 R     xJMP    ?C0097
             ?C0096:
                                           ; SOURCE LINE # 722
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_Weight_kg_old+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R5,A
                 R     MOV     DPTR,#R_Weight_kg_old
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R4,A
             ?C0097:
                                           ; SOURCE LINE # 724
                       CLR     C
                       MOV     A,R5
                       SUBB    A,#0AH
                       MOV     A,R4
                       SUBB    A,#00H
                 R     xJGE    ?C0098
                                           ; SOURCE LINE # 725
                                           ; SOURCE LINE # 726
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FFH
                 R     xJGE    ?C0100
                                           ; SOURCE LINE # 727
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 728
                 R     xJMP    ?C0100
             ?C0098:
                                           ; SOURCE LINE # 730
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 63  

                       CLR     A
                 R     MOV     DPTR,#R_Weight_SameTimes
                       MOVX    @DPTR,A
             ?C0100:
                                           ; SOURCE LINE # 732
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_Weight_kg_old
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 734
                       MOV     R7,#00H
                                           ; SOURCE LINE # 735
             ?C0094:
                       RET     
             ; FUNCTION _CS_Scale_SameWeightTimes (END)

             ; FUNCTION _CS_Scale_JudgeSteady (BEGIN)
                                           ; SOURCE LINE # 740
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 741
                                           ; SOURCE LINE # 747
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0101
                                           ; SOURCE LINE # 748
                                           ; SOURCE LINE # 749
                       CLR     A
                 R     MOV     DPTR,#B_Weight_HeavySteady
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 750
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 751
             ?C0101:
                                           ; SOURCE LINE # 753
                       MOV     A,R7
                 R     xJNE    A,#03H,?C0103
                                           ; SOURCE LINE # 754
                 R     MOV     DPTR,#B_Weight_HeavySteady
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0103:
                                           ; SOURCE LINE # 756
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_LockProc
                       MOV     A,R7
                 R     xJNZ    ?C0104
                                           ; SOURCE LINE # 757
                                           ; SOURCE LINE # 759
                 R     MOV     DPTR,#B_Weight_HeavySteady
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 760
                       CLR     C
                 R     MOV     DPTR,#R_UnitWeight+01H
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 64  

                       SUBB    A,#0FAH
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0104
                                           ; SOURCE LINE # 761
                                           ; SOURCE LINE # 762
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_SameWeightTimes
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#05H
                 R     xJLT    ?C0104
                                           ; SOURCE LINE # 763
                                           ; SOURCE LINE # 764
                 R     MOV     DPTR,#B_Weight_HeavySteady
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 766
                 R     MOV     DPTR,#R_Weight_Mem
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0107
                                           ; SOURCE LINE # 767
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                 R     MOV     DPTR,#R_Weight_Temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                 R     xJMP    ?C0108
             ?C0107:
                                           ; SOURCE LINE # 769
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_Weight_Mem+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_Mem
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 65  

                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     MOV     DPTR,#R_Weight_Temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
             ?C0108:
                                           ; SOURCE LINE # 772
                       SETB    C
                 R     MOV     DPTR,#R_UnitWeight+01H
                       MOVX    A,@DPTR
                       SUBB    A,#058H
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       SUBB    A,#02H
                 R     xJLT    ?C0109
                                           ; SOURCE LINE # 773
                                           ; SOURCE LINE # 774
                 R     MOV     DPTR,#R_Weight_Temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,#019H
                 R     MOV     DPTR,#R_Weight_Temp
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJGE    ?C0109
                                           ; SOURCE LINE # 775
                 R     MOV     DPTR,#R_Weight_Mem
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_UnitWeight
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 776
             ?C0109:
                                           ; SOURCE LINE # 778
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_Lock
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 779
                 R     MOV     DPTR,#R_Weight_Mem
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 781
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 66  

                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 782
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 783
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_SteadyProc
                                           ; SOURCE LINE # 784
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 785
                                           ; SOURCE LINE # 786
                                           ; SOURCE LINE # 787
             ?C0104:
                                           ; SOURCE LINE # 788
                       MOV     R7,#00H
                                           ; SOURCE LINE # 789
             ?C0102:
                       RET     
             ; FUNCTION _CS_Scale_JudgeSteady (END)

             ; FUNCTION _CS_Scale_SteadyProc (BEGIN)
                                           ; SOURCE LINE # 798
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 799
                                           ; SOURCE LINE # 806
                       MOV     A,R7
                 R     xJNZ    ?C0111
                                           ; SOURCE LINE # 807
                                           ; SOURCE LINE # 808
                 R     MOV     DPTR,#B_Debug_Send
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 810
             ?C0111:
                                           ; SOURCE LINE # 813
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_JudgeSteady
                 R     xJNE    R7,#01H,?C0113
                                           ; SOURCE LINE # 814
                                           ; SOURCE LINE # 816
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_JudgeSteady
                                           ; SOURCE LINE # 818
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#08H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 819
                       CLR     A
                 R     MOV     DPTR,#ReadUTC
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 820
                       RET     
             ?C0113:
                                           ; SOURCE LINE # 822
                                           ; SOURCE LINE # 831
                 R     MOV     DPTR,#B_Debug_Send
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 67  

                 R     xJNZ    ?C0115
                                           ; SOURCE LINE # 832
                                           ; SOURCE LINE # 834
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0116
                                           ; SOURCE LINE # 835
                                           ; SOURCE LINE # 836
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 837
                       MOV     R7,#082H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 838
             ?C0116:
                                           ; SOURCE LINE # 840
                 E     CALL    CS_If1186ComSucess
                       MOV     A,R7
                       XRL     A,#01H
                 R     xJNZ    ?C0112
                                           ; SOURCE LINE # 841
                                           ; SOURCE LINE # 844
                 R     MOV     DPTR,#ReadUTC
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 846
                 R     MOV     DPTR,#R_1186_RTC
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 847
                 R     MOV     DPTR,#R_1186_RTC+01H
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 848
                 R     MOV     DPTR,#R_1186_RTC+02H
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 849
                 R     MOV     DPTR,#R_1186_RTC+03H
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#SendData+05H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 850
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R2,A
                       MOV     A,R4
                       MOV     R7,A
                       MOV     A,R2
                       MOV     R6,A
                       MOV     A,R7
                 R     MOV     DPTR,#SendData
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 68  

                                           ; SOURCE LINE # 851
                       MOV     R3,#01H
                 R     MOV     R2,#HIGH SendData
                 R     MOV     R1,#LOW SendData
                 E     CALL    _QueuePush
                                           ; SOURCE LINE # 852
                 R     MOV     DPTR,#B_Debug_Send
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 854
                       MOV     R7,#080H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 858
                                           ; SOURCE LINE # 860
                       RET     
             ?C0115:
                                           ; SOURCE LINE # 862
                                           ; SOURCE LINE # 863
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_GetDeltaAD
;---- Variable 'R_AD_BUF' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 864
                       MOV     R5,AR7
                       MOV     R4,AR6
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 865
                 R     CALL    _CS_Scale_GetWeight
                                           ; SOURCE LINE # 866
                 R     CALL    CS_Scale_ReturnLock
                                           ; SOURCE LINE # 868
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       MOV     R7,A
                       INC     DPTR
                       MOVX    A,@DPTR
                 R     MOV     DPTR,#R_UnitWeight
                       XCH     A,R7
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 869
                                           ; SOURCE LINE # 870
                                           ; SOURCE LINE # 889
             ?C0112:
                       RET     
             ; FUNCTION _CS_Scale_SteadyProc (END)

             ; FUNCTION CS_Scale_ReturnLock (BEGIN)
                                           ; SOURCE LINE # 893
                                           ; SOURCE LINE # 894
                                           ; SOURCE LINE # 897
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_UnitWeight
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 69  

                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0119
                                           ; SOURCE LINE # 898
                                           ; SOURCE LINE # 899
                       MOV     A,R5
                       SUBB    A,R7
                       MOV     R7,A
                       MOV     A,R4
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 900
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0123
                                           ; SOURCE LINE # 901
                                           ; SOURCE LINE # 902
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 903
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 904
                                           ; SOURCE LINE # 905
                       RET     
             ?C0119:
                                           ; SOURCE LINE # 907
                                           ; SOURCE LINE # 908
                 R     MOV     DPTR,#R_UnitWeight
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_Weight_Lock+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_Weight_Lock
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 70  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 909
                       CLR     C
                       SUBB    A,#02CH
                       MOV     A,R6
                       SUBB    A,#01H
                 R     xJLT    ?C0123
                                           ; SOURCE LINE # 910
                                           ; SOURCE LINE # 912
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 913
                       MOV     R7,A
                 R     CALL    _CS_Scale_LockProc
                                           ; SOURCE LINE # 914
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 916
                                           ; SOURCE LINE # 917
                                           ; SOURCE LINE # 919
             ?C0123:
                       RET     
             ; FUNCTION CS_Scale_ReturnLock (END)

             ; FUNCTION _CS_MemoryWeightClear_Timer (BEGIN)
                                           ; SOURCE LINE # 925
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 926
                                           ; SOURCE LINE # 930
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0124
                                           ; SOURCE LINE # 931
                                           ; SOURCE LINE # 932
                       CLR     A
                 R     MOV     DPTR,#timecount
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 933
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 934
             ?C0124:
                                           ; SOURCE LINE # 936
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0125
                                           ; SOURCE LINE # 937
                                           ; SOURCE LINE # 938
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FFH
                 R     xJGE    ?C0125
                                           ; SOURCE LINE # 939
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 940
             ?C0125:
                                           ; SOURCE LINE # 942
                 R     MOV     DPTR,#B_Timeout
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0129
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 71  

                                           ; SOURCE LINE # 943
                                           ; SOURCE LINE # 944
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       SETB    C
                       SUBB    A,#096H
                 R     xJLT    ?C0129
                                           ; SOURCE LINE # 945
                                           ; SOURCE LINE # 946
                       INC     DPTR
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 947
                       CLR     A
                 R     MOV     DPTR,#R_Weight_Mem
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 948
                                           ; SOURCE LINE # 949
                                           ; SOURCE LINE # 950
             ?C0129:
                       RET     
             ; FUNCTION _CS_MemoryWeightClear_Timer (END)

             ; FUNCTION _CS_Scale_CaliProc (BEGIN)
                                           ; SOURCE LINE # 966
;---- Variable 'option' assigned to Register 'R5' ----
                       MOV     R5,AR7
                                           ; SOURCE LINE # 967
                                           ; SOURCE LINE # 979
                       MOV     A,R5
                 R     xJNE    A,#05H,?C0130
                                           ; SOURCE LINE # 980
                                           ; SOURCE LINE # 981
                       CLR     A
                 R     MOV     DPTR,#R_CaliState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 982
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 983
             ?C0130:
                                           ; SOURCE LINE # 984
                       MOV     A,R5
                       XRL     A,#01H
                 R     xJNZ    ?C0132
                                           ; SOURCE LINE # 985
                                           ; SOURCE LINE # 1014
                       MOV     DPTR,#04C08H
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       CLR     A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1015
                       MOVX    A,@DPTR
                       MOV     R6,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 72  

                       MOV     DPTR,#04C09H
                       MOVX    A,@DPTR
                       MOV     R3,A
                       MOV     A,R6
                       MOV     A,R3
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1016
                       MOV     DPTR,#04C0AH
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       CLR     A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1017
                       MOVX    A,@DPTR
                       MOV     R6,A
                       MOV     DPTR,#04C0BH
                       MOVX    A,@DPTR
                       MOV     R3,A
                       MOV     A,R6
                       MOV     A,R3
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1018
                       MOV     DPTR,#04C0CH
                       MOVX    A,@DPTR
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       CLR     A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1019
                       MOVX    A,@DPTR
                       MOV     R6,A
                       MOV     DPTR,#04C0DH
                       MOVX    A,@DPTR
                       MOV     R3,A
                       MOV     A,R6
                       MOV     A,R3
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 73  

                                           ; SOURCE LINE # 1023
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0134
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#070H
                       MOV     A,R6
                       SUBB    A,#017H
                 R     xJLT    ?C0133
             ?C0134:
                                           ; SOURCE LINE # 1024
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0136
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#070H
                       MOV     A,R6
                       SUBB    A,#017H
                 R     xJLT    ?C0133
             ?C0136:
                                           ; SOURCE LINE # 1025
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                       SUBB    A,#0E8H
                       MOV     A,R6
                       SUBB    A,#03H
                 R     xJLT    ?C0138
                       SETB    C
                       MOV     A,R7
                       SUBB    A,#070H
                       MOV     A,R6
                       SUBB    A,#017H
                 R     xJLT    ?C0133
             ?C0138:
                                           ; SOURCE LINE # 1026
                                           ; SOURCE LINE # 1027
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOV     A,#017H
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 74  

                       INC     DPTR
                       MOV     A,#070H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1028
                       INC     DPTR
                       MOV     A,#013H
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#088H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1029
                       INC     DPTR
                       MOV     A,#0FH
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,#0A0H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1030
             ?C0133:
                                           ; SOURCE LINE # 1033
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#00H
                       MOV     R5,#0AH
                 E     CALL    ?C?UIDIV
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1034
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 1035
             ?C0132:
                                           ; SOURCE LINE # 1036
                       MOV     A,R5
                 R     xJNE    A,#06H,?C0139
                                           ; SOURCE LINE # 1037
                                           ; SOURCE LINE # 1038
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       MOV     R4,#00H
                       MOV     R5,#0AH
                 E     CALL    ?C?UIDIV
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 75  

                                           ; SOURCE LINE # 1039
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                       RET     
                                           ; SOURCE LINE # 1040
             ?C0139:
                                           ; SOURCE LINE # 1042
                       MOV     A,R5
                 R     xJNE    A,#07H,?C0140
                                           ; SOURCE LINE # 1043
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0140:
                                           ; SOURCE LINE # 1044
                       MOV     A,R5
                 R     xJNE    A,#02H,?C0141
                                           ; SOURCE LINE # 1045
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0141:
                                           ; SOURCE LINE # 1046
                       MOV     A,R5
                 R     xJNE    A,#03H,?C0142
                                           ; SOURCE LINE # 1047
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0142:
                                           ; SOURCE LINE # 1048
                       MOV     A,R5
                 R     xJNE    A,#04H,?C0143
                                           ; SOURCE LINE # 1049
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0143:
                                           ; SOURCE LINE # 1051
                 R     MOV     DPTR,#R_AD_Original
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 76  

                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
                                           ; SOURCE LINE # 1052
                       CLR     A
                       MOV     R7,A
                 R     CALL    _CS_Scale_AdcFilter
                 R     MOV     DPTR,#R_AD_BUF
                       MOV     A,R6
                       MOVX    @DPTR,A
                       MOV     R4,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                       MOV     R5,A
                                           ; SOURCE LINE # 1053
                       MOV     R7,#02H
                 R     CALL    _CS_Scale_AdcFilter
                 R     MOV     DPTR,#R_AdFilTimes
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1059
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0144
                                           ; SOURCE LINE # 1060
                                           ; SOURCE LINE # 1062
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOV     A,R4
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R5
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1063
                       CLR     C
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0145
                                           ; SOURCE LINE # 1064
                                           ; SOURCE LINE # 1065
                       MOV     R7,#05H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 1066
                 R     MOV     DPTR,#R_AD_BUF
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 77  

                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1067
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1068
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1069
             ?C0145:
                                           ; SOURCE LINE # 1070
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1071
             ?C0144:
                                           ; SOURCE LINE # 1073
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0146
                                           ; SOURCE LINE # 1074
                                           ; SOURCE LINE # 1075
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0147
                                           ; SOURCE LINE # 1076
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#02H
                       MOVX    @DPTR,A
             ?C0147:
                                           ; SOURCE LINE # 1077
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#081H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1078
             ?C0146:
                                           ; SOURCE LINE # 1080
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#02H
                 R     xJNZ    ?C0148
                                           ; SOURCE LINE # 1081
                                           ; SOURCE LINE # 1082
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 78  

                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1083
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1085
                       SETB    C
                 R     MOV     DPTR,#R_OpenWeight_Ad+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0150
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0149
             ?C0150:
                                           ; SOURCE LINE # 1086
                                           ; SOURCE LINE # 1087
                       CLR     C
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0151
                                           ; SOURCE LINE # 1088
                                           ; SOURCE LINE # 1089
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 79  

                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#05H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 1090
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1091
             ?C0151:
                                           ; SOURCE LINE # 1092
                       CLR     A
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1093
                 R     xJMP    ?C0152
             ?C0149:
                                           ; SOURCE LINE # 1095
                                           ; SOURCE LINE # 1096
                       SETB    C
                 R     MOV     DPTR,#R_AD_CaliDot1+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0EEH
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       SUBB    A,#02H
                 R     xJLT    ?C0152
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0152
                                           ; SOURCE LINE # 1097
                                           ; SOURCE LINE # 1098
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1099
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1100
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1101
                                           ; SOURCE LINE # 1102
             ?C0152:
                                           ; SOURCE LINE # 1103
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 80  

                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1105
             ?C0148:
                                           ; SOURCE LINE # 1107
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#03H,?C0154
                                           ; SOURCE LINE # 1108
                                           ; SOURCE LINE # 1109
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0155
                                           ; SOURCE LINE # 1110
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#04H
                       MOVX    @DPTR,A
             ?C0155:
                                           ; SOURCE LINE # 1111
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#082H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1112
             ?C0154:
                                           ; SOURCE LINE # 1114
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#04H
                 R     xJNZ    ?C0156
                                           ; SOURCE LINE # 1115
                                           ; SOURCE LINE # 1116
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1117
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 81  

                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1119
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJGE    ?C0158
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0157
             ?C0158:
                                           ; SOURCE LINE # 1120
                                           ; SOURCE LINE # 1121
                       CLR     A
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1122
                 R     xJMP    ?C0159
             ?C0157:
                                           ; SOURCE LINE # 1124
                                           ; SOURCE LINE # 1125
                       CLR     C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,R5
                       MOV     R7,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,R4
                       MOV     R6,A
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1127
                       SETB    C
                       SUBB    A,#0EEH
                       MOV     A,R6
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 82  

                       SUBB    A,#02H
                 R     xJLT    ?C0159
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0159
                                           ; SOURCE LINE # 1128
                                           ; SOURCE LINE # 1129
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_AdcFilter
                                           ; SOURCE LINE # 1130
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1131
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#05H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1132
                                           ; SOURCE LINE # 1133
             ?C0159:
                                           ; SOURCE LINE # 1134
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1135
             ?C0156:
                                           ; SOURCE LINE # 1137
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#05H,?C0161
                                           ; SOURCE LINE # 1138
                                           ; SOURCE LINE # 1139
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0162
                                           ; SOURCE LINE # 1140
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#06H
                       MOVX    @DPTR,A
             ?C0162:
                                           ; SOURCE LINE # 1141
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#083H
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 83  

                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1142
             ?C0161:
                                           ; SOURCE LINE # 1144
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#06H
                 R     xJNZ    ?C0163
                                           ; SOURCE LINE # 1145
                                           ; SOURCE LINE # 1146
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1147
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                       MOV     R7,A
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                       MOV     R6,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1149
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJGE    ?C0165
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R6,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R7,A
                       CLR     C
                 R     MOV     DPTR,#R_AD_BUF+01H
                       MOVX    A,@DPTR
                       SUBB    A,R7
                 R     MOV     DPTR,#R_AD_BUF
                       MOVX    A,@DPTR
                       SUBB    A,R6
                 R     xJGE    ?C0164
             ?C0165:
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 84  

                                           ; SOURCE LINE # 1150
                                           ; SOURCE LINE # 1151
                       CLR     A
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1152
                 R     xJMP    ?C0166
             ?C0164:
                                           ; SOURCE LINE # 1154
                                           ; SOURCE LINE # 1155
                       CLR     C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,R5
                       MOV     R7,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,R4
                       MOV     R6,A
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1157
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       SETB    C
                       SUBB    A,R7
                       MOV     A,R4
                       SUBB    A,R6
                 R     xJLT    ?C0167
                                           ; SOURCE LINE # 1158
                                           ; SOURCE LINE # 1159
                       CLR     A
                       INC     DPTR
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1161
                 R     xJMP    ?C0166
             ?C0167:
                                           ; SOURCE LINE # 1163
                                           ; SOURCE LINE # 1164
                       CLR     C
                 R     MOV     DPTR,#weight_temp+01H
                       MOVX    A,@DPTR
                       SUBB    A,R5
                       MOV     R7,A
                 R     MOV     DPTR,#weight_temp
                       MOVX    A,@DPTR
                       SUBB    A,R4
                       MOV     R6,A
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 85  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1166
                       SETB    C
                       SUBB    A,#0EEH
                       MOV     A,R6
                       SUBB    A,#02H
                 R     xJLT    ?C0166
                 R     MOV     DPTR,#R_AdFilTimes+01H
                       MOVX    A,@DPTR
                       SUBB    A,#0CH
                 R     MOV     DPTR,#R_AdFilTimes
                       MOVX    A,@DPTR
                       SUBB    A,#00H
                 R     xJLT    ?C0166
                                           ; SOURCE LINE # 1167
                                           ; SOURCE LINE # 1168
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1169
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#07H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1170
                                           ; SOURCE LINE # 1171
                                           ; SOURCE LINE # 1172
             ?C0166:
                                           ; SOURCE LINE # 1173
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1174
             ?C0163:
                                           ; SOURCE LINE # 1176
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                 R     xJNE    A,#07H,?C0170
                                           ; SOURCE LINE # 1177
                                           ; SOURCE LINE # 1178
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0171
                                           ; SOURCE LINE # 1179
                 R     MOV     DPTR,#R_CaliState
                       MOV     A,#08H
                       MOVX    @DPTR,A
             ?C0171:
                                           ; SOURCE LINE # 1180
                       CLR     A
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#084H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1181
             ?C0170:
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 86  

                                           ; SOURCE LINE # 1183
                 R     MOV     DPTR,#R_CaliState
                       MOVX    A,@DPTR
                       XRL     A,#08H
                 R     xJNZ    ?C0172
                                           ; SOURCE LINE # 1184
                                           ; SOURCE LINE # 1186
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,A
                 R     CALL    _CS_Scale_ZeroProc
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1187
                 R     MOV     DPTR,#R_AD_PowerOnZero
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_ZeroProc
                                           ; SOURCE LINE # 1188
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1189
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       MOV     R2,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R4,#00H
                       MOV     R5,#0AH
                       MOV     R7,A
                       MOV     R6,AR2
                 E     CALL    ?C?UIDIV
                 R     MOV     DPTR,#R_OpenWeight_Ad
                       MOV     A,R6
                       MOVX    @DPTR,A
                       INC     DPTR
                       MOV     A,R7
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1197
                       MOV     A,R2
                       MOV     DPTR,#04C08H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1198
                 R     MOV     DPTR,#R_AD_CaliDot1
                       MOVX    A,@DPTR
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     DPTR,#04C09H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1199
                 R     MOV     DPTR,#R_AD_CaliDot2
                       MOVX    A,@DPTR
                       MOV     R4,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 87  

                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     A,R4
                       MOV     DPTR,#04C0AH
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1200
                       MOV     A,R5
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1201
                 R     MOV     DPTR,#R_AD_CaliDot3
                       MOVX    A,@DPTR
                       MOV     R4,A
                       INC     DPTR
                       MOVX    A,@DPTR
                       MOV     R5,A
                       MOV     A,R4
                       MOV     DPTR,#04C0CH
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1202
                       MOV     A,R5
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1203
                       MOV     R7,#041H
                 E     CALL    _SpiFlashOperator
                                           ; SOURCE LINE # 1207
             ?C0172:
                                           ; SOURCE LINE # 1208
                       CLR     A
                       MOV     R6,A
                       MOV     R7,A
                                           ; SOURCE LINE # 1210
             ?C0131:
                       RET     
             ; FUNCTION _CS_Scale_CaliProc (END)

             ; FUNCTION _CS_Scale_StandbyProc (BEGIN)
                                           ; SOURCE LINE # 1222
;---- Variable 'B_Reset' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1223
                                           ; SOURCE LINE # 1227
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0173
                                           ; SOURCE LINE # 1228
                                           ; SOURCE LINE # 1229
                       CLR     A
                 R     MOV     DPTR,#StandbyState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1230
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 1232
             ?C0173:
                                           ; SOURCE LINE # 1234
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0175
                                           ; SOURCE LINE # 1235
                                           ; SOURCE LINE # 1236
                 R     MOV     DPTR,#StandbyState
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 88  

                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1237
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 1239
             ?C0175:
                                           ; SOURCE LINE # 1241
                 R     MOV     DPTR,#StandbyState
                       MOVX    A,@DPTR
                       DEC     A
                 R     xJZ     ?C0180
                       INC     A
                 R     xJNZ    ?C0183
                                           ; SOURCE LINE # 1242
                                           ; SOURCE LINE # 1243
             ?C0177:
                                           ; SOURCE LINE # 1244
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0178
                                           ; SOURCE LINE # 1245
                                           ; SOURCE LINE # 1246
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1248
                       MOV     R7,#0A0H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1250
             ?C0178:
                                           ; SOURCE LINE # 1251
                 E     CALL    CS_If1186ComSucess
                       MOV     A,R7
                       XRL     A,#01H
                 R     xJNZ    ?C0174
                                           ; SOURCE LINE # 1252
                                           ; SOURCE LINE # 1253
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1254
                       INC     DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1256
                 E     MOV     DPTR,#btCmdBuf
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1257
                       INC     DPTR
                       MOV     A,#020H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1258
                       MOV     R3,#01H
                 E     MOV     R2,#HIGH btCmdBuf
                 E     MOV     R1,#LOW btCmdBuf
                 E     CALL    _BT_CmdFifoIn
                                           ; SOURCE LINE # 1266
                 E     MOV     DPTR,#sys_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1268
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 89  

                                           ; SOURCE LINE # 1269
                       RET     
                                           ; SOURCE LINE # 1270
             ?C0180:
                                           ; SOURCE LINE # 1271
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0181
                                           ; SOURCE LINE # 1272
                                           ; SOURCE LINE # 1273
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1274
                       MOV     R7,#085H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1275
             ?C0181:
                                           ; SOURCE LINE # 1276
                 E     CALL    CS_If1186ComSucess
                 R     xJNE    R7,#01H,?C0174
                                           ; SOURCE LINE # 1277
                                           ; SOURCE LINE # 1278
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1279
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1280
                 E     MOV     DPTR,#sys_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1290
                       MOV     R7,A
                 R     CALL    _CS_Scale_JudgeOverLoad
                                           ; SOURCE LINE # 1291
                       MOV     R7,#06H
                 R     CALL    _CS_Scale_TimeOutProc
                                           ; SOURCE LINE # 1292
                       CLR     A
                 R     MOV     DPTR,#R_Display_Err
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1294
                 R     MOV     DPTR,#R_Scale_state
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1296
                       MOV     R7,#080H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1298
                                           ; SOURCE LINE # 1299
                       RET     
                                           ; SOURCE LINE # 1300
             ?C0183:
                                           ; SOURCE LINE # 1301
                       CLR     A
                 R     MOV     DPTR,#StandbyState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1302
                                           ; SOURCE LINE # 1303
                                           ; SOURCE LINE # 1307
             ?C0174:
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 90  

                       RET     
             ; FUNCTION _CS_Scale_StandbyProc (END)

             ; FUNCTION CS_Scale_PowerOnProc (BEGIN)
                                           ; SOURCE LINE # 1321
                                           ; SOURCE LINE # 1322
                                           ; SOURCE LINE # 1327
                 R     xJNB    B_Reset,?C0184
                                           ; SOURCE LINE # 1328
                                           ; SOURCE LINE # 1329
                       CLR     A
                 R     MOV     DPTR,#PowerOnState
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1330
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                       RET     
                                           ; SOURCE LINE # 1332
             ?C0184:
                                           ; SOURCE LINE # 1335
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0186
                                           ; SOURCE LINE # 1336
                                           ; SOURCE LINE # 1337
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0187
                                           ; SOURCE LINE # 1338
                                           ; SOURCE LINE # 1339
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1340
                       MOV     R7,#0C5H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1341
                 R     xJMP    ?C0186
             ?C0187:
                                           ; SOURCE LINE # 1343
                                           ; SOURCE LINE # 1344
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1345
                       INC     DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1346
                                           ; SOURCE LINE # 1347
             ?C0186:
                                           ; SOURCE LINE # 1349
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#01H,?C0189
                                           ; SOURCE LINE # 1350
                                           ; SOURCE LINE # 1351
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0190
                                           ; SOURCE LINE # 1352
                                           ; SOURCE LINE # 1353
                       INC     A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 91  

                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1354
                       MOV     R7,#084H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1356
             ?C0190:
                                           ; SOURCE LINE # 1357
                 E     CALL    CS_If1186ComSucess
                 R     xJNE    R7,#01H,?C0189
                                           ; SOURCE LINE # 1358
                                           ; SOURCE LINE # 1359
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1360
                       INC     DPTR
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1361
                                           ; SOURCE LINE # 1362
             ?C0189:
                                           ; SOURCE LINE # 1364
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#02H,?C0192
                                           ; SOURCE LINE # 1365
                                           ; SOURCE LINE # 1366
                       MOV     A,#03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1367
             ?C0192:
                                           ; SOURCE LINE # 1369
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#03H,?C0193
                                           ; SOURCE LINE # 1370
                                           ; SOURCE LINE # 1371
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0194
                                           ; SOURCE LINE # 1372
                                           ; SOURCE LINE # 1373
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1374
                       MOV     R7,#082H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1375
             ?C0194:
                                           ; SOURCE LINE # 1376
                 E     CALL    CS_If1186ComSucess
                 R     xJNE    R7,#01H,?C0193
                                           ; SOURCE LINE # 1377
                                           ; SOURCE LINE # 1378
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1379
                       INC     DPTR
                       MOV     A,#04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1380
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 92  

                                           ; SOURCE LINE # 1381
             ?C0193:
                                           ; SOURCE LINE # 1383
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#04H,?C0196
                                           ; SOURCE LINE # 1384
                                           ; SOURCE LINE # 1385
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0197
                                           ; SOURCE LINE # 1386
                                           ; SOURCE LINE # 1387
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1388
                       MOV     R7,#0A1H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1389
             ?C0197:
                                           ; SOURCE LINE # 1390
                 E     CALL    CS_If1186ComSucess
                 R     xJNE    R7,#01H,?C0196
                                           ; SOURCE LINE # 1391
                                           ; SOURCE LINE # 1392
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1393
                       INC     DPTR
                       MOV     A,#05H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1394
                                           ; SOURCE LINE # 1395
             ?C0196:
                                           ; SOURCE LINE # 1397
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                       XRL     A,#05H
                 R     xJNZ    ?C0199
                                           ; SOURCE LINE # 1398
                                           ; SOURCE LINE # 1399
                 R     MOV     DPTR,#comm_doing
                       MOVX    A,@DPTR
                 R     xJNZ    ?C0200
                                           ; SOURCE LINE # 1400
                                           ; SOURCE LINE # 1401
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1402
                       MOV     R5,#0B8H
                       MOV     R4,#022H
                       MOV     R7,#021H
                 E     CALL    _CS_ScaleDisplay_FreshBuf
                                           ; SOURCE LINE # 1403
                       MOV     R7,#0E0H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1404
             ?C0200:
                                           ; SOURCE LINE # 1405
                 E     CALL    CS_If1186ComSucess
                 R     xJNE    R7,#01H,?C0199
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 93  

                                           ; SOURCE LINE # 1406
                                           ; SOURCE LINE # 1407
                       CLR     A
                 R     MOV     DPTR,#comm_doing
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1408
                       INC     DPTR
                       MOV     A,#06H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1409
                       MOV     R7,#02H
                 R     CALL    _CS_SoftTimer
                                           ; SOURCE LINE # 1410
                                           ; SOURCE LINE # 1411
             ?C0199:
                                           ; SOURCE LINE # 1413
                 R     MOV     DPTR,#PowerOnState
                       MOVX    A,@DPTR
                 R     xJNE    A,#06H,?C0185
                                           ; SOURCE LINE # 1414
                                           ; SOURCE LINE # 1415
                       MOV     R7,#01H
                 R     CALL    _CS_SoftTimer
                       MOV     A,R7
                       SETB    C
                       SUBB    A,#0C8H
                 R     xJLT    ?C0185
                                           ; SOURCE LINE # 1416
                                           ; SOURCE LINE # 1417
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1418
                       MOV     R7,#080H
                 E     CALL    _CS_Scale_1186ComSend
                                           ; SOURCE LINE # 1419
                                           ; SOURCE LINE # 1420
                                           ; SOURCE LINE # 1422
             ?C0185:
                       RET     
             ; FUNCTION CS_Scale_PowerOnProc (END)

             ; FUNCTION _CS_SoftTimer (BEGIN)
                                           ; SOURCE LINE # 1427
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1428
                                           ; SOURCE LINE # 1432
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0204
                                           ; SOURCE LINE # 1433
                                           ; SOURCE LINE # 1434
                       CLR     A
                 R     MOV     DPTR,#timecount
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1435
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1436
             ?C0204:
                                           ; SOURCE LINE # 1438
                       MOV     A,R7
                 R     xJNE    A,#01H,?C0205
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 94  

                                           ; SOURCE LINE # 1439
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0205:
                                           ; SOURCE LINE # 1441
                       MOV     A,R7
                 R     xJNZ    ?C0207
                                           ; SOURCE LINE # 1442
                                           ; SOURCE LINE # 1443
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FFH
                 R     xJGE    ?C0207
                                           ; SOURCE LINE # 1444
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1445
             ?C0207:
                                           ; SOURCE LINE # 1448
                 R     MOV     DPTR,#timecount
                       MOVX    A,@DPTR
                       SETB    C
                       SUBB    A,#096H
                 R     xJLT    ?C0209
                                           ; SOURCE LINE # 1449
                       INC     DPTR
                       MOV     A,#01H
                       MOVX    @DPTR,A
             ?C0209:
                                           ; SOURCE LINE # 1451
                       MOV     A,R7
                 R     xJNE    A,#03H,?C0210
                                           ; SOURCE LINE # 1452
                 R     MOV     DPTR,#B_Timeout
                       MOVX    A,@DPTR
                       MOV     R7,A
                       RET     
             ?C0210:
                                           ; SOURCE LINE # 1454
                       MOV     R7,#00H
                                           ; SOURCE LINE # 1456
             ?C0206:
                       RET     
             ; FUNCTION _CS_SoftTimer (END)

             ; FUNCTION _CS_Scale_TimeOutProc (BEGIN)
                                           ; SOURCE LINE # 1474
;---- Variable 'option' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 1475
                                           ; SOURCE LINE # 1479
                       MOV     A,R7
                 R     xJNE    A,#07H,?C0211
                                           ; SOURCE LINE # 1480
                                           ; SOURCE LINE # 1481
                 R     MOV     DPTR,#B_TimeBase_1s
                       MOV     A,#01H
                       MOVX    @DPTR,A
                       RET     
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 95  

                                           ; SOURCE LINE # 1483
             ?C0211:
                                           ; SOURCE LINE # 1485
                       MOV     A,R7
                 R     xJZ     ?C0213
                                           ; SOURCE LINE # 1486
                                           ; SOURCE LINE # 1487
                 R     xJNE    A,#01H,?C0214
                                           ; SOURCE LINE # 1488
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
             ?C0214:
                                           ; SOURCE LINE # 1489
                       MOV     A,R7
                 R     xJNE    A,#02H,?C0215
                                           ; SOURCE LINE # 1490
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+01H
                       MOVX    @DPTR,A
             ?C0215:
                                           ; SOURCE LINE # 1491
                       MOV     A,R7
                 R     xJNE    A,#03H,?C0216
                                           ; SOURCE LINE # 1492
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
             ?C0216:
                                           ; SOURCE LINE # 1493
                       MOV     A,R7
                 R     xJNE    A,#04H,?C0217
                                           ; SOURCE LINE # 1494
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+03H
                       MOVX    @DPTR,A
             ?C0217:
                                           ; SOURCE LINE # 1495
                       MOV     A,R7
                 R     xJNE    A,#05H,?C0218
                                           ; SOURCE LINE # 1496
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+04H
                       MOVX    @DPTR,A
             ?C0218:
                                           ; SOURCE LINE # 1497
                       MOV     A,R7
                       XRL     A,#06H
                 R     xJNZ    ?C0212
                                           ; SOURCE LINE # 1498
                                           ; SOURCE LINE # 1499
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1500
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1501
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1502
                       INC     DPTR
                       MOVX    @DPTR,A
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 96  

                                           ; SOURCE LINE # 1503
                       INC     DPTR
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1504
                       RET     
                                           ; SOURCE LINE # 1506
             ?C0213:
                                           ; SOURCE LINE # 1508
                 R     MOV     DPTR,#B_TimeBase_1s
                       MOVX    A,@DPTR
                       XRL     A,#01H
                 R     xJNZ    ?C0212
                                           ; SOURCE LINE # 1509
                                           ; SOURCE LINE # 1510
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1514
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_JudgeLowBat
                 R     xJNE    R7,#01H,?C0221
                                           ; SOURCE LINE # 1515
                                           ; SOURCE LINE # 1516
                 R     MOV     DPTR,#R_TimeOut+04H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1518
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#03H
                 R     xJLT    ?C0212
                                           ; SOURCE LINE # 1519
                                           ; SOURCE LINE # 1520
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1521
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1522
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+04H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1523
                       RET     
                                           ; SOURCE LINE # 1525
             ?C0221:
                                           ; SOURCE LINE # 1528
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_JudgeOverLoad
                 R     xJNE    R7,#01H,?C0223
                                           ; SOURCE LINE # 1529
                                           ; SOURCE LINE # 1530
                 R     MOV     DPTR,#R_TimeOut+03H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1532
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#03H
                 R     xJLT    ?C0212
                                           ; SOURCE LINE # 1533
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 97  

                                           ; SOURCE LINE # 1534
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1535
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1536
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+03H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1537
                       RET     
                                           ; SOURCE LINE # 1540
             ?C0223:
                                           ; SOURCE LINE # 1544
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                       XRL     A,#01H
                 R     xJNZ    ?C0225
                                           ; SOURCE LINE # 1545
                                           ; SOURCE LINE # 1547
                       MOV     R5,A
                       MOV     R4,A
                       MOV     R7,#03H
                 R     CALL    _CS_Scale_ZeroProc
                       MOV     A,R7
                       XRL     A,#01H
                       ORL     A,R6
                 R     xJNZ    ?C0226
                                           ; SOURCE LINE # 1548
                                           ; SOURCE LINE # 1549
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1550
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1551
                 R     xJMP    ?C0227
             ?C0226:
                                           ; SOURCE LINE # 1553
                                           ; SOURCE LINE # 1554
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1555
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1556
             ?C0227:
                                           ; SOURCE LINE # 1558
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FH
                 R     xJGE    ?C0229
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    A,@DPTR
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 98  

                       CLR     C
                       SUBB    A,#0FH
                 R     xJLT    ?C0212
             ?C0229:
                                           ; SOURCE LINE # 1559
                                           ; SOURCE LINE # 1564
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1565
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1566
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1567
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1568
                       RET     
                                           ; SOURCE LINE # 1571
             ?C0225:
                                           ; SOURCE LINE # 1575
                 R     MOV     DPTR,#R_Scale_state
                       MOVX    A,@DPTR
                 R     xJNE    A,#04H,?C0212
                                           ; SOURCE LINE # 1576
                                           ; SOURCE LINE # 1577
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1578
                 R     MOV     DPTR,#R_TimeOut+01H
                       MOVX    A,@DPTR
                       INC     A
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1580
                       MOVX    A,@DPTR
                       CLR     C
                       SUBB    A,#0FH
                 R     xJLT    ?C0212
                                           ; SOURCE LINE # 1581
                                           ; SOURCE LINE # 1583
                 R     MOV     DPTR,#R_Scale_state
                       MOV     A,#02H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1584
                       MOV     R7,#01H
                 R     CALL    _CS_Scale_StandbyProc
                                           ; SOURCE LINE # 1585
                       CLR     A
                 R     MOV     DPTR,#R_TimeOut+01H
                       MOVX    @DPTR,A
                                           ; SOURCE LINE # 1586
                                           ; SOURCE LINE # 1588
                                           ; SOURCE LINE # 1591
                                           ; SOURCE LINE # 1593
             ?C0212:
                       RET     
             ; FUNCTION _CS_Scale_TimeOutProc (END)

C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 99  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


s8_t . . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
_CS_Scale_JudgeLowBat. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  B_Weight_LowBat. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001FH  1
u8_t . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
UART_CardProtcol . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
YC_UARTPARAM_t . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  15
  uartCtrl . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  pRxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0001H  3
  pTxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0004H  3
  rxBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0007H  2
  txBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0009H  2
  baud . . . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   000BH  4
pxdbyte. . . . . . . . . . . . . . . .  TYPEDEF  DATA   PTR      -----  2
YC_LedBlink. . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  6
  active_state . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  gpio_num . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  light_time . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  dark_time. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
R_Weight_Lock. . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    003FH  2
btCmdBuf . . . . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  25
pdbyte . . . . . . . . . . . . . . . .  TYPEDEF  -----  PTR      -----  1
B_Debug_Test . . . . . . . . . . . . .  PUBLIC   DATA   BIT      0000H  1
CS_Scale_PowerOn . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
UART_HalfDuplex. . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
CS_If1186ComSucess . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CS_Weight_T. . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  10
  origin . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  kg . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  lb . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
  st . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0006H  2
  jin. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0008H  2
R_Display_Err. . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0041H  1
DFIFO0 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0094H  1
_CS_SoftTimer. . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  timecount. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0037H  1
  B_Timeout. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0038H  1
DFIFO1 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0095H  1
UART_Parity. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
dbyte. . . . . . . . . . . . . . . . .  TYPEDEF  DATA   U_CHAR   -----  1
DFIFO2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0096H  1
CS_ComState. . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  3
  now. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  pre. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  sucess . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
R_Weight_Mem . . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    0042H  2
pxbyte . . . . . . . . . . . . . . . .  TYPEDEF  -----  PTR      -----  2
ibyte. . . . . . . . . . . . . . . . .  TYPEDEF  IDATA  U_CHAR   -----  1
BT_EVENTFIFO . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
YC_UtilTimer . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  61
  timer_flages . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  callback . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
  timer_end. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0019H  32
  last_timer . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0039H  4
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 100 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


R_Weight_Com_Coo . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  3
R_Scale_state. . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0044H  1
_CS_Scale_JudgeSteady. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  R_Weight_Temp. . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  B_Weight_HeavySteady . . . . . . . .  STATIC   XDATA  U_CHAR   0025H  1
_CS_Scale_TimeOutProc. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  R_TimeOut. . . . . . . . . . . . . .  STATIC   XDATA  STRUCT   0039H  5
  B_TimeBase_1s. . . . . . . . . . . .  STATIC   XDATA  U_CHAR   003EH  1
CS_Scale_PowerOnProc . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  B_Reset. . . . . . . . . . . . . . .  AUTO     DATA   BIT      0000H  1
  comm_doing . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0035H  1
  PowerOnState . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0036H  1
_QueuePush . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
s32_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
YC_UARTPARAM . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  15
  uartCtrl . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  pRxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0001H  3
  pTxBuff. . . . . . . . . . . . . . .  MEMBER   -----  PTR      0004H  3
  rxBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0007H  2
  txBuffLen. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0009H  2
  baud . . . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   000BH  4
bool . . . . . . . . . . . . . . . . .  TYPEDEF  DATA   BIT      -----  1
CS_Scale_ChangeUnit. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
u32_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
s16_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
xbyte. . . . . . . . . . . . . . . . .  TYPEDEF  XDATA  U_CHAR   -----  1
_CS_MemoryWeightClear_Timer. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  timecount. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0028H  1
  B_Timeout. . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0029H  1
u16_t. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
dint . . . . . . . . . . . . . . . . .  TYPEDEF  DATA   U_INT    -----  2
_CS_Scale_StandbyProc. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  B_Reset. . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  comm_doing . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0033H  1
  StandbyState . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0034H  1
R_Selet_Unit . . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0045H  1
R_Debug_temp . . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    0046H  2
_CS_Scale_AdcFilter. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0001H  2
  ad_temp. . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0003H  4
  R_AD_FilTimes. . . . . . . . . . . .  STATIC   XDATA  U_INT    0001H  2
  R_AD_BUF_OLD . . . . . . . . . . . .  STATIC   XDATA  U_INT    0003H  2
  R_AD_F1. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0005H  2
  R_AD_F2. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0007H  2
  R_AD_F3. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0009H  2
  R_AD_F4. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    000BH  2
  R_AD_F5. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    000DH  2
  R_AD_F6. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    000FH  2
  R_AD_F7. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0011H  2
  R_AD_F8. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0013H  2
byte . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
DeviceInfo_t . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  10
  registerFlag . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 101 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  bindFlag . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  loginFlag. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  userNum. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  deviceID . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0004H  6
_CS_ScaleDisplay_FreshBuf. . . . . . .  EXTERN   CODE   PROC     -----  -----
YC_UartCTRLBit_e . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
UART_DataLen . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_CS_Scale_SameWeightTimes. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  weight_temp. . . . . . . . . . . . .  * REG *  DATA   U_INT    0004H  2
  R_Weight_kg_old. . . . . . . . . . .  STATIC   XDATA  U_INT    0022H  2
  R_Weight_SameTimes . . . . . . . . .  STATIC   XDATA  U_CHAR   0024H  1
CS_ScaleDisplay. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_CS_Scale_1186ComSend. . . . . . . . .  EXTERN   CODE   PROC     -----  -----
R_UnitWeight . . . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0048H  10
uint . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
CS_Scale_WeightProc. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  R_AD_BUF . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
BT_CMDFIFO_t . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
_CS_Scale_SteadyProc . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  R_AD_BUF . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
  B_Debug_Send . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0026H  1
  ReadUTC. . . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0027H  1
  SendData . . . . . . . . . . . . . .  AUTO     XDATA  STRUCT   0000H  6
UART_BaudSet . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_BT_CmdFifoIn. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
R_1186_RTC . . . . . . . . . . . . . .  PUBLIC   XDATA  ARRAY    0052H  4
B_Weight_AdOk. . . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0056H  1
_CS_Scale_GetWeight. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  ad_temp. . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0002H  4
  ad_cal . . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0006H  2
  CaliDot1 . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0008H  2
  CaliDot2 . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    000AH  2
  CaliDot3 . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    000CH  2
CS_Scale_ReturnLock. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  weight_temp. . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
R_AD_Original. . . . . . . . . . . . .  PUBLIC   XDATA  U_INT    0057H  2
_CS_Scale_CaliProc . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
  R_AD_CaliDot1. . . . . . . . . . . .  STATIC   XDATA  U_INT    002AH  2
  R_AD_CaliDot2. . . . . . . . . . . .  STATIC   XDATA  U_INT    002CH  2
  R_AD_CaliDot3. . . . . . . . . . . .  STATIC   XDATA  U_INT    002EH  2
  R_CaliState. . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0030H  1
  R_OpenWeight_Ad. . . . . . . . . . .  STATIC   XDATA  U_INT    0031H  2
  R_AdFilTimes . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  weight_temp. . . . . . . . . . . . .  AUTO     XDATA  U_INT    0002H  2
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0004H  2
  R_AD_PowerOnZero . . . . . . . . . .  AUTO     XDATA  U_INT    0006H  2
_CS_TimeOut_T. . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  5
  zero . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  lock . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  unstable . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  overload . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 102 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  lowbat . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
_CS_Scale_JudgeOverLoad. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  R_Weight_OverLoadTimes . . . . . . .  STATIC   XDATA  U_CHAR   0020H  1
  B_Weight_OverLoad. . . . . . . . . .  STATIC   XDATA  U_CHAR   0021H  1
_CS_Scale_GetDeltaAD . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  B_Weight_Pos . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0000H  1
  ad_temp. . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0001H  2
  R_AD_Zero. . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
CS_Scale_Proc. . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
YC_LedBlink_t. . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  6
  active_state . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  gpio_num . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  light_time . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  dark_time. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
_CS_Scale_LockProc . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  B_Weight_Downing_Lock. . . . . . . .  STATIC   XDATA  U_CHAR   001EH  1
sys_state. . . . . . . . . . . . . . .  EXTERN   XDATA  U_CHAR   -----  1
p_TimerCallback. . . . . . . . . . . .  TYPEDEF  -----  PTR      -----  3
UART_Enable. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
R_1186sys_state. . . . . . . . . . . .  PUBLIC   XDATA  U_CHAR   0059H  1
HistoryList_t. . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  63
  head . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  tail . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  size . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  measureData. . . . . . . . . . . . .  MEMBER   -----  ARRAY    0003H  60
UART_EnableFlowControl . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_SpiFlashOperator. . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
BT_CMDFIFO . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
YC_UartCTRLBit . . . . . . . . . . . .  * TAG *  -----  ENUM     -----  -----
UserMeasureData. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  6
  weight . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  UTCTime. . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0002H  4
BT_EVENTFIFO_t . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  25
  len. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  DATA . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
CS_TimeOut_T . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  5
  zero . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  lock . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  unstable . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  overload . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  lowbat . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
YC_UtilTimer_t . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  61
  timer_flages . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  callback . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  24
  timer_end. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0019H  32
  last_timer . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0039H  4
_CS_Weight_T . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  10
  origin . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  kg . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  lb . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
  st . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0006H  2
  jin. . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0008H  2
C51 COMPILER V9.01   CS_SCALE_PROC                                                         04/20/2017 16:55:06 PAGE 103 

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


_CS_ComState . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  3
  now. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  pre. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  sucess . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
_CS_Scale_ZeroProc . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  option . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  setdata. . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0004H  2
  R_Weight_GetZeroTimeOut. . . . . . .  STATIC   XDATA  U_CHAR   0015H  1
  R_AD_PowerOnZero . . . . . . . . . .  STATIC   XDATA  U_INT    0016H  2
  R_AD_Zero. . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0018H  2
  B_Weight_Zero. . . . . . . . . . . .  STATIC   XDATA  U_CHAR   001AH  1
  B_Weight_ZeroOk. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001BH  1
  B_LockDownCheck. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001CH  1
  B_WeightZeroErr. . . . . . . . . . .  STATIC   XDATA  U_CHAR   001DH  1
  R_AdFilTimes . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
  R_AD_BUF . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0001H  2
  weight_temp. . . . . . . . . . . . .  AUTO     XDATA  U_INT    0003H  2
  R_Open_Weight. . . . . . . . . . . .  AUTO     XDATA  U_INT    0005H  2
  B_Weight_Pos . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0007H  1
CS_ScaleDisplay_SteadyFlash. . . . . .  EXTERN   CODE   PROC     -----  -----


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   5815    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     90      50
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
